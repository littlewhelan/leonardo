var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.service("contactListData",function(){var t=[],e=0;return{newContactList:t,listNum:e}}),app.controller("newContactListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.config={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9","Content-Type":"application/json"}},e.postList=function(){e.listReq={name:e.listname.input,status:"ACTIVE"},console.log("posting list . . . "),console.log(e.listReq),console.log(e.config),n.post("https://api.constantcontact.com/v2/lists?api_key=yg5p2qf549qacmbqayk5rn23",e.listReq,e.config).then(function(e){console.log("res"+e),e.id=t.listNum})}}]),app.controller("contactListController",["contactListData","$scope","$http",function(t,e,n){var o=[],a=JSON.stringify("list: ["+t.listNum+'],column_names:["EMAIL","FIRST NAME", "LAST NAME", "CITY","COMPANY NAME"]');e.contactChecked=function(t){e.checked.push([t])},e.sendPost=function(){var e=$.param({json:JSON.stringify({importData:o+", "+a})}),i={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9"}};n.post("https://api.constantcontact.com/v2/activities/addcontacts?api_key=u8w59ztxe3294adczfvn7k9e",e,i).success(function(e,n,o,a){res.id=t.listNum}).error(function(t,e,n,o){})}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService",function(t,e,n,o){t.companies=o.companies,t.animationsEnabled=!0,t.openCorp=function(o){return console.log("corp call"),$http({method:"GET",url:"../search",params:{id:passedData}}).then(function(a){results=this.response.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,resolve:{items:function(){return t.items}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.openCorp=function(t){},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","ContactListDataService",function(t,e){t.listForm={},t.searchListBtn=function(){e.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(t){return http({method:"GET",URL:"../createMailList",params:{search:t}}).then(function(t){e=t.data,s(e),r(e),c(e)})},r=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},c=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},l={makeDataCall:i,getCompanies:s,getKids:c,getAdults:r,results:e,allKids:o,allAdults:a,allCompanies:n};return l}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),console.log("size",o),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){results=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o});console.log("this works???"),i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,r(e),c(e),s(e)})},r=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},c=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},l={getKids:c,getAdults:s,getCompanies:r,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return l}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsInJlZ2lzdGVyQ29udHJvbGxlci5qcyIsInJlc2V0Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic2VydmljZSIsIm5ld0NvbnRhY3RMaXN0IiwibGlzdE51bSIsImNvbnRyb2xsZXIiLCJjb250YWN0TGlzdERhdGEiLCIkc2NvcGUiLCIkaHR0cCIsImxpc3RuYW1lIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJDb250ZW50LVR5cGUiLCJwb3N0TGlzdCIsImxpc3RSZXEiLCJuYW1lIiwiaW5wdXQiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwicG9zdCIsInRoZW4iLCJyZXMiLCJpZCIsImltcG9ydERhdGFBcnJheSIsImxpc3RFbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29udGFjdENoZWNrZWQiLCJjaGVja2VkIiwicHVzaCIsInNlbmRQb3N0IiwiZGF0YSIsIiQiLCJwYXJhbSIsImpzb24iLCJpbXBvcnREYXRhIiwic3VjY2VzcyIsImVycm9yIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaXNBdXRoZWQiLCJnZXRUb2tlbiIsInJlc3BvbnNlIiwicGF0aCIsInJlc3BvbnNlRXJyb3IiLCJyZWplY3QiLCIkd2luZG93IiwidGhpcyIsInBhcnNlSnd0IiwidG9rZW4iLCJiYXNlNjRVcmwiLCJzcGxpdCIsImJhc2U2NCIsInJlcGxhY2UiLCJwYXJzZSIsImF0b2IiLCJzYXZlVG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJNYXRoIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImxvZ291dCIsImdldFVzZXIiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsImNvbXBhbmllcyIsImFuaW1hdGlvbnNFbmFibGVkIiwib3BlbkNvcnAiLCJzaXplIiwibWV0aG9kIiwidXJsIiwicGFzc2VkRGF0YSIsInJlc3VsdHMiLCJtb2RhbEluc3RhbmNlIiwib3BlbiIsImFuaW1hdGlvbiIsInJlc29sdmUiLCJpdGVtcyIsInJlc3VsdCIsInNlbGVjdGVkSXRlbSIsInNlbGVjdGVkIiwiaW5mbyIsInRvZ2dsZUFuaW1hdGlvbiIsIkNvbnRhY3RMaXN0RGF0YVNlcnZpY2UiLCJsaXN0Rm9ybSIsInNlYXJjaExpc3RCdG4iLCJtYWtlRGF0YUNhbGwiLCJhbGxDb21wYW5pZXMiLCJhbGxLaWRzIiwiYWxsQWR1bHRzIiwiaHR0cCIsIlVSTCIsInNlYXJjaCIsImdldENvbXBhbmllcyIsImdldEFkdWx0cyIsImdldEtpZHMiLCJhcnJheSIsImdldEVsZW1lbnQzIiwic3BsaWNlIiwibGVuZ3RoIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0eXBlIiwia2lkcyIsImRhdGFBcGkiLCJhZHVsdHMiLCIkcm9vdFNjb3BlIiwic3VibWl0IiwiZm9ybSIsInVzZXIiLCJmb3JtSW5wdXQiLCJzZWFyY2hCdG4iLCJnZXRFbGVtZW50MSIsImdldEVsZW1lbnQyIiwicHVibGljQXBpIiwiJG1vZGFsSW5zdGFuY2UiLCJvayIsImNsb3NlIiwiaXRlbSIsImNhbmNlbCIsImRpc21pc3MiLCJ1c2VybmFtZSIsInB1dCJdLCJtYXBwaW5n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QyxPQUdBekgsRUFBQTBILE9BQUEsV0FDQUosRUFBQUssUUFBQSxjQ1hBekksSUFBQVksV0FBQSxXQUFBLGNBQUEsU0FBQSxhQUFBLFlBQUEsU0FBQXFDLEVBQUFuQyxFQUFBNkcsRUFBQTNFLEdBQ0EyRSxFQUFBRyxLQUFBN0UsRUFBQTZCLFVBRUE2QyxFQUFBRyxNQUFBSCxFQUFBRyxLQUFBWSxVQUNBMUYsRUFBQU0sS0FBQSxTQUdBeEMsRUFBQStELE9BQUEsV0FDQTVCLEVBQUE0QixTQUNBOEMsRUFBQUcsS0FBQTdFLEVBQUE2QixVQUNBOUIsRUFBQU0sS0FBQSxTQ1JBdEQsSUFBQVksV0FBQSxnQkFBQSxTQUFBLFFBQUEsWUFBQSxTQUFBRSxFQUFBQyxFQUFBaUMsR0FDQWxDLEVBQUE4RyxPQUFBLFdBQ0FuRyxRQUFBQyxJQUFBLGdCQUNBRCxRQUFBQyxJQUFBLDZCQUFBWixFQUFBK0csTUFDQTlHLEVBQUFZLEtBQUEsWUFBQWIsRUFBQStHLE1BQ0FqRyxLQUFBLFNBQUF5QixHQUNBNUIsUUFBQUMsSUFBQTJCLEdBQ0FMLEVBQUFNLEtBQUEsZ0JDVEF0RCxJQUFBWSxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUUsRUFBQUMsRUFBQWlDLEdBQ0FsQyxFQUFBOEcsT0FBQSxXQUNBbkcsUUFBQUMsSUFBQSxpQkFBQVosRUFBQStHLE1BQ0E5RyxFQUFBNEgsSUFBQSxTQUFBN0gsRUFBQStHLE1BQ0FqRyxLQUFBLFNBQUF5QixHQUNBNUIsUUFBQUMsSUFBQTJCLEdBQ0FMLEVBQUFNLEtBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdsZW8nLCBbJ25nUm91dGUnLCAnbmdBbmltYXRlJywgJ3VpLmJvb3RzdHJhcCddKTtcblxuYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgICBmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlci5cbiAgICAgICAgICAgIHdoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvbG9naW4uaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL3NlYXJjaCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvc2VhcmNoLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9yZWdpc3RlcicsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvY29udGFjdExpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2NvbnRhY3RMaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9hZGRmYW1pbHknLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGZhbWlseS5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkY29ycCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvYWRkY29ycC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvY29udGFjdGxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2NvbnRhY3RsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIG90aGVyd2lzZSh7XG4gICAgICAgICAgICAgICAgcmVkaXJlY3RUbzogJy9zZWFyY2gnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuYXBwLnNlcnZpY2UoJ2NvbnRhY3RMaXN0RGF0YScsIGZ1bmN0aW9uKCl7XG4gICAgdmFyIGluY2x1ZGVkRW1haWxzID0gW107XG4gICAgdmFyIG5ld0NvbnRhY3RMaXN0ID0gW107XG4gICAgdmFyIGxpc3ROdW0gPSAwO1xuXG5cbiAgICByZXR1cm4ge1xuICAgICAgICBuZXdDb250YWN0TGlzdDogbmV3Q29udGFjdExpc3QsXG4gICAgICAgIGxpc3ROdW06IGxpc3ROdW1cbiAgICB9O1xufSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ25ld0NvbnRhY3RMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG4gICAgJHNjb3BlLmxpc3RuYW1lID0ge307XG5cblxuICAgIC8vaGVhZGVyc1xuICAgICRzY29wZS5jb25maWcgPSB7XG4gICAgICAgIGhlYWRlcnM6IHsnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgZWY1ZDVkZjItYTgwOC00YzcwLWE1ZDktZWI3MTE2M2NiZWI5JyxcblxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG5cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvL2Z1bmN0aW9uIHRvIGNyZWF0ZXMgdGhlIG5ldyBjb250YWN0IGxpc3RcbiAgICAkc2NvcGUucG9zdExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5saXN0UmVxID0ge1wibmFtZVwiOiAkc2NvcGUubGlzdG5hbWUuaW5wdXQsIFwic3RhdHVzXCI6IFwiQUNUSVZFXCJ9O1xuICAgICAgICBjb25zb2xlLmxvZygncG9zdGluZyBsaXN0IC4gLiAuICcpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUubGlzdFJlcSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5jb25maWcpO1xuICAgICAgICAkaHR0cC5wb3N0KCdodHRwczovL2FwaS5jb25zdGFudGNvbnRhY3QuY29tL3YyL2xpc3RzP2FwaV9rZXk9eWc1cDJxZjU0OXFhY21icWF5azVybjIzJywgJHNjb3BlLmxpc3RSZXEsICRzY29wZS5jb25maWcpLlxuICAgICAgICAgICAgdGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXNcIiArIHJlcyk7XG5cbiAgICAgICAgICAgICAgICByZXMuaWQgPSBjb250YWN0TGlzdERhdGEubGlzdE51bTtcblxuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxufV0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdjb250YWN0TGlzdENvbnRyb2xsZXInLFsnY29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApXG57XG5cblxuICAgIHZhciBpbXBvcnREYXRhQXJyYXkgPSBbXTtcbiAgICB2YXIgbGlzdEVuZCA9IEpTT04uc3RyaW5naWZ5KFwibGlzdDogW1wiKyBjb250YWN0TGlzdERhdGEubGlzdE51bSArIFwiXSxjb2x1bW5fbmFtZXM6W1xcXCJFTUFJTFxcXCIsXFxcIkZJUlNUIE5BTUVcXFwiLCBcXFwiTEFTVCBOQU1FXFxcIiwgXFxcIkNJVFlcXFwiLFxcXCJDT01QQU5ZIE5BTUVcXFwiXVwiKTtcblxuICAgIC8vcHVzaCB0aGUgaW5jbHVkZWQvY2hlY2tlZCBpbmZvIHRvIHRoZSBlbWFpbCBsaXN0XG4gICAgJHNjb3BlLmNvbnRhY3RDaGVja2VkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICRzY29wZS5jaGVja2VkLnB1c2goW2lkXSk7XG4gICAgfTtcblxuXG4gICAgLy9Qb3N0IERhdGEgdG8gQ29uc3RhbnQgQ29udGFjdFxuICAgICRzY29wZS5zZW5kUG9zdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGF0YSA9ICQucGFyYW0oe1xuICAgICAgICAgICAganNvbjogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIFwiaW1wb3J0RGF0YVwiOiBpbXBvcnREYXRhQXJyYXkgKyBcIiwgXCIgKyBsaXN0RW5kXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyIGVmNWQ1ZGYyLWE4MDgtNGM3MC1hNWQ5LWViNzExNjNjYmViOSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCdodHRwczovL2FwaS5jb25zdGFudGNvbnRhY3QuY29tL3YyL2FjdGl2aXRpZXMvYWRkY29udGFjdHM/YXBpX2tleT11OHc1OXp0eGUzMjk0YWRjemZ2bjdrOWUnLCBkYXRhLCBjb25maWcpLlxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICByZXMuaWQgPSBjb250YWN0TGlzdERhdGEubGlzdE51bTtcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgLy8gbG9nIGVycm9yXG4gICAgICAgICAgICB9KTtcblxuICAgfTtcbn1dKVxuXG5cblxuIiwiYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSkiLCJhcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuXG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKSIsIi8vZWRpdCBjb3Jwb3JhdGlvbiBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRDb3JwQ3RybCcsIFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywgJ1Jlc3VsdFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAvL3NlbmRzIHRoZSBjb21wYW5pZXMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICRzY29wZS5jb21wYW5pZXMgPSBSZXN1bHRTZXJ2aWNlLmNvbXBhbmllcztcblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG5cbiAgICAkc2NvcGUub3BlbkNvcnAgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICBjb25zb2xlLmxvZygnY29ycCBjYWxsJyk7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnLi4vc2VhcmNoJyxcbiAgICAgICAgICAgIHBhcmFtczp7aWQ6cGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSB0aGlzLnJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0Y29ycC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuaXRlbXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB9O1xuICAgIC8vZ2V0IGNhbGwgZm9yIGNvcnBvcmF0ZSBtb2RhbHNcblxuICAgICRzY29wZS5vcGVuQ29ycCA9IGZ1bmN0aW9uKHBhc3NlZERhdGEpIHtcblxuICAgIH07XG5cblxuXG4gICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICB9O1xuXG59XSk7XG4iLCJhcHAuY29udHJvbGxlcignY3JlYXRlTGlzdFNlYXJjaCcsWyckc2NvcGUnLCdDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCBDb250YWN0TGlzdERhdGFTZXJ2aWNlKXtcbiAgICAkc2NvcGUubGlzdEZvcm09e307XG5cbiAgICAkc2NvcGUuc2VhcmNoTGlzdEJ0biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgICBDb250YWN0TGlzdERhdGFTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUubGlzdEZvcm0uZGF0YSk7XG4gICAgICAgIC8vZW1wdHlzIHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5saXN0Rm9ybT17fTtcbiAgICB9O1xufV0pOyIsImFwcC5mYWN0b3J5KCdDb250YWN0TGlzdERhdGFTZXJ2aWNlJyxbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcblxuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIGFsbENvbXBhbmllcyA9IFtdO1xuICAgIHZhciBhbGxLaWRzID0gW107XG4gICAgdmFyIGFsbEFkdWx0cyA9IFtdO1xuXG4gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uIChwYXNzZWREYXRhKSB7XG4gICAgICAgIHJldHVybiBodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBVUkw6ICcuLi9jcmVhdGVNYWlsTGlzdCcsXG4gICAgICAgICAgICBwYXJhbXM6IHtzZWFyY2g6IHBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEtpZHMocmVzdWx0cyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxBZHVsdHMuc3BsaWNlKDAsIGFsbEFkdWx0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2FkdWx0JylcbiAgICAgICAgICAgICAgICAgICAgYWxsQWR1bHRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIHJldHVybiBhbGxBZHVsdHNcbiAgICB9O1xuXG4gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbENvbXBhbmllcy5zcGxpY2UoMCwgYWxsQ29tcGFuaWVzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY29tcGFueScpXG4gICAgICAgICAgICAgICAgICAgIGFsbENvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsQ29tcGFuaWVzXG4gICAgfTtcblxuICAgIHZhciBnZXRLaWRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsS2lkcy5zcGxpY2UoMCwgYWxsS2lkcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NoaWxkJylcbiAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsS2lkc1xuICAgIH07XG5cbiAgICB2YXIgZGF0YUFwaSA9IHtcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGwsXG4gICAgICAgIGdldENvbXBhbmllczogZ2V0Q29tcGFuaWVzLFxuICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuICAgICAgICBnZXRBZHVsdHM6IGdldEFkdWx0cyxcbiAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgYWxsS2lkczogYWxsS2lkcyxcbiAgICAgICAgYWxsQWR1bHRzOiBhbGxBZHVsdHMsXG4gICAgICAgIGFsbENvbXBhbmllczogYWxsQ29tcGFuaWVzXG4gICAgfTtcblxuICAgIHJldHVybiBkYXRhQXBpO1xuXG59XSk7XG4iLCIvL2VkaXQgZmFtaWx5IG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdEZhbWlseUN0cmwnLFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywnUmVzdWx0U2VydmljZScsICckaHR0cCcsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSwgJGh0dHApIHtcbiAgICAvL3NlbmRzIHRoZSBhZHVsdHMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICRzY29wZS5hZHVsdHMgPSBSZXN1bHRTZXJ2aWNlLmFkdWx0cztcbiAgICAvL3NlbmRzIHRoZSBraWRzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAkc2NvcGUua2lkcyA9IFJlc3VsdFNlcnZpY2Uua2lkcztcblxuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcblxuICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNpemUsIGlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdmYW1pbHkgY2FsbCcsaWQpO1xuICAgICAgICBjb25zb2xlLmxvZygnc2l6ZScsIHNpemUpO1xuICAgICAgICAvL2dldCBjYWxsIGZvciBmYW1pbHkgbW9kYWxzXG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnLi4vZmFtaWx5JyxcbiAgICAgICAgICAgIHBhcmFtczp7aWQ6aWR9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgICAgLy8gIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAvLyAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgLy8gICAgICByZXR1cm4gJHNjb3BlLml0ZW1zO1xuICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgd29ya3M/Pz8nKTtcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUudG9nZ2xlQW5pbWF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgIH07XG5cblxufV0pOyIsIi8vY29udHJvbGxlcnMgZm9yIGxvZ2luXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL3NlYXJjaFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XSk7XG4iLCJcbi8vVGhpcyBzaG91bGQgZ2V0IHRoZSBzZWFyY2ggaXRlbVxuYXBwLmNvbnRyb2xsZXIoJ3NlYXJjaEZ1bmN0aW9uJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnUmVzdWx0U2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCBSZXN1bHRTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcblxuICAgICRzY29wZS5zZWFyY2hCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICBSZXN1bHRTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUuZm9ybUlucHV0LmRhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgaW5wdXQgdGV4dCcsICRzY29wZS5mb3JtSW5wdXQpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuICAgIH07XG5cbn1dKTtcbiIsIi8vVGhpcyBzZXJ2aWNlIHNob3VsZCBwYXNzIGRhdGEgYmV0d2VlbiBjb250cm9sbGVyc1xuYXBwLmZhY3RvcnkoJ1Jlc3VsdFNlcnZpY2UnLCBbJyRodHRwJyxmdW5jdGlvbigkaHR0cCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIGFkdWx0cyA9IFtdO1xuICAgIHZhciBjb21wYW5pZXMgPSBbXTtcbiAgICB2YXIga2lkcyA9IFtdO1xuXG4gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uKHBhc3NlZERhdGEpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9zZWFyY2gnLFxuICAgICAgICAgICAgcGFyYW1zOntzZWFyY2g6cGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDEgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgY29tcGFuaWVzLnNwbGljZSgwLGNvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjb21wYW55JylcbiAgICAgICAgICAgICAgICBjb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgZ2V0RWxlbWVudDEoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50MScsY29tcGFuaWVzKTtcbiAgICAgICAgcmV0dXJuIGNvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQyID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGFkdWx0cy5zcGxpY2UoMCxhZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnYWR1bHQnKVxuICAgICAgICAgICAgICAgICAgICBhZHVsdHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQyKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgaW4gZ2V0RWxlbWVudDInLCBhZHVsdHMpO1xuICAgICAgICByZXR1cm4gYWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRLaWRzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGtpZHMuc3BsaWNlKDAsa2lkcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudHMzJywga2lkcyk7XG4gICAgICAgIHJldHVybiBraWRzXG4gICAgfTtcblxuICAgIC8vcHVibGljXG4gICAgdmFyIHB1YmxpY0FwaSA9IHtcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIGdldENvbXBhbmllczogZ2V0Q29tcGFuaWVzLFxuICAgICAgICBtYWtlRGF0YUNhbGw6IG1ha2VEYXRhQ2FsbCxcbiAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgY29tcGFuaWVzOiBjb21wYW5pZXMsXG4gICAgICAgIGFkdWx0czogYWR1bHRzLFxuICAgICAgICBraWRzOiBraWRzXG4gICAgfTtcbiAgICByZXR1cm4gcHVibGljQXBpO1xufV0pOyIsIi8vIFBsZWFzZSBub3RlIHRoYXQgJG1vZGFsSW5zdGFuY2UgcmVwcmVzZW50cyBhIG1vZGFsIHdpbmRvdyAoaW5zdGFuY2UpIGRlcGVuZGVuY3kuXG4vLyBJdCBpcyBub3QgdGhlIHNhbWUgYXMgdGhlICR1aWJNb2RhbCBzZXJ2aWNlIHVzZWQgYWJvdmUuXG5cbi8vbmVlZGVkIGZvciBtb2RhbD8/IHByZXR0eSBzdXJlXG5hcHAuY29udHJvbGxlcignTW9kYWxJbnN0YW5jZUN0cmwnLFsnJHNjb3BlJywnJG1vZGFsSW5zdGFuY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSkge1xuXG4gICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUuc2VsZWN0ZWQuaXRlbSk7XG4gICAgfTtcblxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgIH07XG59XSk7IiwiYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywnJHNjb3BlJywnJHJvb3RTY29wZScsJyRsb2NhdGlvbicsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbil7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvaG9tZScpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgfVxufV0pO1xuIiwiXG4vL3JlZ2lzdGVyIGNvbnRyb2xsZXJcbmFwcC5jb250cm9sbGVyKCdyZWdpc3RlckN0cmwnLCBbICckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlZ2lzdGVyQ3RybFwiKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlZ2lzdGVyQ29udHJvbGxlciBzdWJtaXQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvcmVnaXN0ZXInLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9pbmRleFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufV0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ3Jlc2V0Q3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlZGl0IHBhc3N3b3JkOicsICRzY29wZS5mb3JtKTtcbiAgICAgICAgJGh0dHAucHV0KCcvYWRtaW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9pbmRleFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufV0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
