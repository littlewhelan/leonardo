var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.service("contactListData",function(){var t=[],e=0;return{newContactList:t,listNum:e}}),app.controller("newContactListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.config={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9","Content-Type":"application/json"}},e.postList=function(){e.listReq={name:e.listname.input,status:"ACTIVE"},console.log("posting list . . . "),console.log(e.listReq),console.log(e.config),n.post("https://api.constantcontact.com/v2/lists?api_key=yg5p2qf549qacmbqayk5rn23",e.listReq,e.config).then(function(e){console.log("res"+e),e.id=t.listNum})}}]),app.controller("contactListController",["contactListData","$scope","$http",function(t,e,n){var o=[],a=JSON.stringify("list: ["+t.listNum+'],column_names:["EMAIL","FIRST NAME", "LAST NAME", "CITY","COMPANY NAME"]');e.contactChecked=function(t){e.checked.push([t])},e.sendPost=function(){var e=$.param({json:JSON.stringify({importData:o+", "+a})}),i={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9"}};n.post("https://api.constantcontact.com/v2/activities/addcontacts?api_key=u8w59ztxe3294adczfvn7k9e",e,i).success(function(e,n,o,a){res.id=t.listNum}).error(function(t,e,n,o){})}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService",function(t,e,n,o){t.companies=o.companies,t.animationsEnabled=!0,t.openCorp=function(o){return console.log("corp call"),$http({method:"GET",url:"../search",params:{id:passedData}}).then(function(a){results=this.response.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,resolve:{items:function(){return t.items}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.openCorp=function(t){},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","ContactListDataService",function(t,e){t.listForm={},t.searchListBtn=function(){e.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(t){return http({method:"GET",URL:"../createMailList",params:{search:t}}).then(function(t){e=t.data,s(e),r(e),c(e)})},r=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},c=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},l={makeDataCall:i,getCompanies:s,getKids:c,getAdults:r,results:e,allKids:o,allAdults:a,allCompanies:n};return l}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.family={},t.animationsEnabled=!0,t.open=function(o,i){return a({method:"GET",url:"../family",params:{id:i}}).then(function(a){t.family=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.family}}});console.log("scoped family",t.family),i.result.then(function(e){console.log("selectedItem",e),t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,r(e),c(e),s(e)})},r=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},c=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},l={getKids:c,getAdults:s,getCompanies:r,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return l}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsInJlZ2lzdGVyQ29udHJvbGxlci5qcyIsInJlc2V0Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic2VydmljZSIsIm5ld0NvbnRhY3RMaXN0IiwibGlzdE51bSIsImNvbnRyb2xsZXIiLCJjb250YWN0TGlzdERhdGEiLCIkc2NvcGUiLCIkaHR0cCIsImxpc3RuYW1lIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJDb250ZW50LVR5cGUiLCJwb3N0TGlzdCIsImxpc3RSZXEiLCJuYW1lIiwiaW5wdXQiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwicG9zdCIsInRoZW4iLCJyZXMiLCJpZCIsImltcG9ydERhdGFBcnJheSIsImxpc3RFbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29udGFjdENoZWNrZWQiLCJjaGVja2VkIiwicHVzaCIsInNlbmRQb3N0IiwiZGF0YSIsIiQiLCJwYXJhbSIsImpzb24iLCJpbXBvcnREYXRhIiwic3VjY2VzcyIsImVycm9yIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaXNBdXRoZWQiLCJnZXRUb2tlbiIsInJlc3BvbnNlIiwicGF0aCIsInJlc3BvbnNlRXJyb3IiLCJyZWplY3QiLCIkd2luZG93IiwidGhpcyIsInBhcnNlSnd0IiwidG9rZW4iLCJiYXNlNjRVcmwiLCJzcGxpdCIsImJhc2U2NCIsInJlcGxhY2UiLCJwYXJzZSIsImF0b2IiLCJzYXZlVG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJNYXRoIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImxvZ291dCIsImdldFVzZXIiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsImNvbXBhbmllcyIsImFuaW1hdGlvbnNFbmFibGVkIiwib3BlbkNvcnAiLCJzaXplIiwibWV0aG9kIiwidXJsIiwicGFzc2VkRGF0YSIsInJlc3VsdHMiLCJtb2RhbEluc3RhbmNlIiwib3BlbiIsImFuaW1hdGlvbiIsInJlc29sdmUiLCJpdGVtcyIsInJlc3VsdCIsInNlbGVjdGVkSXRlbSIsInNlbGVjdGVkIiwiaW5mbyIsInRvZ2dsZUFuaW1hdGlvbiIsIkNvbnRhY3RMaXN0RGF0YVNlcnZpY2UiLCJsaXN0Rm9ybSIsInNlYXJjaExpc3RCdG4iLCJtYWtlRGF0YUNhbGwiLCJhbGxDb21wYW5pZXMiLCJhbGxLaWRzIiwiYWxsQWR1bHRzIiwiaHR0cCIsIlVSTCIsInNlYXJjaCIsImdldENvbXBhbmllcyIsImdldEFkdWx0cyIsImdldEtpZHMiLCJhcnJheSIsImdldEVsZW1lbnQzIiwic3BsaWNlIiwibGVuZ3RoIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0eXBlIiwia2lkcyIsImRhdGFBcGkiLCJhZHVsdHMiLCJmYW1pbHkiLCJzY29wZSIsIiRyb290U2NvcGUiLCJzdWJtaXQiLCJmb3JtIiwidXNlciIsImZvcm1JbnB1dCIsInNlYXJjaEJ0biIsImdldEVsZW1lbnQxIiwiZ2V0RWxlbWVudDIiLCJwdWJsaWNBcGkiLCIkbW9kYWxJbnN0YW5jZSIsIm9rIiwiY2xvc2UiLCJpdGVtIiwiY2FuY2VsIiwiZGlzbWlzcyIsInVzZXJuYW1l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QkFBQSxTQUFBLGlCQUFBLFNBQUFFLEVBQUF3SCxHQUVBeEgsRUFBQXlILEdBQUEsV0FDQUQsRUFBQUUsTUFBQTFILEVBQUFtRixTQUFBd0MsT0FHQTNILEVBQUE0SCxPQUFBLFdBQ0FKLEVBQUFLLFFBQUEsY0NYQTNJLElBQUFZLFdBQUEsV0FBQSxjQUFBLFNBQUEsYUFBQSxZQUFBLFNBQUFxQyxFQUFBbkMsRUFBQStHLEVBQUE3RSxHQUNBNkUsRUFBQUcsS0FBQS9FLEVBQUE2QixVQUVBK0MsRUFBQUcsTUFBQUgsRUFBQUcsS0FBQVksVUFDQTVGLEVBQUFNLEtBQUEsU0FHQXhDLEVBQUErRCxPQUFBLFdBQ0E1QixFQUFBNEIsU0FDQWdELEVBQUFHLEtBQUEvRSxFQUFBNkIsVUFDQTlCLEVBQUFNLEtBQUEsU0NSQXRELElBQUFZLFdBQUEsZ0JBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUUsRUFBQUMsRUFBQWlDLEdBQ0FsQyxFQUFBZ0gsT0FBQSxXQUNBckcsUUFBQUMsSUFBQSxnQkFDQUQsUUFBQUMsSUFBQSw2QkFBQVosRUFBQWlILE1BQ0FoSCxFQUFBWSxLQUFBLFlBQUFiLEVBQUFpSCxNQUNBbkcsS0FBQSxTQUFBeUIsR0FDQTVCLFFBQUFDLElBQUEyQixHQUNBTCxFQUFBTSxLQUFBLGdCQ1RBdEQsSUFBQVksV0FBQSxhQUFBLFNBQUEsUUFBQSxZQUFBLFNBQUFFLEVBQUFDLEVBQUFpQyxHQUNBbEMsRUFBQWdILE9BQUEsV0FDQXJHLFFBQUFDLElBQUEsaUJBQUFaLEVBQUFpSCxNQUNBaEgsRUFBQThILElBQUEsU0FBQS9ILEVBQUFpSCxNQUNBbkcsS0FBQSxTQUFBeUIsR0FDQTVCLFFBQUFDLElBQUEyQixHQUNBTCxFQUFBTSxLQUFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbGVvJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZScsICd1aS5ib290c3RyYXAnXSk7XG5cbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2xvZ2luLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL3NlYXJjaC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvcmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RMaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0TGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkZmFtaWx5Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRmYW1pbHkuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGNvcnAnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGNvcnAuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RsaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvc2VhcmNoJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cbmFwcC5zZXJ2aWNlKCdjb250YWN0TGlzdERhdGEnLCBmdW5jdGlvbigpe1xuICAgIHZhciBpbmNsdWRlZEVtYWlscyA9IFtdO1xuICAgIHZhciBuZXdDb250YWN0TGlzdCA9IFtdO1xuICAgIHZhciBsaXN0TnVtID0gMDtcblxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmV3Q29udGFjdExpc3Q6IG5ld0NvbnRhY3RMaXN0LFxuICAgICAgICBsaXN0TnVtOiBsaXN0TnVtXG4gICAgfTtcbn0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCduZXdDb250YWN0TGlzdENvbnRyb2xsZXInLFsnY29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2RhdGEgdG8gY3JlYXRlIGEgbmV3IGNvbnRhY3QgbGlzdFxuICAgICRzY29wZS5saXN0bmFtZSA9IHt9O1xuXG5cbiAgICAvL2hlYWRlcnNcbiAgICAkc2NvcGUuY29uZmlnID0ge1xuICAgICAgICBoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyIGVmNWQ1ZGYyLWE4MDgtNGM3MC1hNWQ5LWViNzExNjNjYmViOScsXG5cbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy9mdW5jdGlvbiB0byBjcmVhdGVzIHRoZSBuZXcgY29udGFjdCBsaXN0XG4gICAgJHNjb3BlLnBvc3RMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubGlzdFJlcSA9IHtcIm5hbWVcIjogJHNjb3BlLmxpc3RuYW1lLmlucHV0LCBcInN0YXR1c1wiOiBcIkFDVElWRVwifTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Bvc3RpbmcgbGlzdCAuIC4gLiAnKTtcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmxpc3RSZXEpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuY29uZmlnKTtcbiAgICAgICAgJGh0dHAucG9zdCgnaHR0cHM6Ly9hcGkuY29uc3RhbnRjb250YWN0LmNvbS92Mi9saXN0cz9hcGlfa2V5PXlnNXAycWY1NDlxYWNtYnFheWs1cm4yMycsICRzY29wZS5saXN0UmVxLCAkc2NvcGUuY29uZmlnKS5cbiAgICAgICAgICAgIHRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIgKyByZXMpO1xuXG4gICAgICAgICAgICAgICAgcmVzLmlkID0gY29udGFjdExpc3REYXRhLmxpc3ROdW07XG5cbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbn1dKTtcblxuXG5hcHAuY29udHJvbGxlcignY29udGFjdExpc3RDb250cm9sbGVyJyxbJ2NvbnRhY3RMaXN0RGF0YScsJyRzY29wZScsJyRodHRwJywgZnVuY3Rpb24oY29udGFjdExpc3REYXRhLCAkc2NvcGUsICRodHRwKVxue1xuXG5cbiAgICB2YXIgaW1wb3J0RGF0YUFycmF5ID0gW107XG4gICAgdmFyIGxpc3RFbmQgPSBKU09OLnN0cmluZ2lmeShcImxpc3Q6IFtcIisgY29udGFjdExpc3REYXRhLmxpc3ROdW0gKyBcIl0sY29sdW1uX25hbWVzOltcXFwiRU1BSUxcXFwiLFxcXCJGSVJTVCBOQU1FXFxcIiwgXFxcIkxBU1QgTkFNRVxcXCIsIFxcXCJDSVRZXFxcIixcXFwiQ09NUEFOWSBOQU1FXFxcIl1cIik7XG5cbiAgICAvL3B1c2ggdGhlIGluY2x1ZGVkL2NoZWNrZWQgaW5mbyB0byB0aGUgZW1haWwgbGlzdFxuICAgICRzY29wZS5jb250YWN0Q2hlY2tlZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAkc2NvcGUuY2hlY2tlZC5wdXNoKFtpZF0pO1xuICAgIH07XG5cblxuICAgIC8vUG9zdCBEYXRhIHRvIENvbnN0YW50IENvbnRhY3RcbiAgICAkc2NvcGUuc2VuZFBvc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRhdGEgPSAkLnBhcmFtKHtcbiAgICAgICAgICAgIGpzb246IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBcImltcG9ydERhdGFcIjogaW1wb3J0RGF0YUFycmF5ICsgXCIsIFwiICsgbGlzdEVuZFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cblxuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciBlZjVkNWRmMi1hODA4LTRjNzAtYTVkOS1lYjcxMTYzY2JlYjknXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnaHR0cHM6Ly9hcGkuY29uc3RhbnRjb250YWN0LmNvbS92Mi9hY3Rpdml0aWVzL2FkZGNvbnRhY3RzP2FwaV9rZXk9dTh3NTl6dHhlMzI5NGFkY3pmdm43azllJywgZGF0YSwgY29uZmlnKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgcmVzLmlkID0gY29udGFjdExpc3REYXRhLmxpc3ROdW07XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIC8vIGxvZyBlcnJvclxuICAgICAgICAgICAgfSk7XG5cbiAgIH07XG59XSlcblxuXG5cbiIsImFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pIiwiYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpIHtcblxuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSByZXR1cm4ge307XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIC8vY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSkiLCIvL2VkaXQgY29ycG9yYXRpb24gbW9kYWwgdGVtcGxhdGVcbmFwcC5jb250cm9sbGVyKCdlZGl0Q29ycEN0cmwnLCBbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsICdSZXN1bHRTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkbG9nLCBSZXN1bHRTZXJ2aWNlKSB7XG4gICAgLy9zZW5kcyB0aGUgY29tcGFuaWVzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAkc2NvcGUuY29tcGFuaWVzID0gUmVzdWx0U2VydmljZS5jb21wYW5pZXM7XG5cbiAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuXG4gICAgJHNjb3BlLm9wZW5Db3JwID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NvcnAgY2FsbCcpO1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL3NlYXJjaCcsXG4gICAgICAgICAgICBwYXJhbXM6e2lkOnBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gdGhpcy5yZXNwb25zZS5kYXRhO1xuXG4gICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGNvcnAuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLml0ZW1zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgfTtcbiAgICAvL2dldCBjYWxsIGZvciBjb3Jwb3JhdGUgbW9kYWxzXG5cbiAgICAkc2NvcGUub3BlbkNvcnAgPSBmdW5jdGlvbihwYXNzZWREYXRhKSB7XG5cbiAgICB9O1xuXG5cblxuICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9ICEkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQ7XG4gICAgfTtcblxufV0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUxpc3RTZWFyY2gnLFsnJHNjb3BlJywnQ29udGFjdExpc3REYXRhU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgQ29udGFjdExpc3REYXRhU2VydmljZSl7XG4gICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaExpc3RCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICAgQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmxpc3RGb3JtLmRhdGEpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUubGlzdEZvcm09e307XG4gICAgfTtcbn1dKTsiLCJhcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhbGxDb21wYW5pZXMgPSBbXTtcbiAgICB2YXIgYWxsS2lkcyA9IFtdO1xuICAgIHZhciBhbGxBZHVsdHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbiAocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgVVJMOiAnLi4vY3JlYXRlTWFpbExpc3QnLFxuICAgICAgICAgICAgcGFyYW1zOiB7c2VhcmNoOiBwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsQWR1bHRzLnNwbGljZSgwLCBhbGxBZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFsbEFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsQWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxDb21wYW5pZXMuc3BsaWNlKDAsIGFsbENvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgICAgICBhbGxDb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbEtpZHMuc3BsaWNlKDAsIGFsbEtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbEtpZHNcbiAgICB9O1xuXG4gICAgdmFyIGRhdGFBcGkgPSB7XG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGFsbEtpZHM6IGFsbEtpZHMsXG4gICAgICAgIGFsbEFkdWx0czogYWxsQWR1bHRzLFxuICAgICAgICBhbGxDb21wYW5pZXM6IGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICByZXR1cm4gZGF0YUFwaTtcblxufV0pO1xuIiwiLy9lZGl0IGZhbWlseSBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRGYW1pbHlDdHJsJyxbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsJ1Jlc3VsdFNlcnZpY2UnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UsICRodHRwKSB7XG4gICAgLy9zZW5kcyB0aGUgYWR1bHRzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAkc2NvcGUuYWR1bHRzID0gUmVzdWx0U2VydmljZS5hZHVsdHM7XG4gICAgLy9zZW5kcyB0aGUga2lkcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgJHNjb3BlLmtpZHMgPSBSZXN1bHRTZXJ2aWNlLmtpZHM7XG5cdC8vIHN0b3JlcyB0aGUgZmFtaWx5IG9iamVjdCB3aGVuIG1vZGFsIG9wZW5zXG5cdCRzY29wZS5mYW1pbHkgPSB7fTtcblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG5cbiAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uIChzaXplLCBpZCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdmYW1pbHkgY2FsbCcsaWQpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdzaXplJywgc2l6ZSk7XG4gICAgICAgIC8vZ2V0IGNhbGwgZm9yIGZhbWlseSBtb2RhbHNcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9mYW1pbHknLFxuICAgICAgICAgICAgcGFyYW1zOntpZDppZH1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIC8vcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG5cdFx0XHQkc2NvcGUuZmFtaWx5ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcblx0XHRcdFx0c2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHQvLy8vY29uc29sZS5sb2coXCJyZXNvbHZlXCIsICRzY29wZS5mYW1pbHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5mYW1pbHk7XG4gICAgICAgICAgICAgICAgICAgIH1cblx0XHRcdFx0XHQvL2ZhbWlseTogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0Ly9yZXR1cm4gJHNjb3BlLmZhbWlseVxuXHRcdFx0XHRcdC8vfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndGhpcyB3b3Jrcz8/PycpO1xuXHRcdFx0Y29uc29sZS5sb2coXCJzY29wZWQgZmFtaWx5XCIsICRzY29wZS5mYW1pbHkpO1xuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwic2VsZWN0ZWRJdGVtXCIsIHNlbGVjdGVkSXRlbSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9ICEkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQ7XG4gICAgfTtcblxuXG59XSk7IiwiLy9jb250cm9sbGVycyBmb3IgbG9naW5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvc2VhcmNoXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcbn1dKTtcbiIsIlxuLy9UaGlzIHNob3VsZCBnZXQgdGhlIHNlYXJjaCBpdGVtXG5hcHAuY29udHJvbGxlcignc2VhcmNoRnVuY3Rpb24nLCBbJyRzY29wZScsICckaHR0cCcsICdSZXN1bHRTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaEJ0biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgIFJlc3VsdFNlcnZpY2UubWFrZURhdGFDYWxsKCRzY29wZS5mb3JtSW5wdXQuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIHRoZSBpbnB1dCB0ZXh0JywgJHNjb3BlLmZvcm1JbnB1dCk7XG4gICAgICAgIC8vZW1wdHlzIHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG4gICAgfTtcblxufV0pO1xuIiwiLy9UaGlzIHNlcnZpY2Ugc2hvdWxkIHBhc3MgZGF0YSBiZXR3ZWVuIGNvbnRyb2xsZXJzXG5hcHAuZmFjdG9yeSgnUmVzdWx0U2VydmljZScsIFsnJGh0dHAnLGZ1bmN0aW9uKCRodHRwKSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgYWR1bHRzID0gW107XG4gICAgdmFyIGNvbXBhbmllcyA9IFtdO1xuICAgIHZhciBraWRzID0gW107XG5cbiAgICB2YXIgbWFrZURhdGFDYWxsID0gZnVuY3Rpb24ocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL3NlYXJjaCcsXG4gICAgICAgICAgICBwYXJhbXM6e3NlYXJjaDpwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBjb21wYW5pZXMuc3BsaWNlKDAsY29tcGFuaWVzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgIGNvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBnZXRFbGVtZW50MShhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnQxJyxjb21wYW5pZXMpO1xuICAgICAgICByZXR1cm4gY29tcGFuaWVzXG4gICAgfTtcblxuICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDIgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgYWR1bHRzLnNwbGljZSgwLGFkdWx0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDIoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBpbiBnZXRFbGVtZW50MicsIGFkdWx0cyk7XG4gICAgICAgIHJldHVybiBhZHVsdHNcbiAgICB9O1xuXG4gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAga2lkcy5zcGxpY2UoMCxraWRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NoaWxkJylcbiAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50czMnLCBraWRzKTtcbiAgICAgICAgcmV0dXJuIGtpZHNcbiAgICB9O1xuXG4gICAgLy9wdWJsaWNcbiAgICB2YXIgcHVibGljQXBpID0ge1xuICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuICAgICAgICBnZXRBZHVsdHM6IGdldEFkdWx0cyxcbiAgICAgICAgZ2V0Q29tcGFuaWVzOiBnZXRDb21wYW5pZXMsXG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICBjb21wYW5pZXM6IGNvbXBhbmllcyxcbiAgICAgICAgYWR1bHRzOiBhZHVsdHMsXG4gICAgICAgIGtpZHM6IGtpZHNcbiAgICB9O1xuICAgIHJldHVybiBwdWJsaWNBcGk7XG59XSk7IiwiLy8gUGxlYXNlIG5vdGUgdGhhdCAkbW9kYWxJbnN0YW5jZSByZXByZXNlbnRzIGEgbW9kYWwgd2luZG93IChpbnN0YW5jZSkgZGVwZW5kZW5jeS5cbi8vIEl0IGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgJHVpYk1vZGFsIHNlcnZpY2UgdXNlZCBhYm92ZS5cblxuLy9uZWVkZWQgZm9yIG1vZGFsPz8gcHJldHR5IHN1cmVcbmFwcC5jb250cm9sbGVyKCdNb2RhbEluc3RhbmNlQ3RybCcsWyckc2NvcGUnLCckbW9kYWxJbnN0YW5jZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlKSB7XG5cbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5zZWxlY3RlZC5pdGVtKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgfTtcbn1dKTsiLCJhcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uKXtcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9ob21lJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcbiAgICB9XG59XSk7XG4iLCJcbi8vcmVnaXN0ZXIgY29udHJvbGxlclxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXJDdHJsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZygncmVnaXN0ZXJDb250cm9sbGVyIHN1Ym1pdDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9yZWdpc3RlcicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iLCJhcHAuY29udHJvbGxlcigncmVzZXRDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VkaXQgcGFzc3dvcmQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wdXQoJy9hZG1pbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
