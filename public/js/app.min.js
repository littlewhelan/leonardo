function formatDates(t){return{full:moment(t).format(fullDate),pretty:moment(t).format(prettyDate)}}var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]),prettyDate="MM/DD/YYgYY",fullDate="MM/DD/YYYY h:mm:ss a";app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.companies=o.companies,t.animationsEnabled=!0,t.open=function(o,i){return console.log("corp call",i),a({method:"GET",url:"../corporation",params:{id:i}}).then(function(a){t.company=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.company}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$rootScope","ContactListDataService",function(t,e,n){e.add=!1,t.listForm={},t.searchListBtn=function(){n.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",URL:"/createMailList",params:{search:n}}).then(function(t){e=t.data,r(e),s(e),l(e)})},s=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},l=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},c={makeDataCall:i,getCompanies:r,getKids:l,getAdults:s,results:e,allKids:o,allAdults:a,allCompanies:n};return c}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){t.family=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.family}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,s(e),l(e),r(e)})},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},l=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},c={getKids:l,getAdults:r,getCompanies:s,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return c}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("newContactListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.createList=function(){console.log("create list: "+e.listName.input),t.postList(e.listName.input),e.listName={}}}]),app.service("newContactListData",["ContactListDataService","$http",function(t,e){var n="1499523610";this.postList=function(){e.post("/newContactList").then(function(t){console.log(t),n=t.id},function(t){console.log(t)}),console.log(options)};var o=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];this.popList=function(){a(),e.post("/populateContactList.js",o,n).success(function(t,e,n,o){console.log(t)}),console.log(options)};var a=function(){$(":checked.type-element").each(function(){if(id==t.results.id){var e={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};o.push(e)}})}}]),app.controller("popListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.populateList=function(){console.log("create list: "+scope.listName.input),t.popList(),e.listName={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImZvcm1hdERhdGVzIiwiZGF0ZSIsImZ1bGwiLCJtb21lbnQiLCJmb3JtYXQiLCJmdWxsRGF0ZSIsInByZXR0eSIsInByZXR0eURhdGUiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsImlzQXV0aGVkIiwiQXV0aG9yaXphdGlvbiIsImdldFRva2VuIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZWplY3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsInNhdmVUb2tlbiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwicGFyYW1zIiwibm90RXhwaXJlZCIsIk1hdGgiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsIiRodHRwIiwiY29tcGFuaWVzIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJvcGVuIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsImNvbXBhbnkiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsImFuaW1hdGlvbiIsInNjb3BlIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwidG9nZ2xlQW5pbWF0aW9uIiwiJHJvb3RTY29wZSIsIkNvbnRhY3RMaXN0RGF0YVNlcnZpY2UiLCJhZGQiLCJsaXN0Rm9ybSIsInNlYXJjaExpc3RCdG4iLCJtYWtlRGF0YUNhbGwiLCJyZXN1bHRzIiwiYWxsQ29tcGFuaWVzIiwiYWxsS2lkcyIsImFsbEFkdWx0cyIsInBhc3NlZERhdGEiLCJVUkwiLCJzZWFyY2giLCJnZXRDb21wYW5pZXMiLCJnZXRBZHVsdHMiLCJnZXRLaWRzIiwiYXJyYXkiLCJnZXRFbGVtZW50MyIsInNwbGljZSIsImxlbmd0aCIsImZvckVhY2giLCJlbGVtZW50IiwidHlwZSIsInB1c2giLCJraWRzIiwiZGF0YUFwaSIsImFkdWx0cyIsImZhbWlseSIsInN1Ym1pdCIsInBvc3QiLCJmb3JtIiwidXNlciIsImZvcm1JbnB1dCIsInNlYXJjaEJ0biIsImdldEVsZW1lbnQxIiwiZ2V0RWxlbWVudDIiLCJwdWJsaWNBcGkiLCIkbW9kYWxJbnN0YW5jZSIsIm9rIiwiY2xvc2UiLCJpdGVtIiwiY2FuY2VsIiwiZGlzbWlzcyIsInVzZXJuYW1lIiwibmV3Q29udGFjdExpc3REYXRhIiwibGlzdE5hbWUiLCJjcmVhdGVMaXN0IiwiaW5wdXQiLCJwb3N0TGlzdCIsImxpc3ROdW0iLCJvcHRpb25zIiwiaW1wb3J0RGF0YUFycmF5IiwiZW1haWxfYWRkcmVzc2VzIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsImNvbXBhbnlfbmFtZSIsImFkZHJlc3NlcyIsImNpdHkiLCJwb3BMaXN0IiwiZ2V0Q2hlY2tlZCIsInN1Y2Nlc3MiLCIkIiwiZWFjaCIsImNvbnRhY3RPYmplY3QiLCJlbWFpbCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwicG9wdWxhdGVMaXN0IiwicHV0Il0sIm1hcHBpbmdzIjoiQUFLQSxRQUFBQSxhQUFBQyxHQUNBLE9BQ0FDLEtBQUFDLE9BQUFGLEdBQUFHLE9BQUFDLFVBQ0FDLE9BQUFILE9BQUFGLEdBQUFHLE9BQUFHLGFBUkEsR0FBQUMsS0FBQUMsUUFBQUMsT0FBQSxPQUFBLFVBQUEsWUFBQSxpQkFFQUgsV0FBQSxjQUNBRixTQUFBLHNCQVNBRyxLQUFBRyxRQUFBLGlCQUNBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsS0FDQUMsWUFBQSxzQkFFQUQsS0FBQSxXQUNBQyxZQUFBLHdCQUVBRCxLQUFBLGFBQ0FDLFlBQUEseUJBRUFELEtBQUEsZ0JBQ0FDLFlBQUEsNkJBRUFELEtBQUEsY0FDQUMsWUFBQSwyQkFFQUQsS0FBQSxZQUNBQyxZQUFBLHlCQUVBRCxLQUFBLGdCQUNBQyxZQUFBLDZCQUVBQyxXQUNBQyxXQUFBLGVDckNBUixJQUFBUyxRQUFBLG1CQUFBLEtBQUEsWUFBQSxjQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsT0FDQUMsUUFBQSxTQUFBVixHQUtBLE1BSkFBLEdBQUFXLFFBQUFYLEVBQUFXLFlBQ0FGLEVBQUFHLGFBQ0FaLEVBQUFXLFFBQUFFLGNBQUEsVUFBQUosRUFBQUssWUFFQWQsR0FFQWUsU0FBQSxTQUFBQSxHQU9BLE1BTEEsT0FBQUEsRUFBQUMsUUFHQVIsRUFBQVMsS0FBQSxLQUVBRixHQUFBUixFQUFBTCxLQUFBYSxJQUNBRyxjQUFBLFNBQUFILEdBU0EsTUFSQSxPQUFBQSxFQUFBQyxPQUdBUixFQUFBUyxLQUFBLEtBR0FFLFFBQUFDLElBQUFMLEVBQUFDLFFBRUFULEVBQUFjLE9BQUFOLFFDMUJBbEIsSUFBQXlCLFFBQUEsZUFBQSxVQUFBLFNBQUFDLEdBRUFDLEtBQUFDLFNBQUEsU0FBQUMsR0FDQSxHQUFBQSxFQUFBLENBQ0EsR0FBQUMsR0FBQUQsRUFBQUUsTUFBQSxLQUFBLEdBQ0FDLEVBQUFGLEVBQUFHLFFBQUEsSUFBQSxLQUFBQSxRQUFBLElBQUEsSUFDQSxPQUFBQyxNQUFBQyxNQUFBVCxFQUFBVSxLQUFBSixJQUNBLFVBR0FMLEtBQUFVLFVBQUEsU0FBQVIsR0FDQUgsRUFBQVksYUFBQUMsU0FBQVYsR0FJQUYsS0FBQVYsU0FBQSxXQUNBLE1BQUFTLEdBQUFZLGFBQUFDLFVBR0FaLEtBQUFaLFNBQUEsV0FDQSxHQUFBYyxHQUFBRixLQUFBVixVQUNBLElBQUFZLEVBQUEsQ0FDQSxHQUFBVyxHQUFBYixLQUFBQyxTQUFBQyxHQUNBWSxFQUFBQyxLQUFBQyxPQUFBLEdBQUFDLE9BQUFDLFVBQUEsTUFBQUwsRUFBQU0sR0FJQSxPQUhBTCxJQUNBZCxLQUFBb0IsU0FFQU4sRUFFQSxPQUFBLEdBSUFkLEtBQUFvQixPQUFBLGlCQUNBckIsR0FBQVksYUFBQUMsVUFJQVosS0FBQXFCLFFBQUEsV0FDQSxNQUFBckIsTUFBQUMsU0FBQUQsS0FBQVYsZ0JDdENBakIsSUFBQWlELFdBQUEsZ0JBQUEsU0FBQSxZQUFBLE9BQUEsZ0JBQUEsUUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUVBSixFQUFBSyxVQUFBRixFQUFBRSxVQUVBTCxFQUFBTSxtQkFBQSxFQUVBTixFQUFBTyxLQUFBLFNBQUFDLEVBQUFDLEdBRUEsTUFEQXJDLFNBQUFDLElBQUEsWUFBQW9DLEdBQ0FMLEdBQ0FNLE9BQUEsTUFDQUMsSUFBQSxpQkFDQXJCLFFBQUFtQixHQUFBQSxLQUNBRyxLQUFBLFNBQUE1QyxHQUVBZ0MsRUFBQWEsUUFBQTdDLEVBQUE4QyxJQUNBLElBQUFDLEdBQUFkLEVBQUFNLE1BQ0FTLFVBQUFoQixFQUFBTSxrQkFDQWxELFlBQUEsd0JBQ0EyQyxXQUFBLG9CQUNBUyxLQUFBQSxFQUNBUyxNQUFBakIsRUFDQWtCLFNBQ0FDLE1BQUEsV0FDQSxNQUFBbkIsR0FBQWEsV0FLQUUsR0FBQUssT0FBQVIsS0FBQSxTQUFBUyxHQUNBckIsRUFBQXNCLFNBQUFELEdBQ0EsV0FDQW5CLEVBQUFxQixLQUFBLHVCQUFBLEdBQUE3QixZQUtBTSxFQUFBd0IsZ0JBQUEsV0FDQXhCLEVBQUFNLG1CQUFBTixFQUFBTSxzQkN0Q0F4RCxJQUFBaUQsV0FBQSxvQkFBQSxTQUFBLGFBQUEseUJBQUEsU0FBQUMsRUFBQXlCLEVBQUFDLEdBQ0FELEVBQUFFLEtBQUEsRUFDQTNCLEVBQUE0QixZQUVBNUIsRUFBQTZCLGNBQUEsV0FFQUgsRUFBQUksYUFBQTlCLEVBQUE0QixTQUFBZCxNQUVBZCxFQUFBNEIsZ0JDUkE5RSxJQUFBUyxRQUFBLDBCQUFBLFFBQUEsU0FBQTZDLEdBRUEsR0FBQTJCLE1BQ0FDLEtBQ0FDLEtBQ0FDLEtBRUFKLEVBQUEsU0FBQUssR0FDQSxNQUFBL0IsSUFDQU0sT0FBQSxNQUNBMEIsSUFBQSxrQkFDQTlDLFFBQUErQyxPQUFBRixLQUNBdkIsS0FBQSxTQUFBNUMsR0FDQStELEVBQUEvRCxFQUFBOEMsS0FDQXdCLEVBQUFQLEdBQ0FRLEVBQUFSLEdBQ0FTLEVBQUFULE1BS0FRLEVBQUEsU0FBQUUsR0FDQSxHQUFBQyxHQUFBLFNBQUFELEdBQ0FQLEVBQUFTLE9BQUEsRUFBQVQsRUFBQVUsUUFDQUgsRUFBQUksUUFBQSxTQUFBQyxHQUNBLFNBQUFBLEVBQUFDLE1BQ0FiLEVBQUFjLEtBQUFGLEtBSUEsT0FEQUosR0FBQUQsR0FDQVAsR0FHQUksRUFBQSxTQUFBRyxHQUNBLEdBQUFDLEdBQUEsU0FBQUQsR0FDQVQsRUFBQVcsT0FBQSxFQUFBWCxFQUFBWSxRQUNBSCxFQUFBSSxRQUFBLFNBQUFDLEdBQ0EsV0FBQUEsRUFBQUMsTUFDQWYsRUFBQWdCLEtBQUFGLEtBSUEsT0FEQUosR0FBQUQsR0FDQVQsR0FHQVEsRUFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUEsU0FBQUQsR0FDQVIsRUFBQVUsT0FBQSxFQUFBVixFQUFBVyxRQUNBSCxFQUFBSSxRQUFBLFNBQUFDLEdBQ0EsU0FBQUEsRUFBQUMsTUFDQUUsS0FBQUQsS0FBQUYsS0FJQSxPQURBSixHQUFBRCxHQUNBUixHQUdBaUIsR0FDQXBCLGFBQUFBLEVBQ0FRLGFBQUFBLEVBQ0FFLFFBQUFBLEVBQ0FELFVBQUFBLEVBQ0FSLFFBQUFBLEVBQ0FFLFFBQUFBLEVBQ0FDLFVBQUFBLEVBQ0FGLGFBQUFBLEVBR0EsT0FBQWtCLE1DbkVBcEcsSUFBQWlELFdBQUEsa0JBQUEsU0FBQSxZQUFBLE9BQUEsZ0JBQUEsUUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUdBSixFQUFBbUQsT0FBQWhELEVBQUFnRCxPQUNBbkQsRUFBQWlELEtBQUE5QyxFQUFBOEMsS0FFQWpELEVBQUFNLG1CQUFBLEVBQ0FOLEVBQUFPLEtBQUEsU0FBQUMsRUFBQUMsR0FFQSxNQURBckMsU0FBQUMsSUFBQSxjQUFBb0MsR0FDQUwsR0FDQU0sT0FBQSxNQUNBQyxJQUFBLFlBQ0FyQixRQUFBbUIsR0FBQUEsS0FDQUcsS0FBQSxTQUFBNUMsR0FFQWdDLEVBQUFvRCxPQUFBcEYsRUFBQThDLElBQ0EsSUFBQUMsR0FBQWQsRUFBQU0sTUFDQVMsVUFBQWhCLEVBQUFNLGtCQUNBbEQsWUFBQSwwQkFDQTJDLFdBQUEsb0JBQ0FTLEtBQUFBLEVBQ0FTLE1BQUFqQixFQUNBa0IsU0FDQUMsTUFBQSxXQUNBLE1BQUFuQixHQUFBb0QsVUFJQXJDLEdBQUFLLE9BQUFSLEtBQUEsU0FBQVMsR0FDQXJCLEVBQUFzQixTQUFBRCxHQUNBLFdBQ0FuQixFQUFBcUIsS0FBQSx1QkFBQSxHQUFBN0IsWUFLQU0sRUFBQXdCLGdCQUFBLFdBQ0F4QixFQUFBTSxtQkFBQU4sRUFBQU0sc0JDckNBeEQsSUFBQWlELFdBQUEsYUFBQSxTQUFBLFFBQUEsY0FBQSxZQUFBLGFBQUEsU0FBQUMsRUFBQUksRUFBQTFDLEVBQUFELEVBQUFnRSxHQUNBekIsRUFBQXFELE9BQUEsV0FDQWpELEVBQUFrRCxLQUFBLFNBQUF0RCxFQUFBdUQsTUFDQTNDLEtBQUEsU0FBQTVDLEdBQ0FOLEVBQUF5QixVQUFBbkIsRUFBQThDLE1BQ0FXLEVBQUErQixLQUFBOUYsRUFBQW9DLFVBQ0FyQyxFQUFBUyxLQUFBLGlCQ0xBcEIsSUFBQWlELFdBQUEsa0JBQUEsU0FBQSxRQUFBLGdCQUFBLFNBQUFDLEVBQUFJLEVBQUFELEdBQ0FILEVBQUF5RCxhQUVBekQsRUFBQTBELFVBQUEsV0FFQXZELEVBQUEyQixhQUFBOUIsRUFBQXlELFVBQUEzQyxNQUNBMUMsUUFBQUMsSUFBQSx5QkFBQTJCLEVBQUF5RCxXQUVBekQsRUFBQXlELGlCQ1RBM0csSUFBQVMsUUFBQSxpQkFBQSxRQUFBLFNBQUE2QyxHQUNBLEdBQUEyQixNQUNBb0IsS0FDQTlDLEtBQ0E0QyxLQUVBbkIsRUFBQSxTQUFBSyxHQUNBLE1BQUEvQixJQUNBTSxPQUFBLE1BQ0FDLElBQUEsWUFDQXJCLFFBQUErQyxPQUFBRixLQUNBdkIsS0FBQSxTQUFBNUMsR0FDQStELEVBQUEvRCxFQUFBOEMsS0FDQXdCLEVBQUFQLEdBQ0FTLEVBQUFULEdBQ0FRLEVBQUFSLE1BR0FPLEVBQUEsU0FBQUcsR0FDQSxHQUFBa0IsR0FBQSxTQUFBbEIsR0FDQXBDLEVBQUFzQyxPQUFBLEVBQUF0QyxFQUFBdUMsUUFDQUgsRUFBQUksUUFBQSxTQUFBQyxHQUNBLFdBQUFBLEVBQUFDLE1BQ0ExQyxFQUFBMkMsS0FBQUYsS0FNQSxPQUZBYSxHQUFBbEIsR0FDQXJFLFFBQUFDLElBQUEsc0JBQUFnQyxHQUNBQSxHQUdBa0MsRUFBQSxTQUFBRSxHQUNBLEdBQUFtQixHQUFBLFNBQUFuQixHQUNBVSxFQUFBUixPQUFBLEVBQUFRLEVBQUFQLFFBQ0FILEVBQUFJLFFBQUEsU0FBQUMsR0FDQSxTQUFBQSxFQUFBQyxNQUNBSSxFQUFBSCxLQUFBRixLQUtBLE9BRkFjLEdBQUFuQixHQUNBckUsUUFBQUMsSUFBQSx5QkFBQThFLEdBQ0FBLEdBR0FYLEVBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBLFNBQUFELEdBQ0FRLEVBQUFOLE9BQUEsRUFBQU0sRUFBQUwsUUFDQUgsRUFBQUksUUFBQSxTQUFBQyxHQUNBLFNBQUFBLEVBQUFDLE1BQ0FFLEVBQUFELEtBQUFGLEtBS0EsT0FGQUosR0FBQUQsR0FDQXJFLFFBQUFDLElBQUEsdUJBQUE0RSxHQUNBQSxHQUlBWSxHQUNBckIsUUFBQUEsRUFDQUQsVUFBQUEsRUFDQUQsYUFBQUEsRUFDQVIsYUFBQUEsRUFDQUMsUUFBQUEsRUFDQTFCLFVBQUFBLEVBQ0E4QyxPQUFBQSxFQUNBRixLQUFBQSxFQUVBLE9BQUFZLE1DbEVBL0csSUFBQWlELFdBQUEscUJBQUEsU0FBQSxpQkFBQSxTQUFBQyxFQUFBOEQsR0FFQTlELEVBQUErRCxHQUFBLFdBQ0FELEVBQUFFLE1BQUFoRSxFQUFBc0IsU0FBQTJDLE9BR0FqRSxFQUFBa0UsT0FBQSxXQUNBSixFQUFBSyxRQUFBLGNDWEFySCxJQUFBaUQsV0FBQSxXQUFBLGNBQUEsU0FBQSxhQUFBLFlBQUEsU0FBQXJDLEVBQUFzQyxFQUFBeUIsRUFBQWhFLEdBQ0FnRSxFQUFBK0IsS0FBQTlGLEVBQUFvQyxVQUVBMkIsRUFBQStCLE1BQUEvQixFQUFBK0IsS0FBQVksVUFDQTNHLEVBQUFTLEtBQUEsU0FHQThCLEVBQUFILE9BQUEsV0FDQW5DLEVBQUFtQyxTQUNBNEIsRUFBQStCLEtBQUE5RixFQUFBb0MsVUFDQXJDLEVBQUFTLEtBQUEsU0NUQXBCLElBQUFpRCxXQUFBLDRCQUFBLHFCQUFBLFNBQUEsUUFBQSxTQUFBc0UsRUFBQXJFLEVBQUFJLEdBSUFKLEVBQUFzRSxZQUVBdEUsRUFBQXVFLFdBQUEsV0FDQW5HLFFBQUFDLElBQUEsZ0JBQUEyQixFQUFBc0UsU0FBQUUsT0FFQUgsRUFBQUksU0FBQXpFLEVBQUFzRSxTQUFBRSxPQUVBeEUsRUFBQXNFLGdCQ1ZBeEgsSUFBQXlCLFFBQUEsc0JBQUEseUJBQUEsUUFDQSxTQUFBbUQsRUFBQXRCLEdBRUEsR0FDQXNFLEdBQUEsWUFFQWpHLE1BQUFnRyxTQUFBLFdBQ0FyRSxFQUFBa0QsS0FBQSxtQkFBQTFDLEtBQUEsU0FBQUUsR0FDQTFDLFFBQUFDLElBQUF5QyxHQUNBNEQsRUFBQTVELEVBQUFMLElBRUEsU0FBQUssR0FDQTFDLFFBQUFDLElBQUF5QyxLQUVBMUMsUUFBQUMsSUFBQXNHLFNBR0EsSUFBQUMsS0FFQUMsaUJBQ0EscUJBRUFDLFdBQUEsT0FDQUMsVUFBQSxRQUNBQyxhQUFBLFlBQ0FDLFlBQ0FDLEtBQUEsY0FJQUwsaUJBQ0EscUJBRUFDLFdBQUEsT0FDQUMsVUFBQSxTQUNBQyxhQUFBLFlBQ0FDLFlBQ0FDLEtBQUEsY0FXQXpHLE1BQUEwRyxRQUFBLFdBQ0FDLElBQ0FoRixFQUFBa0QsS0FBQSwwQkFBQXNCLEVBQUFGLEdBQUFXLFFBQUEsU0FBQXZFLEVBQUE3QyxFQUFBTCxFQUFBWCxHQUNBbUIsUUFBQUMsSUFBQXlDLEtBRUExQyxRQUFBQyxJQUFBc0csU0FLQSxJQUFBUyxHQUFBLFdBQ0FFLEVBQUEseUJBQUFDLEtBQ0EsV0FDQSxHQUFBOUUsSUFBQWlCLEVBQUFLLFFBQUF0QixHQUFBLENBQ0EsR0FBQStFLElBRUFYLGlCQUNBUyxFQUFBN0csTUFBQWdILE9BRUFYLFdBQUFRLEVBQUE3RyxNQUFBaUgsVUFDQVgsVUFBQU8sRUFBQTdHLE1BQUFrSCxTQUNBWCxhQUFBTSxFQUFBN0csTUFBQW9DLFFBQ0FvRSxZQUNBQyxLQUFBSSxFQUFBN0csTUFBQXlHLE9BR0FOLEdBQUE1QixLQUFBd0MsVUM1RUExSSxJQUFBaUQsV0FBQSxxQkFBQSxxQkFBQSxTQUFBLFFBQUEsU0FBQXNFLEVBQUFyRSxFQUFBSSxHQUlBSixFQUFBc0UsWUFFQXRFLEVBQUE0RixhQUFBLFdBQ0F4SCxRQUFBQyxJQUFBLGdCQUFBNEMsTUFBQXFELFNBQUFFLE9BRUFILEVBQUFjLFVBWUFuRixFQUFBc0UsZ0JDbkJBeEgsSUFBQWlELFdBQUEsZ0JBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUMsRUFBQUksRUFBQTNDLEdBQ0F1QyxFQUFBcUQsT0FBQSxXQUNBakYsUUFBQUMsSUFBQSxnQkFDQUQsUUFBQUMsSUFBQSw2QkFBQTJCLEVBQUF1RCxNQUNBbkQsRUFBQWtELEtBQUEsWUFBQXRELEVBQUF1RCxNQUNBM0MsS0FBQSxTQUFBNUMsR0FDQUksUUFBQUMsSUFBQUwsR0FDQVAsRUFBQVMsS0FBQSxnQkNUQXBCLElBQUFpRCxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUMsRUFBQUksRUFBQTNDLEdBQ0F1QyxFQUFBcUQsT0FBQSxXQUNBakYsUUFBQUMsSUFBQSxpQkFBQTJCLEVBQUF1RCxNQUNBbkQsRUFBQXlGLElBQUEsU0FBQTdGLEVBQUF1RCxNQUNBM0MsS0FBQSxTQUFBNUMsR0FDQUksUUFBQUMsSUFBQUwsR0FDQVAsRUFBQVMsS0FBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdsZW8nLCBbJ25nUm91dGUnLCAnbmdBbmltYXRlJywgJ3VpLmJvb3RzdHJhcCddKTtcblxudmFyIHByZXR0eURhdGUgPSBcIk1NL0REL1lZZ1lZXCI7XG52YXIgZnVsbERhdGUgPSBcIk1NL0REL1lZWVkgaDptbTpzcyBhXCI7XG5cbmZ1bmN0aW9uIGZvcm1hdERhdGVzIChkYXRlKSB7XG5cdHJldHVybiB7XG5cdFx0ZnVsbDogbW9tZW50KGRhdGUpLmZvcm1hdChmdWxsRGF0ZSksXG5cdFx0cHJldHR5OiBtb21lbnQoZGF0ZSkuZm9ybWF0KHByZXR0eURhdGUpXG5cdH07XG59XG5cbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2xvZ2luLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL3NlYXJjaC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvcmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RMaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0TGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkZmFtaWx5Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRmYW1pbHkuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGNvcnAnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGNvcnAuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RsaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvc2VhcmNoJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG4iLCJhcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKSIsImFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KSB7XG5cbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pOyIsIi8vZWRpdCBjb3Jwb3JhdGlvbiBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRDb3JwQ3RybCcsIFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywgJ1Jlc3VsdFNlcnZpY2UnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UsICRodHRwKSB7XG4gICAgLy9zZW5kcyB0aGUgY29tcGFuaWVzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAgICAgJHNjb3BlLmNvbXBhbmllcyA9IFJlc3VsdFNlcnZpY2UuY29tcGFuaWVzO1xuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcblxuICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNpemUsIGlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjb3JwIGNhbGwnLCBpZCk7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnLi4vY29ycG9yYXRpb24nLFxuICAgICAgICAgICAgcGFyYW1zOntpZDppZH1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wYW55ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0Y29ycC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmNvbXBhbnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9ICEkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQ7XG4gICAgfTtcblxuXG59XSk7XG4iLCJhcHAuY29udHJvbGxlcignY3JlYXRlTGlzdFNlYXJjaCcsWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBDb250YWN0TGlzdERhdGFTZXJ2aWNlKXtcbiAgICAkcm9vdFNjb3BlLmFkZCA9IGZhbHNlO1xuICAgICRzY29wZS5saXN0Rm9ybT17fTtcblxuICAgICRzY29wZS5zZWFyY2hMaXN0QnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgIENvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCRzY29wZS5saXN0Rm9ybS5kYXRhKTtcbiAgICAgICAgLy9lbXB0eSB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUubGlzdEZvcm09e307XG4gICAgfTtcbn1dKTsiLCJhcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhbGxDb21wYW5pZXMgPSBbXTtcbiAgICB2YXIgYWxsS2lkcyA9IFtdO1xuICAgIHZhciBhbGxBZHVsdHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbiAocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIFVSTDogJy9jcmVhdGVNYWlsTGlzdCcsXG4gICAgICAgICAgICBwYXJhbXM6IHtzZWFyY2g6IHBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEtpZHMocmVzdWx0cyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxBZHVsdHMuc3BsaWNlKDAsIGFsbEFkdWx0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2FkdWx0JylcbiAgICAgICAgICAgICAgICAgICAgYWxsQWR1bHRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIHJldHVybiBhbGxBZHVsdHNcbiAgICB9O1xuXG4gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbENvbXBhbmllcy5zcGxpY2UoMCwgYWxsQ29tcGFuaWVzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY29tcGFueScpXG4gICAgICAgICAgICAgICAgICAgIGFsbENvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsQ29tcGFuaWVzXG4gICAgfTtcblxuICAgIHZhciBnZXRLaWRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsS2lkcy5zcGxpY2UoMCwgYWxsS2lkcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NoaWxkJylcbiAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsS2lkc1xuICAgIH07XG5cbiAgICB2YXIgZGF0YUFwaSA9IHtcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGwsXG4gICAgICAgIGdldENvbXBhbmllczogZ2V0Q29tcGFuaWVzLFxuICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuICAgICAgICBnZXRBZHVsdHM6IGdldEFkdWx0cyxcbiAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgYWxsS2lkczogYWxsS2lkcyxcbiAgICAgICAgYWxsQWR1bHRzOiBhbGxBZHVsdHMsXG4gICAgICAgIGFsbENvbXBhbmllczogYWxsQ29tcGFuaWVzXG4gICAgfTtcblxuICAgIHJldHVybiBkYXRhQXBpO1xuXG59XSk7XG4iLCIvL2VkaXQgZmFtaWx5IG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdEZhbWlseUN0cmwnLFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywnUmVzdWx0U2VydmljZScsICckaHR0cCcsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSwgJGh0dHApIHtcblxuICAgIC8vc2VuZHMgdGhlIGFkdWx0cyBhbmQga2lkcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgICAgICRzY29wZS5hZHVsdHMgPSBSZXN1bHRTZXJ2aWNlLmFkdWx0cztcbiAgICAgICAgJHNjb3BlLmtpZHMgPSBSZXN1bHRTZXJ2aWNlLmtpZHM7XG5cbiAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuICAgICAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uIChzaXplLCBpZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZhbWlseSBjYWxsJyxpZCk7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgdXJsOiAnLi4vZmFtaWx5JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6e2lkOmlkfVxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICBcdFx0XHQkc2NvcGUuZmFtaWx5ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgIFx0XHRcdFx0c2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmZhbWlseTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgICAgICAgICAgfTtcblxuXG59XSk7IiwiLy9jb250cm9sbGVycyBmb3IgbG9naW5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvc2VhcmNoXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcbn1dKTtcbiIsIlxuLy9UaGlzIHNob3VsZCBnZXQgdGhlIHNlYXJjaCBpdGVtXG5hcHAuY29udHJvbGxlcignc2VhcmNoRnVuY3Rpb24nLCBbJyRzY29wZScsICckaHR0cCcsICdSZXN1bHRTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaEJ0biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgIFJlc3VsdFNlcnZpY2UubWFrZURhdGFDYWxsKCRzY29wZS5mb3JtSW5wdXQuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIHRoZSBpbnB1dCB0ZXh0JywgJHNjb3BlLmZvcm1JbnB1dCk7XG4gICAgICAgIC8vZW1wdHlzIHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG4gICAgfTtcblxufV0pO1xuIiwiLy9UaGlzIHNlcnZpY2Ugc2hvdWxkIHBhc3MgZGF0YSBiZXR3ZWVuIGNvbnRyb2xsZXJzXG5hcHAuZmFjdG9yeSgnUmVzdWx0U2VydmljZScsIFsnJGh0dHAnLGZ1bmN0aW9uKCRodHRwKSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgYWR1bHRzID0gW107XG4gICAgdmFyIGNvbXBhbmllcyA9IFtdO1xuICAgIHZhciBraWRzID0gW107XG5cbiAgICB2YXIgbWFrZURhdGFDYWxsID0gZnVuY3Rpb24ocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL3NlYXJjaCcsXG4gICAgICAgICAgICBwYXJhbXM6e3NlYXJjaDpwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDEgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgY29tcGFuaWVzLnNwbGljZSgwLGNvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjb21wYW55JylcbiAgICAgICAgICAgICAgICBjb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgZ2V0RWxlbWVudDEoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50MScsY29tcGFuaWVzKTtcbiAgICAgICAgcmV0dXJuIGNvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQyID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGFkdWx0cy5zcGxpY2UoMCxhZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnYWR1bHQnKVxuICAgICAgICAgICAgICAgICAgICBhZHVsdHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQyKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgaW4gZ2V0RWxlbWVudDInLCBhZHVsdHMpO1xuICAgICAgICByZXR1cm4gYWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRLaWRzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGtpZHMuc3BsaWNlKDAsa2lkcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudHMzJywga2lkcyk7XG4gICAgICAgIHJldHVybiBraWRzXG4gICAgfTtcblxuICAgIC8vcHVibGljXG4gICAgdmFyIHB1YmxpY0FwaSA9IHtcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIGdldENvbXBhbmllczogZ2V0Q29tcGFuaWVzLFxuICAgICAgICBtYWtlRGF0YUNhbGw6IG1ha2VEYXRhQ2FsbCxcbiAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgY29tcGFuaWVzOiBjb21wYW5pZXMsXG4gICAgICAgIGFkdWx0czogYWR1bHRzLFxuICAgICAgICBraWRzOiBraWRzXG4gICAgfTtcbiAgICByZXR1cm4gcHVibGljQXBpO1xufV0pOyIsIi8vIFBsZWFzZSBub3RlIHRoYXQgJG1vZGFsSW5zdGFuY2UgcmVwcmVzZW50cyBhIG1vZGFsIHdpbmRvdyAoaW5zdGFuY2UpIGRlcGVuZGVuY3kuXG4vLyBJdCBpcyBub3QgdGhlIHNhbWUgYXMgdGhlICR1aWJNb2RhbCBzZXJ2aWNlIHVzZWQgYWJvdmUuXG5cbi8vbmVlZGVkIGZvciBtb2RhbD8/IHByZXR0eSBzdXJlXG5hcHAuY29udHJvbGxlcignTW9kYWxJbnN0YW5jZUN0cmwnLFsnJHNjb3BlJywnJG1vZGFsSW5zdGFuY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSkge1xuXG4gICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUuc2VsZWN0ZWQuaXRlbSk7XG4gICAgfTtcblxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgIH07XG59XSk7IiwiYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywnJHNjb3BlJywnJHJvb3RTY29wZScsJyRsb2NhdGlvbicsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbil7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvaG9tZScpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgfVxufV0pO1xuIiwiLy8gQWpheCBmb3IgY3JlYXRpbmcgdGhlIGNvbnRhY3QgbGlzdCBpbiBjb25zdGFudCBjb250YWN0XG5hcHAuY29udHJvbGxlcignbmV3Q29udGFjdExpc3RDb250cm9sbGVyJyxbJ25ld0NvbnRhY3RMaXN0RGF0YScsJyRzY29wZScsJyRodHRwJywgZnVuY3Rpb24obmV3Q29udGFjdExpc3REYXRhLCAkc2NvcGUsICRodHRwKSB7XG4gICAgLy9kYXRhIHRvIGNyZWF0ZSBhIG5ldyBjb250YWN0IGxpc3RcblxuXG4gICAgJHNjb3BlLmxpc3ROYW1lID0ge307XG5cbiAgICAkc2NvcGUuY3JlYXRlTGlzdCAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlIGxpc3Q6IFwiICsgJHNjb3BlLmxpc3ROYW1lLmlucHV0KTtcbiAgICAgICAgLy9wYXNzZXMgbGlzdCBuYW1lIHNlcnZpY2VcbiAgICAgICAgbmV3Q29udGFjdExpc3REYXRhLnBvc3RMaXN0KCRzY29wZS5saXN0TmFtZS5pbnB1dCk7XG5cbiAgICAgICAgJHNjb3BlLmxpc3ROYW1lPXt9O1xuICAgIH07XG59XSk7XG5cblxuIiwiLy9zZXJ2aWNlIGZvciBhamF4IGNhbGxzIHRvIGNvbnN0YW50IGNvbnRhY3RcblxuYXBwLnNlcnZpY2UoJ25ld0NvbnRhY3RMaXN0RGF0YScsIFsnQ29udGFjdExpc3REYXRhU2VydmljZScsICckaHR0cCcsXG4gICAgZnVuY3Rpb24gKENvbnRhY3RMaXN0RGF0YVNlcnZpY2UsICRodHRwKSB7XG5cbiAgICB2YXIgbmV3Q29udGFjdExpc3QgPSBbXTtcbiAgICB2YXIgbGlzdE51bSA9IFwiMTQ5OTUyMzYxMFwiO1xuXG4gICAgdGhpcy5wb3N0TGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJGh0dHAucG9zdCgnL25ld0NvbnRhY3RMaXN0JykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBsaXN0TnVtID0gZGF0YS5pZFxuXG4gICAgICAgIH0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7IC8vZXJyb3JcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpXG4gICAgfTtcblxuICAgIHZhciBpbXBvcnREYXRhQXJyYXkgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICBcInVzZXIxQGV4YW1wbGUuY29tXCJcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcImZpcnN0X25hbWVcIjogXCJKb2huXCIsXG4gICAgICAgICAgICBcImxhc3RfbmFtZVwiOiBcIlNtaXRoXCIsXG4gICAgICAgICAgICBcImNvbXBhbnlfbmFtZVwiOiBcIkNvbXBhbnkgWFwiLFxuICAgICAgICAgICAgXCJhZGRyZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICBjaXR5OiBcImFueXRvd25cIlxuICAgICAgICAgICAgfV1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgIFwidXNlcjJAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiBcIkphbmVcIixcbiAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6IFwiU21pdGh5XCIsXG4gICAgICAgICAgICBcImNvbXBhbnlfbmFtZVwiOiBcIkNvbXBhbnkgWVwiLFxuICAgICAgICAgICAgXCJhZGRyZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICBjaXR5OiBcInNvbWV0b3duXCJcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICBdO1xuXG4gICAgLy92YXIgY29udGFjdExpc3RPYmplY3QgPSh7XG4gICAgLy8gICAgXCJJbXBvcnQgRGF0YVwiIDogaW1wb3J0RGF0YUFycmF5LFxuICAgIC8vICAgIFwibGlzdFwiOiBbbGlzdE51bV0sXG4gICAgLy8gICAgXCJjb2x1bW5fbmFtZXNcIjpbXCJFTUFJTFwiLFwiRklSU1QgTkFNRVwiLCBcIkxBU1QgTkFNRVwiLCBcIkNJVFlcIixcIkNPTVBBTlkgTkFNRVwiXX0pO1xuXG5cbiAgICB0aGlzLnBvcExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGdldENoZWNrZWQoKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3BvcHVsYXRlQ29udGFjdExpc3QuanMnLCBpbXBvcnREYXRhQXJyYXksIGxpc3ROdW0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpO1xuXG4gICAgfTtcblxuICAgIC8vZ2V0IGFsbCB0aGUgY2hlY2tlZCBlbGVtZW50cyBhbmQgc3R1ZmYgdGhlbSBpbiBhbiBhcnJheVxuICAgIHZhciBnZXRDaGVja2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChcIjpjaGVja2VkLnR5cGUtZWxlbWVudFwiKS5lYWNoKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09IENvbnRhY3RMaXN0RGF0YVNlcnZpY2UucmVzdWx0cy5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhY3RPYmplY3QgPVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5lbWFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6ICQodGhpcykuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6ICQodGhpcykubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21wYW55X25hbWVcIjogJCh0aGlzKS5jb21wYW55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkcmVzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICQodGhpcykuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0RGF0YUFycmF5LnB1c2goY29udGFjdE9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbn1dKTsiLCJhcHAuY29udHJvbGxlcigncG9wTGlzdENvbnRyb2xsZXInLFsnbmV3Q29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihuZXdDb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2RhdGEgdG8gY3JlYXRlIGEgbmV3IGNvbnRhY3QgbGlzdFxuXG5cbiAgICAkc2NvcGUubGlzdE5hbWUgPSB7fTtcblxuICAgICRzY29wZS5wb3B1bGF0ZUxpc3QgID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZSBsaXN0OiBcIiArIHNjb3BlLmxpc3ROYW1lLmlucHV0KTtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgICBuZXdDb250YWN0TGlzdERhdGEucG9wTGlzdCgpO1xuICAgICAgICAvL3ZhciBsaXN0RW5kID0ge1xuICAgICAgICAvLyAgICBcImxpc3RzXCI6IFtsaXN0TnVtXSxcbiAgICAgICAgLy8gICAgXCJjb2x1bW5fbmFtZXNcIjogW1xuICAgICAgICAvLyAgICBcIkVNQUlMXCIsXG4gICAgICAgIC8vICAgIFwiRklSU1QgTkFNRVwiLFxuICAgICAgICAvLyAgICBcIkxBU1QgTkFNRVwiLFxuICAgICAgICAvLyAgICBcIkNJVFlcIixcbiAgICAgICAgLy8gICAgXCJDT01QQU5ZIE5BTUVcIlxuICAgICAgICAvL119XG5cblxuICAgICAgICAkc2NvcGUubGlzdE5hbWU9e307XG4gICAgfTtcbn1dKTtcblxuIiwiXG4vL3JlZ2lzdGVyIGNvbnRyb2xsZXJcbmFwcC5jb250cm9sbGVyKCdyZWdpc3RlckN0cmwnLCBbICckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlZ2lzdGVyQ3RybFwiKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlZ2lzdGVyQ29udHJvbGxlciBzdWJtaXQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvcmVnaXN0ZXInLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9pbmRleFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufV0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ3Jlc2V0Q3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlZGl0IHBhc3N3b3JkOicsICRzY29wZS5mb3JtKTtcbiAgICAgICAgJGh0dHAucHV0KCcvYWRtaW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9pbmRleFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufV0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
