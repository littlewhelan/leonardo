function formatDates(t){return{full:moment(t).format(fullDate),pretty:moment(t).format(prettyDate)}}var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]),prettyDate="MM/DD/YYgYY",fullDate="MM/DD/YYYY h:mm:ss a";app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.companies=o.companies,t.animationsEnabled=!0,t.open=function(o,i){return console.log("corp call",i),a({method:"GET",url:"../corporation",params:{id:i}}).then(function(a){t.company=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.company}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$http","ContactListDataService",function(t,e,n){t.corp={},t.fam={},t.zipCk={},t.ageCk={},t.age={},t.zip={},console.log("Where is this",t.corp,t.fam,t.zipCk,t.ageCk),t.emailList=[],t.searchListBtn=function(){if(1==t.zipCk&&n.makeDataCall("zip",t.zip.data).then(function(e){t.emailList=e,console.log(t.emailList)}),1==t.ageCk){var e=n.makeDataCall("age",t.age.data);e.then(function(e){console.log(e.data),t.emailList=e.data})}if(1==t.fam){var o=n.makeDataCall("family","");o.then(function(e){t.emailList=e.data,console.log(e.data)})}if(1==t.corp){var a=n.makeDataCall("company","");a.then(function(e){t.emailList=e.data,console.log(e.data)})}t.corp={},t.fam={},t.zipCk={},t.ageCk={},t.age={},t.zip={}}}]),app.factory("ContactListDataService",["$http","$q",function(t,e){function n(n,o){var a=e.defer();return console.log("this is in the make data call",n,o),t({method:"GET",url:"../createMailList",params:{type:n,search:o}}).then(function(t){data=t.data,a.resolve(t.data)}),a.promise}return{data:[],makeDataCall:n}}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){t.family=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.family}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,s(e),l(e),r(e)})},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},l=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},c={getKids:l,getAdults:r,getCompanies:s,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return c}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("newContactListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.createList=function(){console.log("create list: "+e.listName.input),t.postList(e.listName.input),e.listName={}}}]),app.service("newContactListData",["ContactListDataService","$http",function(t,e){var n="1499523610";this.postList=function(){e.post("/newContactList").then(function(t){console.log(t),n=t.id},function(t){console.log(t)}),console.log(options)};var o=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];this.popList=function(){a(),e.post("/populateContactList.js",o,n).success(function(t,e,n,o){console.log(t)}),console.log(options)};var a=function(){$(":checked.type-element").each(function(){if(id==t.results.id){var e={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};o.push(e)}})}}]),app.controller("popListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.populateList=function(){console.log("create list: "+scope.listName.input),t.popList(),e.listName={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImZvcm1hdERhdGVzIiwiZGF0ZSIsImZ1bGwiLCJtb21lbnQiLCJmb3JtYXQiLCJmdWxsRGF0ZSIsInByZXR0eSIsInByZXR0eURhdGUiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsImlzQXV0aGVkIiwiQXV0aG9yaXphdGlvbiIsImdldFRva2VuIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZWplY3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsInNhdmVUb2tlbiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwicGFyYW1zIiwibm90RXhwaXJlZCIsIk1hdGgiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsIiRodHRwIiwiY29tcGFuaWVzIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJvcGVuIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsImNvbXBhbnkiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsImFuaW1hdGlvbiIsInNjb3BlIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwidG9nZ2xlQW5pbWF0aW9uIiwiQ29udGFjdExpc3REYXRhU2VydmljZSIsImNvcnAiLCJmYW0iLCJ6aXBDayIsImFnZUNrIiwiYWdlIiwiemlwIiwiZW1haWxMaXN0Iiwic2VhcmNoTGlzdEJ0biIsIm1ha2VEYXRhQ2FsbCIsInJlc3VsdHMiLCJjb21wIiwidHlwZSIsInBhc3NlZERhdGEiLCJkZWZlcnJlZCIsImRlZmVyIiwic2VhcmNoIiwicHJvbWlzZSIsImFkdWx0cyIsImtpZHMiLCJmYW1pbHkiLCIkcm9vdFNjb3BlIiwic3VibWl0IiwicG9zdCIsImZvcm0iLCJ1c2VyIiwiZm9ybUlucHV0Iiwic2VhcmNoQnRuIiwiZ2V0Q29tcGFuaWVzIiwiZ2V0S2lkcyIsImdldEFkdWx0cyIsImFycmF5IiwiZ2V0RWxlbWVudDEiLCJzcGxpY2UiLCJsZW5ndGgiLCJmb3JFYWNoIiwiZWxlbWVudCIsInB1c2giLCJnZXRFbGVtZW50MiIsImdldEVsZW1lbnQzIiwicHVibGljQXBpIiwiJG1vZGFsSW5zdGFuY2UiLCJvayIsImNsb3NlIiwiaXRlbSIsImNhbmNlbCIsImRpc21pc3MiLCJ1c2VybmFtZSIsIm5ld0NvbnRhY3RMaXN0RGF0YSIsImxpc3ROYW1lIiwiY3JlYXRlTGlzdCIsImlucHV0IiwicG9zdExpc3QiLCJsaXN0TnVtIiwib3B0aW9ucyIsImltcG9ydERhdGFBcnJheSIsImVtYWlsX2FkZHJlc3NlcyIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJjb21wYW55X25hbWUiLCJhZGRyZXNzZXMiLCJjaXR5IiwicG9wTGlzdCIsImdldENoZWNrZWQiLCJzdWNjZXNzIiwiJCIsImVhY2giLCJjb250YWN0T2JqZWN0IiwiZW1haWwiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInBvcHVsYXRlTGlzdCIsInB1dCJdLCJtYXBwaW5ncyI6IkFBS0EsUUFBQUEsYUFBQUMsR0FDQSxPQUNBQyxLQUFBQyxPQUFBRixHQUFBRyxPQUFBQyxVQUNBQyxPQUFBSCxPQUFBRixHQUFBRyxPQUFBRyxhQVJBLEdBQUFDLEtBQUFDLFFBQUFDLE9BQUEsT0FBQSxVQUFBLFlBQUEsaUJBRUFILFdBQUEsY0FDQUYsU0FBQSxzQkFTQUcsS0FBQUcsUUFBQSxpQkFDQSxTQUFBQyxHQUNBQSxFQUNBQyxLQUFBLEtBQ0FDLFlBQUEsc0JBRUFELEtBQUEsV0FDQUMsWUFBQSx3QkFFQUQsS0FBQSxhQUNBQyxZQUFBLHlCQUVBRCxLQUFBLGdCQUNBQyxZQUFBLDZCQUVBRCxLQUFBLGNBQ0FDLFlBQUEsMkJBRUFELEtBQUEsWUFDQUMsWUFBQSx5QkFFQUQsS0FBQSxnQkFDQUMsWUFBQSw2QkFFQUMsV0FDQUMsV0FBQSxlQ3JDQVIsSUFBQVMsUUFBQSxtQkFBQSxLQUFBLFlBQUEsY0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE9BQ0FDLFFBQUEsU0FBQVYsR0FLQSxNQUpBQSxHQUFBVyxRQUFBWCxFQUFBVyxZQUNBRixFQUFBRyxhQUNBWixFQUFBVyxRQUFBRSxjQUFBLFVBQUFKLEVBQUFLLFlBRUFkLEdBRUFlLFNBQUEsU0FBQUEsR0FPQSxNQUxBLE9BQUFBLEVBQUFDLFFBR0FSLEVBQUFTLEtBQUEsS0FFQUYsR0FBQVIsRUFBQUwsS0FBQWEsSUFDQUcsY0FBQSxTQUFBSCxHQVNBLE1BUkEsT0FBQUEsRUFBQUMsT0FHQVIsRUFBQVMsS0FB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d0UsWUFDQUMsS0FBQUksRUFBQWpILE1BQUE2RyxPQUdBTixHQUFBbEIsS0FBQThCLFVDNUVBOUksSUFBQWlELFdBQUEscUJBQUEscUJBQUEsU0FBQSxRQUFBLFNBQUEwRSxFQUFBekUsRUFBQUksR0FJQUosRUFBQTBFLFlBRUExRSxFQUFBZ0csYUFBQSxXQUNBNUgsUUFBQUMsSUFBQSxnQkFBQTRDLE1BQUF5RCxTQUFBRSxPQUVBSCxFQUFBYyxVQVlBdkYsRUFBQTBFLGdCQ25CQTVILElBQUFpRCxXQUFBLGdCQUFBLFNBQUEsUUFBQSxZQUFBLFNBQUFDLEVBQUFJLEVBQUEzQyxHQUNBdUMsRUFBQStDLE9BQUEsV0FDQTNFLFFBQUFDLElBQUEsZ0JBQ0FELFFBQUFDLElBQUEsNkJBQUEyQixFQUFBaUQsTUFDQTdDLEVBQUE0QyxLQUFBLFlBQUFoRCxFQUFBaUQsTUFDQXJDLEtBQUEsU0FBQTVDLEdBQ0FJLFFBQUFDLElBQUFMLEdBQ0FQLEVBQUFTLEtBQUEsZ0JDVEFwQixJQUFBaUQsV0FBQSxhQUFBLFNBQUEsUUFBQSxZQUFBLFNBQUFDLEVBQUFJLEVBQUEzQyxHQUNBdUMsRUFBQStDLE9BQUEsV0FDQTNFLFFBQUFDLElBQUEsaUJBQUEyQixFQUFBaUQsTUFDQTdDLEVBQUE2RixJQUFBLFNBQUFqRyxFQUFBaUQsTUFDQXJDLEtBQUEsU0FBQTVDLEdBQ0FJLFFBQUFDLElBQUFMLEdBQ0FQLEVBQUFTLEtBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbGVvJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZScsICd1aS5ib290c3RyYXAnXSk7XG5cbnZhciBwcmV0dHlEYXRlID0gXCJNTS9ERC9ZWWdZWVwiO1xudmFyIGZ1bGxEYXRlID0gXCJNTS9ERC9ZWVlZIGg6bW06c3MgYVwiO1xuXG5mdW5jdGlvbiBmb3JtYXREYXRlcyAoZGF0ZSkge1xuXHRyZXR1cm4ge1xuXHRcdGZ1bGw6IG1vbWVudChkYXRlKS5mb3JtYXQoZnVsbERhdGUpLFxuXHRcdHByZXR0eTogbW9tZW50KGRhdGUpLmZvcm1hdChwcmV0dHlEYXRlKVxuXHR9O1xufVxuXG5hcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLFxuICAgIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLlxuICAgICAgICAgICAgd2hlbignLycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9sb2dpbi5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvc2VhcmNoJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9zZWFyY2guaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL3JlZ2lzdGVyJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9jb250YWN0TGlzdCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvY29udGFjdExpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGZhbWlseScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvYWRkZmFtaWx5Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9hZGRjb3JwJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRjb3JwLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9jb250YWN0bGlzdCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvY29udGFjdGxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgb3RoZXJ3aXNlKHtcbiAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnL3NlYXJjaCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuIiwiYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSkiLCJhcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuXG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTsiLCIvL2VkaXQgY29ycG9yYXRpb24gbW9kYWwgdGVtcGxhdGVcbmFwcC5jb250cm9sbGVyKCdlZGl0Q29ycEN0cmwnLCBbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsICdSZXN1bHRTZXJ2aWNlJywgJyRodHRwJywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkbG9nLCBSZXN1bHRTZXJ2aWNlLCAkaHR0cCkge1xuICAgIC8vc2VuZHMgdGhlIGNvbXBhbmllcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgICAgICRzY29wZS5jb21wYW5pZXMgPSBSZXN1bHRTZXJ2aWNlLmNvbXBhbmllcztcblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG5cbiAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uIChzaXplLCBpZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnY29ycCBjYWxsJywgaWQpO1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL2NvcnBvcmF0aW9uJyxcbiAgICAgICAgICAgIHBhcmFtczp7aWQ6aWR9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGNvcnAuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5jb21wYW55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUudG9nZ2xlQW5pbWF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgIH07XG5cblxufV0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUxpc3RTZWFyY2gnLCBbJyRzY29wZScsICckaHR0cCcsICdDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIENvbnRhY3RMaXN0RGF0YVNlcnZpY2UpIHtcbiAgICAkc2NvcGUuY29ycCA9IHt9O1xuICAgICRzY29wZS5mYW0gPSB7fTtcbiAgICAkc2NvcGUuemlwQ2sgPSB7fTtcbiAgICAkc2NvcGUuYWdlQ2sgPSB7fTtcbiAgICAkc2NvcGUuYWdlID0ge307XG4gICAgJHNjb3BlLnppcCA9IHt9O1xuICAgIGNvbnNvbGUubG9nKCdXaGVyZSBpcyB0aGlzJyxcbiAgICAgICAgJHNjb3BlLmNvcnAsXG4gICAgICAgICRzY29wZS5mYW0sXG4gICAgICAgICRzY29wZS56aXBDayxcbiAgICAgICAgJHNjb3BlLmFnZUNrXG4gICAgKTtcblxuICAgICRzY29wZS5lbWFpbExpc3QgPSBbIF07XG5cbiAgICAkc2NvcGUuc2VhcmNoTGlzdEJ0biA9IGZ1bmN0aW9uICgpIHtcblxuXG4gICAgICAgIC8vVEhJUyBXT1JLUyAgLS0gd2lsbCBzZWFyY2ggYnkgemlwXG4gICAgICAgIGlmICgkc2NvcGUuemlwQ2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJ3ppcCcsICRzY29wZS56aXAuZGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZW1haWxMaXN0ID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmVtYWlsTGlzdCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy9USElTIFdPUktTIC0gd2lsbCBzZWFyY2ggYnkgYWdlXG4gICAgICAgIGlmICgkc2NvcGUuYWdlQ2sgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgdmFyIGFnZSA9IENvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCdhZ2UnLCAkc2NvcGUuYWdlLmRhdGEpO1xuICAgICAgICAgICAgYWdlLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzLmRhdGEpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lbWFpbExpc3QgPSByZXN1bHRzLmRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vVEhJUyBXT1JLUyAtLWdldCBhbGwgZmFtaWxpZXMgaWYgZmFtIGlzIHRydWVcbiAgICAgICAgaWYgKCRzY29wZS5mYW0gPT0gdHJ1ZSkge1xuICAgICAgICAgICAgdmFyIGZhbSA9IENvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCdmYW1pbHknLCAnJyk7XG4gICAgICAgICAgICBmYW0udGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICAgICAgICAgICRzY29wZS5lbWFpbExpc3QgPSByZXN1bHRzLmRhdGE7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0cy5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgYWxsIGNvcnAgaWYgY29ycCBpcyB0cnVlXG4gICAgICAgIGlmICgkc2NvcGUuY29ycCA9PSB0cnVlKSB7XG4gICAgICAgICAgICB2YXIgY29tcCA9IENvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCdjb21wYW55JywgJycpO1xuICAgICAgICAgICAgY29tcC50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVtYWlsTGlzdCA9IHJlc3VsdHMuZGF0YTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzLmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2VtcHR5IHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5jb3JwID0ge307XG4gICAgICAgICRzY29wZS5mYW0gPSB7fTtcbiAgICAgICAgJHNjb3BlLnppcENrID0ge307XG4gICAgICAgICRzY29wZS5hZ2VDayA9IHt9O1xuICAgICAgICAkc2NvcGUuYWdlID0ge307XG4gICAgICAgICRzY29wZS56aXAgPSB7fTtcblxuXG4gICAgfTtcblxuXG59XSk7IiwiYXBwLmZhY3RvcnkoJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBbJyRodHRwJywgJyRxJywgZnVuY3Rpb24gKCRodHRwLCAkcSkge1xuXG4gICAgZnVuY3Rpb24gbWFrZURhdGFDYWxsKHR5cGUsIHBhc3NlZERhdGEpIHtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgaW4gdGhlIG1ha2UgZGF0YSBjYWxsJywgdHlwZSwgcGFzc2VkRGF0YSk7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9jcmVhdGVNYWlsTGlzdCcsXG4gICAgICAgICAgICBwYXJhbXM6IHt0eXBlOiB0eXBlLCBzZWFyY2g6IHBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGxcbiAgICB9O1xuXG5cbn1dKTsiLCIvL2VkaXQgZmFtaWx5IG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdEZhbWlseUN0cmwnLFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywnUmVzdWx0U2VydmljZScsICckaHR0cCcsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSwgJGh0dHApIHtcblxuICAgIC8vc2VuZHMgdGhlIGFkdWx0cyBhbmQga2lkcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgICAgICRzY29wZS5hZHVsdHMgPSBSZXN1bHRTZXJ2aWNlLmFkdWx0cztcbiAgICAgICAgJHNjb3BlLmtpZHMgPSBSZXN1bHRTZXJ2aWNlLmtpZHM7XG5cbiAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuICAgICAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uIChzaXplLCBpZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZhbWlseSBjYWxsJyxpZCk7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgdXJsOiAnLi4vZmFtaWx5JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6e2lkOmlkfVxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICBcdFx0XHQkc2NvcGUuZmFtaWx5ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgIFx0XHRcdFx0c2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmZhbWlseTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgICAgICAgICAgfTtcblxuXG59XSk7IiwiLy9jb250cm9sbGVycyBmb3IgbG9naW5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvc2VhcmNoXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcbn1dKTtcbiIsIlxuLy9UaGlzIHNob3VsZCBnZXQgdGhlIHNlYXJjaCBpdGVtXG5hcHAuY29udHJvbGxlcignc2VhcmNoRnVuY3Rpb24nLCBbJyRzY29wZScsICckaHR0cCcsICdSZXN1bHRTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaEJ0biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgIFJlc3VsdFNlcnZpY2UubWFrZURhdGFDYWxsKCRzY29wZS5mb3JtSW5wdXQuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIHRoZSBpbnB1dCB0ZXh0JywgJHNjb3BlLmZvcm1JbnB1dCk7XG4gICAgICAgIC8vZW1wdHlzIHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG4gICAgfTtcblxufV0pO1xuIiwiLy9UaGlzIHNlcnZpY2Ugc2hvdWxkIHBhc3MgZGF0YSBiZXR3ZWVuIGNvbnRyb2xsZXJzXG5hcHAuZmFjdG9yeSgnUmVzdWx0U2VydmljZScsIFsnJGh0dHAnLGZ1bmN0aW9uKCRodHRwKSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgYWR1bHRzID0gW107XG4gICAgdmFyIGNvbXBhbmllcyA9IFtdO1xuICAgIHZhciBraWRzID0gW107XG5cbiAgICB2YXIgbWFrZURhdGFDYWxsID0gZnVuY3Rpb24ocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL3NlYXJjaCcsXG4gICAgICAgICAgICBwYXJhbXM6e3NlYXJjaDpwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDEgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgY29tcGFuaWVzLnNwbGljZSgwLGNvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjb21wYW55JylcbiAgICAgICAgICAgICAgICBjb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgZ2V0RWxlbWVudDEoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50MScsY29tcGFuaWVzKTtcbiAgICAgICAgcmV0dXJuIGNvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQyID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGFkdWx0cy5zcGxpY2UoMCxhZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnYWR1bHQnKVxuICAgICAgICAgICAgICAgICAgICBhZHVsdHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQyKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgaW4gZ2V0RWxlbWVudDInLCBhZHVsdHMpO1xuICAgICAgICByZXR1cm4gYWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRLaWRzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGtpZHMuc3BsaWNlKDAsa2lkcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudHMzJywga2lkcyk7XG4gICAgICAgIHJldHVybiBraWRzXG4gICAgfTtcblxuICAgIC8vcHVibGljXG4gICAgdmFyIHB1YmxpY0FwaSA9IHtcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIGdldENvbXBhbmllczogZ2V0Q29tcGFuaWVzLFxuICAgICAgICBtYWtlRGF0YUNhbGw6IG1ha2VEYXRhQ2FsbCxcbiAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgY29tcGFuaWVzOiBjb21wYW5pZXMsXG4gICAgICAgIGFkdWx0czogYWR1bHRzLFxuICAgICAgICBraWRzOiBraWRzXG4gICAgfTtcbiAgICByZXR1cm4gcHVibGljQXBpO1xufV0pOyIsIi8vIFBsZWFzZSBub3RlIHRoYXQgJG1vZGFsSW5zdGFuY2UgcmVwcmVzZW50cyBhIG1vZGFsIHdpbmRvdyAoaW5zdGFuY2UpIGRlcGVuZGVuY3kuXG4vLyBJdCBpcyBub3QgdGhlIHNhbWUgYXMgdGhlICR1aWJNb2RhbCBzZXJ2aWNlIHVzZWQgYWJvdmUuXG5cbi8vbmVlZGVkIGZvciBtb2RhbD8/IHByZXR0eSBzdXJlXG5hcHAuY29udHJvbGxlcignTW9kYWxJbnN0YW5jZUN0cmwnLFsnJHNjb3BlJywnJG1vZGFsSW5zdGFuY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSkge1xuXG4gICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUuc2VsZWN0ZWQuaXRlbSk7XG4gICAgfTtcblxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xuICAgIH07XG59XSk7IiwiYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywnJHNjb3BlJywnJHJvb3RTY29wZScsJyRsb2NhdGlvbicsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbil7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvaG9tZScpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgfVxufV0pO1xuIiwiLy8gQWpheCBmb3IgY3JlYXRpbmcgdGhlIGNvbnRhY3QgbGlzdCBpbiBjb25zdGFudCBjb250YWN0XG5hcHAuY29udHJvbGxlcignbmV3Q29udGFjdExpc3RDb250cm9sbGVyJyxbJ25ld0NvbnRhY3RMaXN0RGF0YScsJyRzY29wZScsJyRodHRwJywgZnVuY3Rpb24obmV3Q29udGFjdExpc3REYXRhLCAkc2NvcGUsICRodHRwKSB7XG4gICAgLy9kYXRhIHRvIGNyZWF0ZSBhIG5ldyBjb250YWN0IGxpc3RcblxuXG4gICAgJHNjb3BlLmxpc3ROYW1lID0ge307XG5cbiAgICAkc2NvcGUuY3JlYXRlTGlzdCAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlIGxpc3Q6IFwiICsgJHNjb3BlLmxpc3ROYW1lLmlucHV0KTtcbiAgICAgICAgLy9wYXNzZXMgbGlzdCBuYW1lIHNlcnZpY2VcbiAgICAgICAgbmV3Q29udGFjdExpc3REYXRhLnBvc3RMaXN0KCRzY29wZS5saXN0TmFtZS5pbnB1dCk7XG5cbiAgICAgICAgJHNjb3BlLmxpc3ROYW1lPXt9O1xuICAgIH07XG59XSk7XG5cblxuIiwiLy9zZXJ2aWNlIGZvciBhamF4IGNhbGxzIHRvIGNvbnN0YW50IGNvbnRhY3RcblxuYXBwLnNlcnZpY2UoJ25ld0NvbnRhY3RMaXN0RGF0YScsIFsnQ29udGFjdExpc3REYXRhU2VydmljZScsICckaHR0cCcsXG4gICAgZnVuY3Rpb24gKENvbnRhY3RMaXN0RGF0YVNlcnZpY2UsICRodHRwKSB7XG5cbiAgICB2YXIgbmV3Q29udGFjdExpc3QgPSBbXTtcbiAgICB2YXIgbGlzdE51bSA9IFwiMTQ5OTUyMzYxMFwiO1xuXG4gICAgdGhpcy5wb3N0TGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJGh0dHAucG9zdCgnL25ld0NvbnRhY3RMaXN0JykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBsaXN0TnVtID0gZGF0YS5pZFxuXG4gICAgICAgIH0sIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7IC8vZXJyb3JcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpXG4gICAgfTtcblxuICAgIHZhciBpbXBvcnREYXRhQXJyYXkgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICBcInVzZXIxQGV4YW1wbGUuY29tXCJcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcImZpcnN0X25hbWVcIjogXCJKb2huXCIsXG4gICAgICAgICAgICBcImxhc3RfbmFtZVwiOiBcIlNtaXRoXCIsXG4gICAgICAgICAgICBcImNvbXBhbnlfbmFtZVwiOiBcIkNvbXBhbnkgWFwiLFxuICAgICAgICAgICAgXCJhZGRyZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICBjaXR5OiBcImFueXRvd25cIlxuICAgICAgICAgICAgfV1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgIFwidXNlcjJAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiBcIkphbmVcIixcbiAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6IFwiU21pdGh5XCIsXG4gICAgICAgICAgICBcImNvbXBhbnlfbmFtZVwiOiBcIkNvbXBhbnkgWVwiLFxuICAgICAgICAgICAgXCJhZGRyZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICBjaXR5OiBcInNvbWV0b3duXCJcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICBdO1xuXG4gICAgLy92YXIgY29udGFjdExpc3RPYmplY3QgPSh7XG4gICAgLy8gICAgXCJJbXBvcnQgRGF0YVwiIDogaW1wb3J0RGF0YUFycmF5LFxuICAgIC8vICAgIFwibGlzdFwiOiBbbGlzdE51bV0sXG4gICAgLy8gICAgXCJjb2x1bW5fbmFtZXNcIjpbXCJFTUFJTFwiLFwiRklSU1QgTkFNRVwiLCBcIkxBU1QgTkFNRVwiLCBcIkNJVFlcIixcIkNPTVBBTlkgTkFNRVwiXX0pO1xuXG5cbiAgICB0aGlzLnBvcExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGdldENoZWNrZWQoKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3BvcHVsYXRlQ29udGFjdExpc3QuanMnLCBpbXBvcnREYXRhQXJyYXksIGxpc3ROdW0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpO1xuXG4gICAgfTtcblxuICAgIC8vZ2V0IGFsbCB0aGUgY2hlY2tlZCBlbGVtZW50cyBhbmQgc3R1ZmYgdGhlbSBpbiBhbiBhcnJheVxuICAgIHZhciBnZXRDaGVja2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChcIjpjaGVja2VkLnR5cGUtZWxlbWVudFwiKS5lYWNoKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09IENvbnRhY3RMaXN0RGF0YVNlcnZpY2UucmVzdWx0cy5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhY3RPYmplY3QgPVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5lbWFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6ICQodGhpcykuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6ICQodGhpcykubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21wYW55X25hbWVcIjogJCh0aGlzKS5jb21wYW55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkcmVzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICQodGhpcykuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1wb3J0RGF0YUFycmF5LnB1c2goY29udGFjdE9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbn1dKTsiLCJhcHAuY29udHJvbGxlcigncG9wTGlzdENvbnRyb2xsZXInLFsnbmV3Q29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihuZXdDb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2RhdGEgdG8gY3JlYXRlIGEgbmV3IGNvbnRhY3QgbGlzdFxuXG5cbiAgICAkc2NvcGUubGlzdE5hbWUgPSB7fTtcblxuICAgICRzY29wZS5wb3B1bGF0ZUxpc3QgID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZSBsaXN0OiBcIiArIHNjb3BlLmxpc3ROYW1lLmlucHV0KTtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgICBuZXdDb250YWN0TGlzdERhdGEucG9wTGlzdCgpO1xuICAgICAgICAvL3ZhciBsaXN0RW5kID0ge1xuICAgICAgICAvLyAgICBcImxpc3RzXCI6IFtsaXN0TnVtXSxcbiAgICAgICAgLy8gICAgXCJjb2x1bW5fbmFtZXNcIjogW1xuICAgICAgICAvLyAgICBcIkVNQUlMXCIsXG4gICAgICAgIC8vICAgIFwiRklSU1QgTkFNRVwiLFxuICAgICAgICAvLyAgICBcIkxBU1QgTkFNRVwiLFxuICAgICAgICAvLyAgICBcIkNJVFlcIixcbiAgICAgICAgLy8gICAgXCJDT01QQU5ZIE5BTUVcIlxuICAgICAgICAvL119XG5cblxuICAgICAgICAkc2NvcGUubGlzdE5hbWU9e307XG4gICAgfTtcbn1dKTtcblxuIiwiXG4vL3JlZ2lzdGVyIGNvbnRyb2xsZXJcbmFwcC5jb250cm9sbGVyKCdyZWdpc3RlckN0cmwnLCBbICckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlZ2lzdGVyQ3RybFwiKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlZ2lzdGVyQ29udHJvbGxlciBzdWJtaXQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvcmVnaXN0ZXInLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9pbmRleFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufV0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ3Jlc2V0Q3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlZGl0IHBhc3N3b3JkOicsICRzY29wZS5mb3JtKTtcbiAgICAgICAgJGh0dHAucHV0KCcvYWRtaW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9pbmRleFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxufV0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
