var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.companies=o.companies,t.animationsEnabled=!0,t.openCorp=function(o,i){return console.log("corp call",i),a({method:"GET",url:"../corporation",params:{id:i}}).then(function(a){results=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$rootScope","ContactListDataService",function(t,e,n){e.add=!1,t.listForm={},t.searchListBtn=function(){n.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(t){return http({method:"GET",URL:"../createMailList",params:{search:t}}).then(function(t){e=t.data,r(e),s(e),c(e)})},s=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},c=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},l={makeDataCall:i,getCompanies:r,getKids:c,getAdults:s,results:e,allKids:o,allAdults:a,allCompanies:n};return l}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){results=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,s(e),c(e),r(e)})},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},c=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},l={getKids:c,getAdults:r,getCompanies:s,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return l}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("newContactListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.createList=function(){console.log("create list: "+scope.listname.input),t.postList(scope.listname.input),e.listname={}}}]),app.service("contactListData",["contactListDataService","$scope","$http",function(t,e,n){function o(){$(":checked.type-element").each(function(){if(id=createListService.results.id){var t={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};s.push(t)}})}var a=[],i="1499523610";e.postList=function(){n.post("/newContactList").success(function(t,e,n,o){console.log(t),i=t.id}),console.log(options)};var s=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];return e.popList=function(){o(),n.post("/populateContactList.js",s,i).success(function(t,e,n,o){console.log(t)}),console.log(options)},{newContactList:a,listNum:i}}]),app.controller("popListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.populateList=function(){console.log("create list: "+scope.listname.input),t.popList(),e.listname={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJmYWN0b3J5IiwiJHEiLCIkbG9jYXRpb24iLCJhdXRoU2VydmljZSIsInJlcXVlc3QiLCJoZWFkZXJzIiwiaXNBdXRoZWQiLCJBdXRob3JpemF0aW9uIiwiZ2V0VG9rZW4iLCJyZXNwb25zZSIsInN0YXR1cyIsInBhdGgiLCJyZXNwb25zZUVycm9yIiwiY29uc29sZSIsImxvZyIsInJlamVjdCIsInNlcnZpY2UiLCIkd2luZG93IiwidGhpcyIsInBhcnNlSnd0IiwidG9rZW4iLCJiYXNlNjRVcmwiLCJzcGxpdCIsImJhc2U2NCIsInJlcGxhY2UiLCJKU09OIiwicGFyc2UiLCJhdG9iIiwic2F2ZVRva2VuIiwibG9jYWxTdG9yYWdlIiwiand0VG9rZW4iLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJsb2dvdXQiLCJnZXRVc2VyIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiR1aWJNb2RhbCIsIiRsb2ciLCJSZXN1bHRTZXJ2aWNlIiwiJGh0dHAiLCJjb21wYW5pZXMiLCJhbmltYXRpb25zRW5hYmxlZCIsIm9wZW5Db3JwIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsInJlc3VsdHMiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsIm9wZW4iLCJhbmltYXRpb24iLCJyZXN1bHQiLCJzZWxlY3RlZEl0ZW0iLCJzZWxlY3RlZCIsImluZm8iLCJ0b2dnbGVBbmltYXRpb24iLCIkcm9vdFNjb3BlIiwiQ29udGFjdExpc3REYXRhU2VydmljZSIsImFkZCIsImxpc3RGb3JtIiwic2VhcmNoTGlzdEJ0biIsIm1ha2VEYXRhQ2FsbCIsImFsbENvbXBhbmllcyIsImFsbEtpZHMiLCJhbGxBZHVsdHMiLCJwYXNzZWREYXRhIiwiaHR0cCIsIlVSTCIsInNlYXJjaCIsImdldENvbXBhbmllcyIsImdldEFkdWx0cyIsImdldEtpZHMiLCJhcnJheSIsImdldEVsZW1lbnQzIiwic3BsaWNlIiwibGVuZ3RoIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0eXBlIiwicHVzaCIsImtpZHMiLCJkYXRhQXBpIiwiYWR1bHRzIiwic3VibWl0IiwicG9zdCIsImZvcm0iLCJ1c2VyIiwiZm9ybUlucHV0Iiwic2VhcmNoQnRuIiwiZ2V0RWxlbWVudDEiLCJnZXRFbGVtZW50MiIsInB1YmxpY0FwaSIsIiRtb2RhbEluc3RhbmNlIiwib2siLCJjbG9zZSIsIml0ZW0iLCJjYW5jZWwiLCJkaXNtaXNzIiwidXNlcm5hbWUiLCJjb250YWN0TGlzdERhdGEiLCJsaXN0bmFtZSIsImNyZWF0ZUxpc3QiLCJzY29wZSIsImlucHV0IiwicG9zdExpc3QiLCJjb250YWN0TGlzdERhdGFTZXJ2aWNlIiwiZ2V0Q2hlY2tlZCIsIiQiLCJlYWNoIiwiY3JlYXRlTGlzdFNlcnZpY2UiLCJjb250YWN0T2JqZWN0IiwiZW1haWxfYWRkcmVzc2VzIiwiZW1haWwiLCJmaXJzdF9uYW1lIiwiZmlyc3ROYW1lIiwibGFzdF9uYW1lIiwibGFzdE5hbWUiLCJjb21wYW55X25hbWUiLCJjb21wYW55IiwiYWRkcmVzc2VzIiwiY2l0eSIsImltcG9ydERhdGFBcnJheSIsIm5ld0NvbnRhY3RMaXN0IiwibGlzdE51bSIsInN1Y2Nlc3MiLCJvcHRpb25zIiwicG9wTGlzdCIsInBvcHVsYXRlTGlzdCIsInB1dCJdLCJtYXBwaW5ncyI6IkFBQ0EsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxPQUFBLFVBQUEsWUFBQSxnQkFFQUYsS0FBQUcsUUFBQSxpQkFDQSxTQUFBQyxHQUNBQSxFQUNBQyxLQUFBLEtBQ0FDLFlBQUEsc0JBRUFELEtBQUEsV0FDQUMsWUFBQSx3QkFFQUQsS0FBQSxhQUNBQyxZQUFBLHlCQUVBRCxLQUFBLGdCQUNBQyxZQUFBLDZCQUVBRCxLQUFBLGNBQ0FDLFlBQUEsMkJBRUFELEtBQUEsWUFDQUMsWUFBQSx5QkFFQUQsS0FBQSxnQkFDQUMsWUFBQSw2QkFFQUMsV0FDQUMsV0FBQSxlQzVCQVIsSUFBQVMsUUFBQSxtQkFBQSxLQUFBLFlBQUEsY0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE9BQ0FDLFFBQUEsU0FBQVYsR0FLQSxNQUpBQSxHQUFBVyxRQUFBWCxFQUFBVyxZQUNBRixFQUFBRyxhQUNBWixFQUFBVyxRQUFBRSxjQUFBLFVBQUFKLEVBQUFLLFlBRUFkLEdBRUFlLFNBQUEsU0FBQUEsR0FPQSxNQUxBLE9BQUFBLEVBQUFDLFFBR0FSLEVBQUFTLEtBQUEsS0FFQUYsR0FBQVIsRUFBQUwsS0FBQWEsSUFDQUcsY0FBQSxTQUFBSCxHQVNBLE1BUkEsT0FBQUEsRUFBQUMsT0FHQVIsRUFBQVMsS0FBQSxLQUdBRSxRQUFBQyxJQUFBTCxFQUFBQyxRQUVBVCxFQUFBYyxPQUFBTixRQzFCQWxCLElBQUF5QixRQUFBLGVBQUEsVUFBQSxTQUFBQyxHQUVBQyxLQUFBQyxTQUFBLFNBQUFDLEdBQ0EsR0FBQUEsRUFBQSxDQUNBLEdBQUFDLEdBQUFELEVBQUFFLE1BQUEsS0FBQSxH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QUFBM0MsR0FDQXVDLEVBQUFrRCxPQUFBLFdBQ0E5RSxRQUFBQyxJQUFBLGlCQUFBMkIsRUFBQW9ELE1BQ0FoRCxFQUFBMkYsSUFBQSxTQUFBL0YsRUFBQW9ELE1BQ0F4QyxLQUFBLFNBQUE1QyxHQUNBSSxRQUFBQyxJQUFBTCxHQUNBUCxFQUFBUyxLQUFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbGVvJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZScsICd1aS5ib290c3RyYXAnXSk7XG5cbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2xvZ2luLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL3NlYXJjaC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvcmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RMaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0TGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkZmFtaWx5Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRmYW1pbHkuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGNvcnAnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGNvcnAuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RsaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvc2VhcmNoJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cbi8vLmNvbnRyb2xsZXIoJ25ld0NvbnRhY3RMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckcm9vdFNjb3BlJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGEsJHJvb3RTY29wZSwgJHNjb3BlLCAkaHR0cCkge1xuLy8gLy9kYXRhIHRvIGNyZWF0ZSBhIG5ldyBjb250YWN0IGxpc3Rcbi8vICRzY29wZS5saXN0bmFtZSA9IHt9O1xuLy9cbi8vICRzY29wZS5oaWRlID0gZnVuY3Rpb24oKXtcbi8vICAgICAkcm9vdFNjb3BlLmFkZCA9IHRydWU7XG4vLyB9O1xuLy9cbi8vIC8vaGVhZGVyc1xuLy8gJHNjb3BlLmNvbmZpZyA9IHtcbi8vICAgICBoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyIGVmNWQ1ZGYyLWE4MDgtNGM3MC1hNWQ5LWViNzExNjNjYmViOScsXG4vL1xuLy8gICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbi8vXG4vLyAgICAgfVxuLy8gfTtcblxuXG4vL2FwcC5jb250cm9sbGVyKCdjb250YWN0TGlzdENvbnRyb2xsZXInLFsnY29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbi8vXG4vL1xuLy9cbi8vICB2YXIgaW1wb3J0RGF0YUFycmF5ID0gW107XG4vLyAgdmFyIGxpc3RFbmQgPSBKU09OLnN0cmluZ2lmeShcImxpc3Q6IFtcIisgY29udGFjdExpc3REYXRhLmxpc3ROdW0gKyBcIl0sY29sdW1uX25hbWVzOltcXFwiRU1BSUxcXFwiLFxcXCJGSVJTVCBOQU1FXFxcIiwgXFxcIkxBU1QgTkFNRVxcXCIsIFxcXCJDSVRZXFxcIixcXFwiQ09NUEFOWSBOQU1FXFxcIl1cIik7XG4vL1xuLy8gIC8vcHVzaCB0aGUgaW5jbHVkZWQvY2hlY2tlZCBpbmZvIHRvIHRoZSBlbWFpbCBsaXN0XG4vLyAgJHNjb3BlLmNvbnRhY3RDaGVja2VkID0gZnVuY3Rpb24gKGlkKSB7XG4vLyAgICAgICRzY29wZS5jaGVja2VkLnB1c2goW2lkXSk7XG4vLyAgfTtcbi8vXG4vL1xuLy8gIC8vUG9zdCBEYXRhIHRvIENvbnN0YW50IENvbnRhY3Rcbi8vICAkc2NvcGUuc2VuZFBvc3QgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgdmFyIGRhdGEgPSAkLnBhcmFtKHtcbi8vICAgICAgICAgIGpzb246IEpTT04uc3RyaW5naWZ5KHtcbi8vICAgICAgICAgICAgICBcImltcG9ydERhdGFcIjogaW1wb3J0RGF0YUFycmF5ICsgXCIsIFwiICsgbGlzdEVuZFxuLy8gICAgICAgICAgfSlcbi8vICAgICAgfSk7XG4vL1xuLy9cbi8vICAgICAgdmFyIGNvbmZpZyA9IHtcbi8vICAgICAgICAgIGhlYWRlcnM6IHtcbi8vICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgZWY1ZDVkZjItYTgwOC00YzcwLWE1ZDktZWI3MTE2M2NiZWI5J1xuLy8gICAgICAgICAgfVxuLy8gICAgICB9O1xuLy9cbi8vICAgICAgJGh0dHAucG9zdCgnaHR0cHM6Ly9hcGkuY29uc3RhbnRjb250YWN0LmNvbS92Mi9hY3Rpdml0aWVzL2FkZGNvbnRhY3RzP2FwaV9rZXk9dTh3NTl6dHhlMzI5NGFkY3pmdm43azllJywgZGF0YSwgY29uZmlnKS5cbi8vICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4vLyAgICAgICAgICAgICAgcmVzLmlkID0gY29udGFjdExpc3REYXRhLmxpc3ROdW07XG4vLyAgICAgICAgICB9KS5cbi8vICAgICAgICAgIGVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuLy8gICAgICAgICAgICAgIC8vIGxvZyBlcnJvclxuLy8gICAgICAgICAgfSk7XG4vL1xuLy8gfTtcbi8vfV0pO1xuXG5cblxuIiwiYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSkiLCJhcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuXG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKSIsIi8vZWRpdCBjb3Jwb3JhdGlvbiBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRDb3JwQ3RybCcsIFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywgJ1Jlc3VsdFNlcnZpY2UnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UsICRodHRwKSB7XG4gICAgLy9zZW5kcyB0aGUgY29tcGFuaWVzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAgICAgJHNjb3BlLmNvbXBhbmllcyA9IFJlc3VsdFNlcnZpY2UuY29tcGFuaWVzO1xuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcblxuLy9USElOSyBUSElTIENBTiBCRSBERUxFVEVEXG4gICAvL3Njb3BlLm9wZW5Db3JwID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgIC8vXG4gICAvLyAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgLy8gICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAvLyAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGNvcnAuaHRtbCcsXG4gICAvLyAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgLy8gICAgICAgc2l6ZTogc2l6ZSxcbiAgIC8vICAgICAgIHJlc29sdmU6IHtcbiAgIC8vICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgLy8gICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLml0ZW1zO1xuICAgLy8gICAgICAgICAgIH1cbiAgIC8vICAgICAgIH1cbiAgIC8vICAgfSk7XG5cbiAgICAkc2NvcGUub3BlbkNvcnAgPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NvcnAgY2FsbCcsIGlkKTtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9jb3Jwb3JhdGlvbicsXG4gICAgICAgICAgICBwYXJhbXM6e2lkOmlkfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0Y29ycC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICB9O1xuXG5cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdjcmVhdGVMaXN0U2VhcmNoJyxbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIENvbnRhY3RMaXN0RGF0YVNlcnZpY2Upe1xuICAgICRyb290U2NvcGUuYWRkID0gZmFsc2U7XG4gICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaExpc3RCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICAgQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmxpc3RGb3JtLmRhdGEpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUubGlzdEZvcm09e307XG4gICAgfTtcbn1dKTsiLCJhcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhbGxDb21wYW5pZXMgPSBbXTtcbiAgICB2YXIgYWxsS2lkcyA9IFtdO1xuICAgIHZhciBhbGxBZHVsdHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbiAocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgVVJMOiAnLi4vY3JlYXRlTWFpbExpc3QnLFxuICAgICAgICAgICAgcGFyYW1zOiB7c2VhcmNoOiBwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsQWR1bHRzLnNwbGljZSgwLCBhbGxBZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFsbEFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsQWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxDb21wYW5pZXMuc3BsaWNlKDAsIGFsbENvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgICAgICBhbGxDb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbEtpZHMuc3BsaWNlKDAsIGFsbEtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbEtpZHNcbiAgICB9O1xuXG4gICAgdmFyIGRhdGFBcGkgPSB7XG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGFsbEtpZHM6IGFsbEtpZHMsXG4gICAgICAgIGFsbEFkdWx0czogYWxsQWR1bHRzLFxuICAgICAgICBhbGxDb21wYW5pZXM6IGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICByZXR1cm4gZGF0YUFwaTtcblxufV0pO1xuIiwiLy9lZGl0IGZhbWlseSBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRGYW1pbHlDdHJsJyxbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsJ1Jlc3VsdFNlcnZpY2UnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UsICRodHRwKSB7XG5cbiAgICAvL3NlbmRzIHRoZSBhZHVsdHMgYW5kIGtpZHMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICAgICAkc2NvcGUuYWR1bHRzID0gUmVzdWx0U2VydmljZS5hZHVsdHM7XG4gICAgICAgICRzY29wZS5raWRzID0gUmVzdWx0U2VydmljZS5raWRzO1xuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmYW1pbHkgY2FsbCcsaWQpO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHVybDogJy4uL2ZhbWlseScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOntpZDppZH1cbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogc2l6ZVxuXG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICAgICAgICAgIH07XG5cblxufV0pOyIsIi8vY29udHJvbGxlcnMgZm9yIGxvZ2luXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL3NlYXJjaFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XSk7XG4iLCJcbi8vVGhpcyBzaG91bGQgZ2V0IHRoZSBzZWFyY2ggaXRlbVxuYXBwLmNvbnRyb2xsZXIoJ3NlYXJjaEZ1bmN0aW9uJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnUmVzdWx0U2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCBSZXN1bHRTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcblxuICAgICRzY29wZS5zZWFyY2hCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICBSZXN1bHRTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUuZm9ybUlucHV0LmRhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgaW5wdXQgdGV4dCcsICRzY29wZS5mb3JtSW5wdXQpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuICAgIH07XG5cbn1dKTtcbiIsIi8vVGhpcyBzZXJ2aWNlIHNob3VsZCBwYXNzIGRhdGEgYmV0d2VlbiBjb250cm9sbGVyc1xuYXBwLmZhY3RvcnkoJ1Jlc3VsdFNlcnZpY2UnLCBbJyRodHRwJyxmdW5jdGlvbigkaHR0cCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIGFkdWx0cyA9IFtdO1xuICAgIHZhciBjb21wYW5pZXMgPSBbXTtcbiAgICB2YXIga2lkcyA9IFtdO1xuXG4gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uKHBhc3NlZERhdGEpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9zZWFyY2gnLFxuICAgICAgICAgICAgcGFyYW1zOntzZWFyY2g6cGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQxID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGNvbXBhbmllcy5zcGxpY2UoMCxjb21wYW5pZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY29tcGFueScpXG4gICAgICAgICAgICAgICAgY29tcGFuaWVzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIGdldEVsZW1lbnQxKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudDEnLGNvbXBhbmllcyk7XG4gICAgICAgIHJldHVybiBjb21wYW5pZXNcbiAgICB9O1xuXG4gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBhZHVsdHMuc3BsaWNlKDAsYWR1bHRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2FkdWx0JylcbiAgICAgICAgICAgICAgICAgICAgYWR1bHRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MihhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGluIGdldEVsZW1lbnQyJywgYWR1bHRzKTtcbiAgICAgICAgcmV0dXJuIGFkdWx0c1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBraWRzLnNwbGljZSgwLGtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuICAgICAgICAgICAgICAgICAgICBraWRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnRzMycsIGtpZHMpO1xuICAgICAgICByZXR1cm4ga2lkc1xuICAgIH07XG5cbiAgICAvL3B1YmxpY1xuICAgIHZhciBwdWJsaWNBcGkgPSB7XG4gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGwsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGNvbXBhbmllczogY29tcGFuaWVzLFxuICAgICAgICBhZHVsdHM6IGFkdWx0cyxcbiAgICAgICAga2lkczoga2lkc1xuICAgIH07XG4gICAgcmV0dXJuIHB1YmxpY0FwaTtcbn1dKTsiLCIvLyBQbGVhc2Ugbm90ZSB0aGF0ICRtb2RhbEluc3RhbmNlIHJlcHJlc2VudHMgYSBtb2RhbCB3aW5kb3cgKGluc3RhbmNlKSBkZXBlbmRlbmN5LlxuLy8gSXQgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSAkdWliTW9kYWwgc2VydmljZSB1c2VkIGFib3ZlLlxuXG4vL25lZWRlZCBmb3IgbW9kYWw/PyBwcmV0dHkgc3VyZVxuYXBwLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJyxbJyRzY29wZScsJyRtb2RhbEluc3RhbmNlJywgZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UpIHtcblxuICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJHNjb3BlLnNlbGVjdGVkLml0ZW0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICB9O1xufV0pOyIsImFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsJyRzY29wZScsJyRyb290U2NvcGUnLCckbG9jYXRpb24nLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2hvbWUnKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgIH1cbn1dKTtcbiIsIi8vIEFqYXggZm9yIGNyZWF0aW5nIHRoZSBjb250YWN0IGxpc3QgaW4gY29uc3RhbnQgY29udGFjdFxuYXBwLmNvbnRyb2xsZXIoJ25ld0NvbnRhY3RMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0bmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLmNyZWF0ZUxpc3QgID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZSBsaXN0OiBcIiArIHNjb3BlLmxpc3RuYW1lLmlucHV0KTtcbiAgICAgICAgLy9wYXNzZXMgbGlzdCBuYW1lIHNlcnZpY2VcbiAgICAgICAgY29udGFjdExpc3REYXRhLnBvc3RMaXN0KHNjb3BlLmxpc3RuYW1lLmlucHV0KTtcblxuICAgICAgICAkc2NvcGUubGlzdG5hbWU9e307XG4gICAgfTtcbn1dKTtcblxuXG4iLCIvL3NlcnZpY2UgZm9yIGFqYXggY2FsbHMgdG8gY29uc3RhbnQgY29udGFjdFxuXG5hcHAuc2VydmljZSgnY29udGFjdExpc3REYXRhJywgWydjb250YWN0TGlzdERhdGFTZXJ2aWNlJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGFTZXJ2aWNlLCAkc2NvcGUsICRodHRwKSB7XG5cbiAgICB2YXIgbmV3Q29udGFjdExpc3QgPSBbXTtcbiAgICB2YXIgbGlzdE51bSA9IFwiMTQ5OTUyMzYxMFwiO1xuXG5cbiAgICAkc2NvcGUucG9zdExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9uZXdDb250YWN0TGlzdCcpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBsaXN0TnVtID0gZGF0YS5pZFxuXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhvcHRpb25zKVxuICAgIH07XG5cblxuICAgIHZhciBpbXBvcnREYXRhQXJyYXkgPVtcbiAgICAgICAge1xuICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgIFwidXNlcjFAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiBcIkpvaG5cIixcbiAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6IFwiU21pdGhcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBYXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwiYW55dG93blwiXG4gICAgICAgICAgICB9XVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBcImVtYWlsX2FkZHJlc3Nlc1wiOiBbXG4gICAgICAgICAgICAgICAgXCJ1c2VyMkBleGFtcGxlLmNvbVwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6IFwiSmFuZVwiLFxuICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogXCJTbWl0aHlcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBZXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwic29tZXRvd25cIlxuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIF07XG5cbiAgICAvL3ZhciBjb250YWN0TGlzdE9iamVjdCA9KHtcbiAgICAvLyAgICBcIkltcG9ydCBEYXRhXCIgOiBpbXBvcnREYXRhQXJyYXksXG4gICAgLy8gICAgXCJsaXN0XCI6IFtsaXN0TnVtXSxcbiAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOltcIkVNQUlMXCIsXCJGSVJTVCBOQU1FXCIsIFwiTEFTVCBOQU1FXCIsIFwiQ0lUWVwiLFwiQ09NUEFOWSBOQU1FXCJdfSk7XG5cblxuICAgICRzY29wZS5wb3BMaXN0ID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIGdldENoZWNrZWQoKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3BvcHVsYXRlQ29udGFjdExpc3QuanMnLCBpbXBvcnREYXRhQXJyYXksbGlzdE51bSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpO1xuXG4gICAgfTtcbiAgICAvL2dldCBhbGwgdGhlIGNoZWNrZWQgZWxlbWVudHMgYW5kIHN0dWZmIHRoZW0gaW4gYW4gYXJyYXlcbiAgICBmdW5jdGlvbiBnZXRDaGVja2VkKCl7XG4gICAgICAgICQoXCI6Y2hlY2tlZC50eXBlLWVsZW1lbnRcIikuZWFjaChcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChpZCA9IGNyZWF0ZUxpc3RTZXJ2aWNlLnJlc3VsdHMuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhY3RPYmplY3QgPVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5lbWFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6ICQodGhpcykuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6ICQodGhpcykubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21wYW55X25hbWVcIjogJCh0aGlzKS5jb21wYW55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkcmVzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICQodGhpcykuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpbXBvcnREYXRhQXJyYXkucHVzaChjb250YWN0T2JqZWN0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9O1xuXG5cbiAgICByZXR1cm4ge1xuICAgICAgICBuZXdDb250YWN0TGlzdDogbmV3Q29udGFjdExpc3QsXG4gICAgICAgIGxpc3ROdW06IGxpc3ROdW1cbiAgICB9O1xufV0pOyIsImFwcC5jb250cm9sbGVyKCdwb3BMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0bmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLnBvcHVsYXRlTGlzdCAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlIGxpc3Q6IFwiICsgc2NvcGUubGlzdG5hbWUuaW5wdXQpO1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgIGNvbnRhY3RMaXN0RGF0YS5wb3BMaXN0KCk7XG4gICAgICAgIC8vdmFyIGxpc3RFbmQgPSB7XG4gICAgICAgIC8vICAgIFwibGlzdHNcIjogW2xpc3ROdW1dLFxuICAgICAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOiBbXG4gICAgICAgIC8vICAgIFwiRU1BSUxcIixcbiAgICAgICAgLy8gICAgXCJGSVJTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiTEFTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiQ0lUWVwiLFxuICAgICAgICAvLyAgICBcIkNPTVBBTlkgTkFNRVwiXG4gICAgICAgIC8vXX1cblxuXG4gICAgICAgICRzY29wZS5saXN0bmFtZT17fTtcbiAgICB9O1xufV0pO1xuXG4iLCJcbi8vcmVnaXN0ZXIgY29udHJvbGxlclxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXJDdHJsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZygncmVnaXN0ZXJDb250cm9sbGVyIHN1Ym1pdDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9yZWdpc3RlcicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iLCJhcHAuY29udHJvbGxlcigncmVzZXRDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VkaXQgcGFzc3dvcmQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wdXQoJy9hZG1pbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
