function formatDates(t){return{full:moment(t).format(fullDate),pretty:moment(t).format(prettyDate)}}var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]),prettyDate="MM/DD/YYgYY",fullDate="MM/DD/YYYY h:mm:ss a";app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html",controller:"editFamilyCtrl"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],a=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(a))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,a,o){t.companies=a.companies,t.animationsEnabled=!0,t.open=function(a,i){return console.log("corp call",i),o({method:"GET",url:"../corporation",params:{id:i}}).then(function(o){t.company=o.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:a,scope:t,resolve:{items:function(){return t.company}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$http","ContactListDataService",function(t,e,n){t.corp={},t.fam={},t.zipCk={},t.ageCk={},t.age={},t.zip={},t.searchListBtn=function(){console.log("this is the radios",t.corp,t.fam,t.zip,t.age,t.zipCk,t.ageCk),console.log(t.zip.data);var e=n.makeDataCall(t.zip.data);e.then(function(e){t.emailList=e.data}),t.corp={},t.fam={},t.zipCk={},t.ageCk={},t.age={},t.zip={}}}]),app.factory("ContactListDataService",["$http",function(t){return{makeDataCall:function(e){return t({method:"GET",url:"../createMailList",params:{search:e}})}}}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,a,o){t.adults=a.adults,t.kids=a.kids,t.family={adultOne:{},adultTwo:{},emergency:{},children:[],donations:[]},t.newChild={},t.newDonation={},t.animationsEnabled=!0,t.open=function(a,i){return console.log("family call",i),o({method:"GET",url:"../family",params:{id:i}}).then(function(o){t.family=o.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:a,scope:t,resolve:{items:function(){return t.family}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled},t.save=function(){console.log("Save submitted",t.family),t.family.id?(console.log("insert family",t.family),o({method:"PUT",url:"/family",data:{family:t.family}}).then(function(e){console.log("Put family, got id ",e.data),t.family.id=e.data.id,t.family.adultOne=e.data.adultOne?e.data.adultOne:{},t.family.adultTwo=e.data.adultTwo?e.data.adultTwo:{},t.family.emergency=e.data.emergency?e.data.emergency:{},t.family.children.length&&(t.family.children=[]),t.family.children=e.data.children?e.data.children:[],t.family.donations.length&&(t.family.donations=[]),t.family.donations=e.data.donations?e.data.donations:[]})):o({method:"POST",url:"/family",data:{family:t.family}}).then(function(e){console.log("Posted family, got id ",e.data),t.family.id=e.data.id,t.family.adultOne=e.data.adultOne?e.data.adultOne:{},t.family.adultTwo=e.data.adultTwo?e.data.adultTwo:{},t.family.emergency=e.data.emergency?e.data.emergency:{},t.family.children.length&&(t.family.children=[]),t.family.children=e.data.children?e.data.children:[],t.family.donations.length&&(t.family.donations=[]),t.family.donations=e.data.donations?e.data.donations:[]})},t.addChild=function(){console.log("child added",t.newChild,t.family.children),t.editingChild?(t.family.children[t.editingChild]=t.newChild,t.editingChild=!1):t.family.children.push(t.newChild),t.newChild={}},t.editChild=function(e){t.editingChild=e,t.newChild=t.family.children[e]},t.removeChild=function(e){console.log("in remove child index",e," edit ",t.editingChild),t.family.children.splice(e,1),e==t.editingChild?(console.log("edit match"),t.clearChild()):console.log("no edit match")},t.clearChild=function(){console.log("in clear child"),t.newChild={firstName:"",lastName:"",birthdate:"",school:"",notes:""},t.editingChild=!1},t.addDonation=function(){t.family.donations.push(t.newDonation),t.newDonation={}}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,a,o){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),o.user=n.getUser(),a.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],a=[],o=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,l(e),r(e),s(e)})},l=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"company"==t.type&&a.push(t)})};return e(t),console.log("this is getElement1",a),a},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},r=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&o.push(t)})};return e(t),console.log("this is getElements3",o),o},c={getKids:r,getAdults:s,getCompanies:l,makeDataCall:i,results:e,companies:a,adults:n,kids:o};return c}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,a){n.user=t.getUser(),n.user&&n.user.username&&a.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),a.path("/")}}]),app.controller("newContactListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.createList=function(){console.log("create list: "+e.listName.input),t.postList(e.listName.input),e.listName={}}}]),app.service("newContactListData",["ContactListDataService","$http",function(t,e){var n="1499523610";this.postList=function(){e.post("/newContactList").then(function(t){console.log(t),n=t.id},function(t){console.log(t)}),console.log(options)};var a=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];this.popList=function(){o(),e.post("/populateContactList.js",a,n).success(function(t,e,n,a){console.log(t)}),console.log(options)};var o=function(){$(":checked.type-element").each(function(){if(id==t.results.id){var e={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};a.push(e)}})}}]),app.controller("popListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.populateList=function(){console.log("create list: "+scope.listName.input),t.popList(),e.listName={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImZvcm1hdERhdGVzIiwiZGF0ZSIsImZ1bGwiLCJtb21lbnQiLCJmb3JtYXQiLCJmdWxsRGF0ZSIsInByZXR0eSIsInByZXR0eURhdGUiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImZhY3RvcnkiLCIkcSIsIiRsb2NhdGlvbiIsImF1dGhTZXJ2aWNlIiwicmVxdWVzdCIsImhlYWRlcnMiLCJpc0F1dGhlZCIsIkF1dGhvcml6YXRpb24iLCJnZXRUb2tlbiIsInJlc3BvbnNlIiwic3RhdHVzIiwicGF0aCIsInJlc3BvbnNlRXJyb3IiLCJjb25zb2xlIiwibG9nIiwicmVqZWN0Iiwic2VydmljZSIsIiR3aW5kb3ciLCJ0aGlzIiwicGFyc2VKd3QiLCJ0b2tlbiIsImJhc2U2NFVybCIsInNwbGl0IiwiYmFzZTY0IiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsImF0b2IiLCJzYXZlVG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJNYXRoIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImxvZ291dCIsImdldFVzZXIiLCIkc2NvcGUiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsIiRodHRwIiwiY29tcGFuaWVzIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJvcGVuIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsImNvbXBhbnkiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsImFuaW1hdGlvbiIsInNjb3BlIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwidG9nZ2xlQW5pbWF0aW9uIiwiQ29udGFjdExpc3REYXRhU2VydmljZSIsImNvcnAiLCJmYW0iLCJ6aXBDayIsImFnZUNrIiwiYWdlIiwiemlwIiwic2VhcmNoTGlzdEJ0biIsInByb21pc2UiLCJtYWtlRGF0YUNhbGwiLCJyZXN1bHRzIiwiZW1haWxMaXN0IiwicGFzc2VkRGF0YSIsInNlYXJjaCIsImFkdWx0cyIsImtpZHMiLCJmYW1pbHkiLCJhZHVsdE9uZSIsImFkdWx0VHdvIiwiZW1lcmdlbmN5IiwiY2hpbGRyZW4iLCJkb25hdGlvbnMiLCJuZXdDaGlsZCIsIm5ld0RvbmF0aW9uIiwic2F2ZSIsInJlcyIsImxlbmd0aCIsImFkZENoaWxkIiwiZWRpdGluZ0NoaWxkIiwicHVzaCIsImVkaXRDaGlsZCIsImluZGV4IiwicmVtb3ZlQ2hpbGQiLCJzcGxpY2UiLCJjbGVhckNoaWxkIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJiaXJ0aGRhdGUiLCJzY2hvb2wiLCJub3RlcyIsImFkZERvbmF0aW9uIiwiJHJvb3RTY29wZSIsInN1Ym1pdCIsInBvc3QiLCJmb3JtIiwidXNlciIsImZvcm1JbnB1dCIsInNlYXJjaEJ0biIsImdldENvbXBhbmllcyIsImdldEtpZHMiLCJnZXRBZHVsdHMiLCJhcnJheSIsImdldEVsZW1lbnQxIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0eXBlIiwiZ2V0RWxlbWVudDIiLCJnZXRFbGVtZW50MyIsInB1YmxpY0FwaSIsIiRtb2RhbEluc3RhbmNlIiwib2siLCJjbG9zZSIsIml0ZW0iLCJjYW5jZWwiLCJkaXNtaXNzIiwidXNlcm5hbWUiLCJuZXdDb250YWN0TGlzdERhdGEiLCJsaXN0TmFtZSIsImNyZWF0ZUxpc3QiLCJpbnB1dCIsInBvc3RMaXN0IiwibGlzdE51bSIsIm9wdGlvbnMiLCJpbXBvcnREYXRhQXJyYXkiLCJlbWFpbF9hZGRyZXNzZXMiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiY29tcGFueV9uYW1lIiwiYWRkcmVzc2VzIiwiY2l0eSIsInBvcExpc3QiLCJnZXRDaGVja2VkIiwic3VjY2VzcyIsIiQiLCJlYWNoIiwiY29udGFjdE9iamVjdCIsImVtYWlsIiwicG9wdWxhdGVMaXN0IiwicHV0Il0sIm1hcHBpbmdzIjoiQUFLQSxRQUFBQSxhQUFBQyxHQUNBLE9BQ0FDLEtBQUFDLE9BQUFGLEdBQUFHLE9BQUFDLFVBQ0FDLE9BQUFILE9BQUFGLEdBQUFHLE9BQUFHLGFBUkEsR0FBQUMsS0FBQUMsUUFBQUMsT0FBQSxPQUFBLFVBQUEsWUFBQSxpQkFFQUgsV0FBQSxjQUNBRixTQUFBLHNCQVNBRyxLQUFBRyxRQUFBLGlCQUNBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsS0FDQUMsWUFBQSxzQkFFQUQsS0FBQSxXQUNBQyxZQUFBLHdCQUVBRCxLQUFBLGFBQ0FDLFlBQUEseUJBRUFELEtBQUEsZ0JBQ0FDLFlBQUEsNkJBRUFELEtBQUEsY0FDQUMsWUFBQSx5QkFDQUMsV0FBQSxtQkFFQUYsS0FBQSxZQUNBQyxZQUFBLHlCQUVBRCxLQUFBLGdCQUNBQyxZQUFBLDZCQUVBRSxXQUNBQyxXQUFBLGVDdENBVCxJQUFBVSxRQUFBLG1CQUFBLEtBQUEsWUFBQSxjQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsT0FDQUMsUUFBQSxTQUFBWCxHQUtBLE1BSkFBLEdBQUFZLFFB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RUFBQW1FLE9BQUEsV0FDQTlGLFFBQUFDLElBQUEsZ0JBQ0FELFFBQUFDLElBQUEsNkJBQUEwQixFQUFBcUUsTUFDQWpFLEVBQUFnRSxLQUFBLFlBQUFwRSxFQUFBcUUsTUFDQXpELEtBQUEsU0FBQTNDLEdBQ0FJLFFBQUFDLElBQUFMLEdBQ0FQLEVBQUFTLEtBQUEsZ0JDVEFyQixJQUFBTyxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQTJDLEVBQUFJLEVBQUExQyxHQUNBc0MsRUFBQW1FLE9BQUEsV0FDQTlGLFFBQUFDLElBQUEsaUJBQUEwQixFQUFBcUUsTUFDQWpFLEVBQUE2RyxJQUFBLFNBQUFqSCxFQUFBcUUsTUFDQXpELEtBQUEsU0FBQTNDLEdBQ0FJLFFBQUFDLElBQUFMLEdBQ0FQLEVBQUFTLEtBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbGVvJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZScsICd1aS5ib290c3RyYXAnXSk7XG5cbnZhciBwcmV0dHlEYXRlID0gXCJNTS9ERC9ZWWdZWVwiO1xudmFyIGZ1bGxEYXRlID0gXCJNTS9ERC9ZWVlZIGg6bW06c3MgYVwiO1xuXG5mdW5jdGlvbiBmb3JtYXREYXRlcyAoZGF0ZSkge1xuXHRyZXR1cm4ge1xuXHRcdGZ1bGw6IG1vbWVudChkYXRlKS5mb3JtYXQoZnVsbERhdGUpLFxuXHRcdHByZXR0eTogbW9tZW50KGRhdGUpLmZvcm1hdChwcmV0dHlEYXRlKVxuXHR9O1xufVxuXG5hcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLFxuICAgIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLlxuICAgICAgICAgICAgd2hlbignLycsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9sb2dpbi5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvc2VhcmNoJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9zZWFyY2guaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL3JlZ2lzdGVyJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9jb250YWN0TGlzdCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvY29udGFjdExpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGZhbWlseScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvYWRkZmFtaWx5Lmh0bWwnLFxuXHRcdFx0XHRjb250cm9sbGVyOiAnZWRpdEZhbWlseUN0cmwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9hZGRjb3JwJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRjb3JwLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9jb250YWN0bGlzdCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvY29udGFjdGxpc3QuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgb3RoZXJ3aXNlKHtcbiAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnL3NlYXJjaCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG5cblxuIiwiYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSkiLCJhcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuXG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTsiLCIvL2VkaXQgY29ycG9yYXRpb24gbW9kYWwgdGVtcGxhdGVcbmFwcC5jb250cm9sbGVyKCdlZGl0Q29ycEN0cmwnLCBbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsICdSZXN1bHRTZXJ2aWNlJywgJyRodHRwJywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkbG9nLCBSZXN1bHRTZXJ2aWNlLCAkaHR0cCkge1xuICAgIC8vc2VuZHMgdGhlIGNvbXBhbmllcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgICAgICRzY29wZS5jb21wYW5pZXMgPSBSZXN1bHRTZXJ2aWNlLmNvbXBhbmllcztcblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG5cbiAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uIChzaXplLCBpZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnY29ycCBjYWxsJywgaWQpO1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL2NvcnBvcmF0aW9uJyxcbiAgICAgICAgICAgIHBhcmFtczp7aWQ6aWR9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFueSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGNvcnAuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5jb21wYW55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUudG9nZ2xlQW5pbWF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgIH07XG5cblxufV0pO1xuIiwiLy9hcHAuY29udHJvbGxlcignY3JlYXRlTGlzdFNlYXJjaCcsWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBDb250YWN0TGlzdERhdGFTZXJ2aWNlKXtcbi8vICAgICRyb290U2NvcGUuYWRkID0gZmFsc2U7XG4vLyAgICAkc2NvcGUubGlzdEZvcm09e307XG4vLyAgICAkc2NvcGUuc2VhcmNoTGlzdEJ0biA9IGZ1bmN0aW9uICgpIHtcbi8vXHRcdC8vY29uc29sZS5sb2coXCJsaXN0IHR5cGVcIiwgJHNjb3BlLmxpc3RUeXBlKTtcbi8vXHRcdHZhciAkdHlwZSA9ICQoJyNsaXN0VHlwZSA6Y2hlY2tlZCcpO1xuLy9cdFx0Ly8gY2hlY2sgaWYgaXQncyBhZ2Ugb3IgemlwLCByZXF1aXJpbmcgYWRkaXRpb25hbCBpbnB1dFxuLy9cdFx0aWYoJHR5cGUuaGFzQ2xhc3MoJ2pzLWV4dHJhJykpIHtcbi8vXHRcdFx0Y29uc29sZS5sb2coXCJuZWVkcyBleHRyYSBpbmZvXCIpO1xuLy9cdFx0XHR2YXIgdmFsdWUgPSAkdHlwZS5uZXh0KCkubmV4dCgpLnZhbCgpO1xuLy9cdFx0fVxuLy9cdFx0dmFyIGlkID0gJHR5cGUuYXR0cignaWQnKTtcbi8vXHRcdC8vdmFyICR0eXBlcyA9ICQoJyNsaXN0VHlwZScpO1xuLy9cdFx0Ly9pZigkdHlwZXMuZmluZCgnaW5wdXQ6Y2hlY2tlZCcpLmhhc0NsYXNzKCdqcy1leHRyYScpKSB7XG4vL1x0XHQvL1x0dmFyIHZhbHVlID0gJHR5cGVzLmZpbmQoJ2lucHV0OmNoZWNrZWQnKS5oYXNDbGFzcygnanMtZXh0cmEnKS5zaWJsaW5ncygnLmpzLXZhbHVlJykudmFsKCk7XG4vL1x0XHQvL31cbi8vXHRcdC8vdmFyIHR5cGUgPSAkdHlwZXMuZmluZCgnaW5wdXQ6Y2hlY2tlZCcpLmhhc0NsYXNzKCdqcy1leHRyYScpLmF0dHIoJ2lkJyk7XG4vL1x0XHRjb25zb2xlLmxvZyhcInR5cGUgXCIsIGlkLCBcIiB2YWx1ZSBcIiwgdmFsdWUpO1xuLy9cdFx0Ly9jb25zb2xlLmxvZyhcInZhbHVlXCIsIHZhbHVlKTtcbi8vICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4vLyAgICAgICAgLy9Db250YWN0TGlzdERhdGFTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUubGlzdEZvcm0uZGF0YSk7XG4vLyAgICAgICAgLy9lbXB0eSB0aGUgc2VhcmNoIGJveFxuLy8gICAgICAgICRzY29wZS5saXN0Rm9ybT17fTtcbi8vICAgIH07XG4vL31dKTtcbmFwcC5jb250cm9sbGVyKCdjcmVhdGVMaXN0U2VhcmNoJyxbJyRzY29wZScsJyRodHRwJywgJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBDb250YWN0TGlzdERhdGFTZXJ2aWNlKSB7XG5cdCRzY29wZS5jb3JwID17fTtcblx0JHNjb3BlLmZhbSA9e307XG5cdCRzY29wZS56aXBDayA9e307XG5cdCRzY29wZS5hZ2VDayA9e307XG5cdCRzY29wZS5hZ2UgPXt9O1xuXHQkc2NvcGUuemlwPXt9O1xuXG5cdCRzY29wZS5zZWFyY2hMaXN0QnRuID0gZnVuY3Rpb24gKCkge1xuXHRcdC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2Vcblx0XHRjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgcmFkaW9zJyAsICRzY29wZS5jb3JwLCRzY29wZS5mYW0sJHNjb3BlLnppcCwkc2NvcGUuYWdlLCAkc2NvcGUuemlwQ2ssICRzY29wZS5hZ2VDayk7XG5cdFx0Y29uc29sZS5sb2coJHNjb3BlLnppcC5kYXRhKTtcblxuXG5cblx0XHQvL3NlYXJjaCBieSB6aXAgaWYgemlwQ0sgaXMgdHJ1ZVxuXG5cdFx0dmFyIHByb21pc2UgPSBDb250YWN0TGlzdERhdGFTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUuemlwLmRhdGEpO1xuXG5cdFx0cHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cdFx0XHQkc2NvcGUuZW1haWxMaXN0ID0gcmVzdWx0cy5kYXRhO1xuXHRcdH0pO1xuXG5cdFx0Ly8vL3NlYXJjaCBieSBhZ2UgaWYgYWdlQ2sgaXMgdHJ1ZVxuXHRcdC8vdmFyIHByb21pc2UgPSBDb250YWN0TGlzdERhdGFTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUuYWdlLmRhdGEpO1xuXHRcdC8vcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cdFx0Ly9cdCRzY29wZS5lbWFpbExpc3QgPSByZXN1bHRzLmRhdGE7XG5cdFx0Ly99KTtcblxuXHRcdC8vLy9nZXQgYWxsIGZhbWlsaWVzIGlmIGZhbSBpcyB0cnVlXG5cdFx0Ly92YXIgcHJvbWlzZSA9IENvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCk7XG5cdFx0Ly9wcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcblx0XHQvL1x0JHNjb3BlLmVtYWlsTGlzdCA9IHJlc3VsdHMuZGF0YTtcblx0XHQvL1x0Y29uc29sZS5sb2cocmVzdWx0cy5kYXRhKTtcblx0XHQvL30pO1xuXHRcdC8vXG5cdFx0Ly8vL2dldCBhbGwgY29ycCBpZiBjb3JwIGlzIHRydWVcblx0XHQvL0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCk7XG5cdFx0Ly9cblxuXHRcdC8vZW1wdHkgdGhlIHNlYXJjaCBib3hcblx0XHQkc2NvcGUuY29ycCA9e307XG5cdFx0JHNjb3BlLmZhbSA9e307XG5cdFx0JHNjb3BlLnppcENrID17fTtcblx0XHQkc2NvcGUuYWdlQ2sgPXt9O1xuXHRcdCRzY29wZS5hZ2UgPXt9O1xuXHRcdCRzY29wZS56aXA9e307XG5cdH07XG5cbn1dKTsiLCIvL2FwcC5mYWN0b3J5KCdDb250YWN0TGlzdERhdGFTZXJ2aWNlJyxbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcbi8vXG4vLyAgICB2YXIgcmVzdWx0cyA9IFtdO1xuLy8gICAgdmFyIGFsbENvbXBhbmllcyA9IFtdO1xuLy8gICAgdmFyIGFsbEtpZHMgPSBbXTtcbi8vICAgIHZhciBhbGxBZHVsdHMgPSBbXTtcbi8vXG4vLyAgICB2YXIgbWFrZURhdGFDYWxsID0gZnVuY3Rpb24gKHBhc3NlZERhdGEpIHtcbi8vICAgICAgICByZXR1cm4gJGh0dHAoe1xuLy8gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuLy8gICAgICAgICAgICBVUkw6ICcvY3JlYXRlTWFpbExpc3QnLFxuLy8gICAgICAgICAgICBwYXJhbXM6IHtzZWFyY2g6IHBhc3NlZERhdGF9XG4vLyAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbi8vICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4vLyAgICAgICAgICAgIGdldENvbXBhbmllcyhyZXN1bHRzKTtcbi8vICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuLy8gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuLy8gICAgICAgIH0pO1xuLy8gICAgfTtcbi8vXG4vL1xuLy8gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uIChhcnJheSkge1xuLy8gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuLy8gICAgICAgICAgICBhbGxBZHVsdHMuc3BsaWNlKDAsIGFsbEFkdWx0cy5sZW5ndGgpO1xuLy8gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4vLyAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4vLyAgICAgICAgICAgICAgICAgICAgYWxsQWR1bHRzLnB1c2goZWxlbWVudCk7XG4vLyAgICAgICAgICAgIH0pXG4vLyAgICAgICAgfTtcbi8vICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4vLyAgICAgICAgcmV0dXJuIGFsbEFkdWx0c1xuLy8gICAgfTtcbi8vXG4vLyAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4vLyAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4vLyAgICAgICAgICAgIGFsbENvbXBhbmllcy5zcGxpY2UoMCwgYWxsQ29tcGFuaWVzLmxlbmd0aCk7XG4vLyAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbi8vICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuLy8gICAgICAgICAgICAgICAgICAgIGFsbENvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuLy8gICAgICAgICAgICB9KVxuLy8gICAgICAgIH07XG4vLyAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuLy8gICAgICAgIHJldHVybiBhbGxDb21wYW5pZXNcbi8vICAgIH07XG4vL1xuLy8gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbi8vICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbi8vICAgICAgICAgICAgYWxsS2lkcy5zcGxpY2UoMCwgYWxsS2lkcy5sZW5ndGgpO1xuLy8gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4vLyAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4vLyAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuLy8gICAgICAgICAgICB9KVxuLy8gICAgICAgIH07XG4vLyAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuLy8gICAgICAgIHJldHVybiBhbGxLaWRzXG4vLyAgICB9O1xuLy9cbi8vICAgIHZhciBkYXRhQXBpID0ge1xuLy8gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuLy8gICAgICAgIGdldENvbXBhbmllczogZ2V0Q29tcGFuaWVzLFxuLy8gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4vLyAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4vLyAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbi8vICAgICAgICBhbGxLaWRzOiBhbGxLaWRzLFxuLy8gICAgICAgIGFsbEFkdWx0czogYWxsQWR1bHRzLFxuLy8gICAgICAgIGFsbENvbXBhbmllczogYWxsQ29tcGFuaWVzXG4vLyAgICB9O1xuLy9cbi8vICAgIHJldHVybiBkYXRhQXBpO1xuLy9cbi8vfV0pO1xuXG5hcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsIFsnJGh0dHAnLCBmdW5jdGlvbiAoJGh0dHApIHtcblxuXHRyZXR1cm4ge1xuXHRcdG1ha2VEYXRhQ2FsbDogZnVuY3Rpb24gKHBhc3NlZERhdGEpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHRcdHVybDogJy4uL2NyZWF0ZU1haWxMaXN0Jyxcblx0XHRcdFx0cGFyYW1zOiB7c2VhcmNoOiBwYXNzZWREYXRhfVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cbn1dKTsiLCIvL2VkaXQgZmFtaWx5IG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdEZhbWlseUN0cmwnLCBbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsICdSZXN1bHRTZXJ2aWNlJywgJyRodHRwJywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkbG9nLCBSZXN1bHRTZXJ2aWNlLCAkaHR0cCkge1xuXHQvL3NlbmRzIHRoZSBhZHVsdHMgYW5kIGtpZHMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuXHQkc2NvcGUuYWR1bHRzID0gUmVzdWx0U2VydmljZS5hZHVsdHM7XG5cdCRzY29wZS5raWRzID0gUmVzdWx0U2VydmljZS5raWRzO1xuXHQkc2NvcGUuZmFtaWx5ID0ge1xuXHRcdGFkdWx0T25lOiB7fSxcblx0XHRhZHVsdFR3bzoge30sXG5cdFx0ZW1lcmdlbmN5OiB7fSxcblx0XHRjaGlsZHJlbjogW10sXG5cdFx0ZG9uYXRpb25zOiBbXVxuXHR9O1xuXHQkc2NvcGUubmV3Q2hpbGQgPSB7fTtcblx0JHNjb3BlLm5ld0RvbmF0aW9uID0ge307XG5cblx0JHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcblx0JHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcblx0XHRjb25zb2xlLmxvZygnZmFtaWx5IGNhbGwnLCBpZCk7XG5cdFx0cmV0dXJuICRodHRwKHtcblx0XHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0XHR1cmw6ICcuLi9mYW1pbHknLFxuXHRcdFx0cGFyYW1zOiB7aWQ6IGlkfVxuXHRcdH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cblx0XHRcdCRzY29wZS5mYW1pbHkgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0dmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG5cdFx0XHRcdGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuXHRcdFx0XHR0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGZhbWlseS5odG1sJyxcblx0XHRcdFx0Y29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcblx0XHRcdFx0c2l6ZTogc2l6ZSxcblx0XHRcdFx0c2NvcGU6ICRzY29wZSxcblx0XHRcdFx0cmVzb2x2ZToge1xuXHRcdFx0XHRcdGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gJHNjb3BlLmZhbWlseTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0bW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG5cdFx0XHRcdCRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcblx0XHRcdH0sIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0JGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9O1xuXG5cdCRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdFx0JHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcblx0fTtcblxuXHQvLyBzYXZlIGZhbWlseVxuXHQkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRjb25zb2xlLmxvZyhcIlNhdmUgc3VibWl0dGVkXCIsICRzY29wZS5mYW1pbHkpO1xuXHRcdC8vYWxlcnQoXCJTdWJtaXR0ZWRcIik7XG5cdFx0Ly8gaWYgaGFzIGlkLCB0aGVuIHB1dFxuXHRcdGlmKCEkc2NvcGUuZmFtaWx5LmlkKSB7XG5cdFx0XHQkaHR0cCh7XG5cdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHR1cmw6ICcvZmFtaWx5Jyxcblx0XHRcdFx0ZGF0YToge2ZhbWlseTogJHNjb3BlLmZhbWlseX1cblx0XHRcdH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlBvc3RlZCBmYW1pbHksIGdvdCBpZCBcIiwgcmVzLmRhdGEpO1xuXHRcdFx0XHQkc2NvcGUuZmFtaWx5LmlkID0gcmVzLmRhdGEuaWQ7XG5cdFx0XHRcdCRzY29wZS5mYW1pbHkuYWR1bHRPbmUgPSAocmVzLmRhdGEuYWR1bHRPbmUpID8gcmVzLmRhdGEuYWR1bHRPbmUgOiB7fTtcblx0XHRcdFx0JHNjb3BlLmZhbWlseS5hZHVsdFR3byA9IChyZXMuZGF0YS5hZHVsdFR3bykgPyByZXMuZGF0YS5hZHVsdFR3byA6IHt9O1xuXHRcdFx0XHQkc2NvcGUuZmFtaWx5LmVtZXJnZW5jeSA9IChyZXMuZGF0YS5lbWVyZ2VuY3kpID8gcmVzLmRhdGEuZW1lcmdlbmN5IDoge307XG5cdFx0XHRcdGlmKCRzY29wZS5mYW1pbHkuY2hpbGRyZW4ubGVuZ3RoKSB7XG5cdFx0XHRcdFx0JHNjb3BlLmZhbWlseS5jaGlsZHJlbiA9IFtdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCRzY29wZS5mYW1pbHkuY2hpbGRyZW4gPSAocmVzLmRhdGEuY2hpbGRyZW4pID8gcmVzLmRhdGEuY2hpbGRyZW4gOiBbXTtcblx0XHRcdFx0aWYoJHNjb3BlLmZhbWlseS5kb25hdGlvbnMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0JHNjb3BlLmZhbWlseS5kb25hdGlvbnMgPSBbXTtcblx0XHRcdFx0fVxuXHRcdFx0XHQkc2NvcGUuZmFtaWx5LmRvbmF0aW9ucyA9IChyZXMuZGF0YS5kb25hdGlvbnMpID8gcmVzLmRhdGEuZG9uYXRpb25zIDogW107XG5cdFx0XHR9KTtcblx0XHR9ZWxzZSB7XG5cdFx0Ly8gaW5zZXJ0IGZhbWlseSAtIGhhcyBubyBpZFxuXHRcdFx0Y29uc29sZS5sb2coXCJpbnNlcnQgZmFtaWx5XCIsICRzY29wZS5mYW1pbHkpO1xuXHRcdFx0JGh0dHAoe1xuXHRcdFx0XHRtZXRob2Q6ICdQVVQnLFxuXHRcdFx0XHR1cmw6ICcvZmFtaWx5Jyxcblx0XHRcdFx0ZGF0YToge2ZhbWlseTogJHNjb3BlLmZhbWlseX1cblx0XHRcdH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlB1dCBmYW1pbHksIGdvdCBpZCBcIiwgcmVzLmRhdGEpO1xuXHRcdFx0XHQkc2NvcGUuZmFtaWx5LmlkID0gcmVzLmRhdGEuaWQ7XG5cdFx0XHRcdCRzY29wZS5mYW1pbHkuYWR1bHRPbmUgPSAocmVzLmRhdGEuYWR1bHRPbmUpID8gcmVzLmRhdGEuYWR1bHRPbmUgOiB7fTtcblx0XHRcdFx0JHNjb3BlLmZhbWlseS5hZHVsdFR3byA9IChyZXMuZGF0YS5hZHVsdFR3bykgPyByZXMuZGF0YS5hZHVsdFR3byA6IHt9O1xuXHRcdFx0XHQkc2NvcGUuZmFtaWx5LmVtZXJnZW5jeSA9IChyZXMuZGF0YS5lbWVyZ2VuY3kpID8gcmVzLmRhdGEuZW1lcmdlbmN5IDoge307XG5cdFx0XHRcdGlmKCRzY29wZS5mYW1pbHkuY2hpbGRyZW4ubGVuZ3RoKSB7XG5cdFx0XHRcdFx0JHNjb3BlLmZhbWlseS5jaGlsZHJlbiA9IFtdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCRzY29wZS5mYW1pbHkuY2hpbGRyZW4gPSAocmVzLmRhdGEuY2hpbGRyZW4pID8gcmVzLmRhdGEuY2hpbGRyZW4gOiBbXTtcblx0XHRcdFx0aWYoJHNjb3BlLmZhbWlseS5kb25hdGlvbnMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0JHNjb3BlLmZhbWlseS5kb25hdGlvbnMgPSBbXTtcblx0XHRcdFx0fVxuXHRcdFx0XHQkc2NvcGUuZmFtaWx5LmRvbmF0aW9ucyA9IChyZXMuZGF0YS5kb25hdGlvbnMpID8gcmVzLmRhdGEuZG9uYXRpb25zIDogW107XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0Ly8gZm9yIGFwcGVuZGluZyBjaGlsZHJlbiB0byBtb2RlbCBiZWZvcmUgc2F2aW5nIG5ldyBmYW1pbHlcblx0JHNjb3BlLmFkZENoaWxkID0gZnVuY3Rpb24gKCkge1xuXHRcdGNvbnNvbGUubG9nKFwiY2hpbGQgYWRkZWRcIiwgJHNjb3BlLm5ld0NoaWxkLCAkc2NvcGUuZmFtaWx5LmNoaWxkcmVuKTtcblx0XHQvLyBpZiB0cnVlLCB0aGVuIHVwZGF0ZSB0aGF0IGluZGV4XG5cdFx0aWYoJHNjb3BlLmVkaXRpbmdDaGlsZCkge1xuXHRcdFx0JHNjb3BlLmZhbWlseS5jaGlsZHJlblskc2NvcGUuZWRpdGluZ0NoaWxkXSA9ICRzY29wZS5uZXdDaGlsZDtcblx0XHRcdCRzY29wZS5lZGl0aW5nQ2hpbGQgPSBmYWxzZTtcblx0XHR9ZWxzZSB7XG5cdFx0Ly8gZWxzZSBwdXNoIHRvIGFycmF5XG5cdFx0XHQkc2NvcGUuZmFtaWx5LmNoaWxkcmVuLnB1c2goJHNjb3BlLm5ld0NoaWxkKTtcblx0XHR9XG5cdFx0JHNjb3BlLm5ld0NoaWxkID0ge307XG5cdH07XG5cblx0Ly8gZWRpdCBjaGlsZCBvbiB0aGUgYWRkIGNoaWxkcmVuIHRhYiBvZiBhZGQgZmFtaWx5XG5cdCRzY29wZS5lZGl0Q2hpbGQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0XHQvLyBzYXZlIGluZGV4IG9mIGNoaWxkIGVkaXRpbmdcblx0XHQkc2NvcGUuZWRpdGluZ0NoaWxkID0gaW5kZXg7XG5cdFx0JHNjb3BlLm5ld0NoaWxkID0gJHNjb3BlLmZhbWlseS5jaGlsZHJlbltpbmRleF07XG5cdH07XG5cblx0JHNjb3BlLnJlbW92ZUNoaWxkID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdFx0Y29uc29sZS5sb2coXCJpbiByZW1vdmUgY2hpbGQgaW5kZXhcIiwgaW5kZXgsIFwiIGVkaXQgXCIsICRzY29wZS5lZGl0aW5nQ2hpbGQpO1xuXHRcdCRzY29wZS5mYW1pbHkuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcblx0XHRpZihpbmRleCA9PSAkc2NvcGUuZWRpdGluZ0NoaWxkKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcImVkaXQgbWF0Y2hcIik7XG5cdFx0XHQkc2NvcGUuY2xlYXJDaGlsZCgpO1xuXHRcdH1lbHNlIHtcblx0XHRcdGNvbnNvbGUubG9nKFwibm8gZWRpdCBtYXRjaFwiKTtcblx0XHR9XG5cdH07XG5cblx0Ly8gY2xlYXJzIHRleHQgYm94ZXMgaW4gYWRkIGZhbWlseS0+Y2hpbGRyZW4gdGFiXG5cdCRzY29wZS5jbGVhckNoaWxkID0gZnVuY3Rpb24gKCkge1xuXHRcdGNvbnNvbGUubG9nKFwiaW4gY2xlYXIgY2hpbGRcIik7XG5cdFx0JHNjb3BlLm5ld0NoaWxkID0ge1xuXHRcdFx0Zmlyc3ROYW1lOiAnJyxcblx0XHRcdGxhc3ROYW1lOiAnJyxcblx0XHRcdGJpcnRoZGF0ZTogJycsXG5cdFx0XHRzY2hvb2w6ICcnLFxuXHRcdFx0bm90ZXM6ICcnXG5cdFx0fTtcblx0XHQkc2NvcGUuZWRpdGluZ0NoaWxkID0gZmFsc2U7XG5cdH07XG5cblx0Ly8gYWRkcyBkb25hdGlvbiB0byBmYW1pbHkgb2JqZWN0XG5cdCRzY29wZS5hZGREb25hdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0XHQkc2NvcGUuZmFtaWx5LmRvbmF0aW9ucy5wdXNoKCRzY29wZS5uZXdEb25hdGlvbik7XG5cdFx0JHNjb3BlLm5ld0RvbmF0aW9uID0ge307XG5cdH07XG5cblx0Ly8vLyBwcmV2ZW50IGFjY2lkZW50YWwgYmFja3Ncblx0Ly8kc2NvcGUuJG9uKCckbG9jYXRpb25DaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24oIGV2ZW50LCBvbGRVcmwgKSB7XG5cdC8vXHRjb25zb2xlLmxvZyhcIm9sZCB1cmw6IFwiLCBvbGRVcmwpO1xuXHQvL1x0aWYoLyhhZGRmYW1pbHkpLy50ZXN0KG9sZFVybCkpIHtcblx0Ly9cdFx0dmFyIGFuc3dlciA9IGNvbmZpcm0oXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gbGVhdmUgdGhpcyBwYWdlP1wiKTtcblx0Ly9cdFx0aWYgKCFhbnN3ZXIpIHtcblx0Ly9cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHQvL1x0XHR9XG5cdC8vXHR9XG5cdC8vfSk7XG5cbn1dKTsiLCIvL2NvbnRyb2xsZXJzIGZvciBsb2dpblxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSl7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9zZWFyY2hcIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xufV0pO1xuIiwiXG4vL1RoaXMgc2hvdWxkIGdldCB0aGUgc2VhcmNoIGl0ZW1cbmFwcC5jb250cm9sbGVyKCdzZWFyY2hGdW5jdGlvbicsIFsnJHNjb3BlJywgJyRodHRwJywgJ1Jlc3VsdFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUmVzdWx0U2VydmljZSkge1xuICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG5cbiAgICAkc2NvcGUuc2VhcmNoQnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgUmVzdWx0U2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmZvcm1JbnB1dC5kYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgdGhlIGlucHV0IHRleHQnLCAkc2NvcGUuZm9ybUlucHV0KTtcbiAgICAgICAgLy9lbXB0eXMgdGhlIHNlYXJjaCBib3hcbiAgICAgICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcbiAgICB9O1xuXG59XSk7XG4iLCIvL1RoaXMgc2VydmljZSBzaG91bGQgcGFzcyBkYXRhIGJldHdlZW4gY29udHJvbGxlcnNcbmFwcC5mYWN0b3J5KCdSZXN1bHRTZXJ2aWNlJywgWyckaHR0cCcsZnVuY3Rpb24oJGh0dHApIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhZHVsdHMgPSBbXTtcbiAgICB2YXIgY29tcGFuaWVzID0gW107XG4gICAgdmFyIGtpZHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbihwYXNzZWREYXRhKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnLi4vc2VhcmNoJyxcbiAgICAgICAgICAgIHBhcmFtczp7c2VhcmNoOnBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEtpZHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBjb21wYW5pZXMuc3BsaWNlKDAsY29tcGFuaWVzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgIGNvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBnZXRFbGVtZW50MShhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnQxJyxjb21wYW5pZXMpO1xuICAgICAgICByZXR1cm4gY29tcGFuaWVzXG4gICAgfTtcblxuICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDIgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgYWR1bHRzLnNwbGljZSgwLGFkdWx0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDIoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBpbiBnZXRFbGVtZW50MicsIGFkdWx0cyk7XG4gICAgICAgIHJldHVybiBhZHVsdHNcbiAgICB9O1xuXG4gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAga2lkcy5zcGxpY2UoMCxraWRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NoaWxkJylcbiAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50czMnLCBraWRzKTtcbiAgICAgICAgcmV0dXJuIGtpZHNcbiAgICB9O1xuXG4gICAgLy9wdWJsaWNcbiAgICB2YXIgcHVibGljQXBpID0ge1xuICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuICAgICAgICBnZXRBZHVsdHM6IGdldEFkdWx0cyxcbiAgICAgICAgZ2V0Q29tcGFuaWVzOiBnZXRDb21wYW5pZXMsXG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICBjb21wYW5pZXM6IGNvbXBhbmllcyxcbiAgICAgICAgYWR1bHRzOiBhZHVsdHMsXG4gICAgICAgIGtpZHM6IGtpZHNcbiAgICB9O1xuICAgIHJldHVybiBwdWJsaWNBcGk7XG59XSk7IiwiLy8gUGxlYXNlIG5vdGUgdGhhdCAkbW9kYWxJbnN0YW5jZSByZXByZXNlbnRzIGEgbW9kYWwgd2luZG93IChpbnN0YW5jZSkgZGVwZW5kZW5jeS5cbi8vIEl0IGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgJHVpYk1vZGFsIHNlcnZpY2UgdXNlZCBhYm92ZS5cblxuLy9uZWVkZWQgZm9yIG1vZGFsPz8gcHJldHR5IHN1cmVcbmFwcC5jb250cm9sbGVyKCdNb2RhbEluc3RhbmNlQ3RybCcsWyckc2NvcGUnLCckbW9kYWxJbnN0YW5jZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlKSB7XG5cbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5zZWxlY3RlZC5pdGVtKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgfTtcbn1dKTsiLCJhcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uKXtcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9ob21lJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcbiAgICB9XG59XSk7XG4iLCIvLyBBamF4IGZvciBjcmVhdGluZyB0aGUgY29udGFjdCBsaXN0IGluIGNvbnN0YW50IGNvbnRhY3RcbmFwcC5jb250cm9sbGVyKCduZXdDb250YWN0TGlzdENvbnRyb2xsZXInLFsnbmV3Q29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihuZXdDb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2RhdGEgdG8gY3JlYXRlIGEgbmV3IGNvbnRhY3QgbGlzdFxuXG5cbiAgICAkc2NvcGUubGlzdE5hbWUgPSB7fTtcblxuICAgICRzY29wZS5jcmVhdGVMaXN0ICA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGUgbGlzdDogXCIgKyAkc2NvcGUubGlzdE5hbWUuaW5wdXQpO1xuICAgICAgICAvL3Bhc3NlcyBsaXN0IG5hbWUgc2VydmljZVxuICAgICAgICBuZXdDb250YWN0TGlzdERhdGEucG9zdExpc3QoJHNjb3BlLmxpc3ROYW1lLmlucHV0KTtcblxuICAgICAgICAkc2NvcGUubGlzdE5hbWU9e307XG4gICAgfTtcbn1dKTtcblxuXG4iLCIvL3NlcnZpY2UgZm9yIGFqYXggY2FsbHMgdG8gY29uc3RhbnQgY29udGFjdFxuXG5hcHAuc2VydmljZSgnbmV3Q29udGFjdExpc3REYXRhJywgWydDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgJyRodHRwJyxcbiAgICBmdW5jdGlvbiAoQ29udGFjdExpc3REYXRhU2VydmljZSwgJGh0dHApIHtcblxuICAgIHZhciBuZXdDb250YWN0TGlzdCA9IFtdO1xuICAgIHZhciBsaXN0TnVtID0gXCIxNDk5NTIzNjEwXCI7XG5cbiAgICB0aGlzLnBvc3RMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cC5wb3N0KCcvbmV3Q29udGFjdExpc3QnKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIGxpc3ROdW0gPSBkYXRhLmlkXG5cbiAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsgLy9lcnJvclxuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2cob3B0aW9ucylcbiAgICB9O1xuXG4gICAgdmFyIGltcG9ydERhdGFBcnJheSA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgIFwidXNlcjFAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiBcIkpvaG5cIixcbiAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6IFwiU21pdGhcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBYXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwiYW55dG93blwiXG4gICAgICAgICAgICB9XVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBcImVtYWlsX2FkZHJlc3Nlc1wiOiBbXG4gICAgICAgICAgICAgICAgXCJ1c2VyMkBleGFtcGxlLmNvbVwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6IFwiSmFuZVwiLFxuICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogXCJTbWl0aHlcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBZXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwic29tZXRvd25cIlxuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIF07XG5cbiAgICAvL3ZhciBjb250YWN0TGlzdE9iamVjdCA9KHtcbiAgICAvLyAgICBcIkltcG9ydCBEYXRhXCIgOiBpbXBvcnREYXRhQXJyYXksXG4gICAgLy8gICAgXCJsaXN0XCI6IFtsaXN0TnVtXSxcbiAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOltcIkVNQUlMXCIsXCJGSVJTVCBOQU1FXCIsIFwiTEFTVCBOQU1FXCIsIFwiQ0lUWVwiLFwiQ09NUEFOWSBOQU1FXCJdfSk7XG5cblxuICAgIHRoaXMucG9wTGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZ2V0Q2hlY2tlZCgpO1xuICAgICAgICAkaHR0cC5wb3N0KCcvcG9wdWxhdGVDb250YWN0TGlzdC5qcycsIGltcG9ydERhdGFBcnJheSwgbGlzdE51bSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2cob3B0aW9ucyk7XG5cbiAgICB9O1xuXG4gICAgLy9nZXQgYWxsIHRoZSBjaGVja2VkIGVsZW1lbnRzIGFuZCBzdHVmZiB0aGVtIGluIGFuIGFycmF5XG4gICAgdmFyIGdldENoZWNrZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKFwiOmNoZWNrZWQudHlwZS1lbGVtZW50XCIpLmVhY2goXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT0gQ29udGFjdExpc3REYXRhU2VydmljZS5yZXN1bHRzLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFjdE9iamVjdCA9XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmVtYWlsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpcnN0X25hbWVcIjogJCh0aGlzKS5maXJzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogJCh0aGlzKS5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbXBhbnlfbmFtZVwiOiAkKHRoaXMpLmNvbXBhbnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRyZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2l0eTogJCh0aGlzKS5jaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnREYXRhQXJyYXkucHVzaChjb250YWN0T2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxufV0pOyIsImFwcC5jb250cm9sbGVyKCdwb3BMaXN0Q29udHJvbGxlcicsWyduZXdDb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKG5ld0NvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0TmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLnBvcHVsYXRlTGlzdCAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlIGxpc3Q6IFwiICsgc2NvcGUubGlzdE5hbWUuaW5wdXQpO1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgIG5ld0NvbnRhY3RMaXN0RGF0YS5wb3BMaXN0KCk7XG4gICAgICAgIC8vdmFyIGxpc3RFbmQgPSB7XG4gICAgICAgIC8vICAgIFwibGlzdHNcIjogW2xpc3ROdW1dLFxuICAgICAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOiBbXG4gICAgICAgIC8vICAgIFwiRU1BSUxcIixcbiAgICAgICAgLy8gICAgXCJGSVJTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiTEFTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiQ0lUWVwiLFxuICAgICAgICAvLyAgICBcIkNPTVBBTlkgTkFNRVwiXG4gICAgICAgIC8vXX1cblxuXG4gICAgICAgICRzY29wZS5saXN0TmFtZT17fTtcbiAgICB9O1xufV0pO1xuXG4iLCJcbi8vcmVnaXN0ZXIgY29udHJvbGxlclxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXJDdHJsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZygncmVnaXN0ZXJDb250cm9sbGVyIHN1Ym1pdDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9yZWdpc3RlcicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iLCJhcHAuY29udHJvbGxlcigncmVzZXRDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VkaXQgcGFzc3dvcmQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wdXQoJy9hZG1pbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
