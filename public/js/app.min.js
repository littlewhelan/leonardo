var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.service("contactListData",function(){var t=[],e=0;return{newContactList:t,listNum:e}}),app.controller("newContactListController",["contactListData","$rootScope","$scope","$http",function(t,e,n,o){n.listname={},n.hide=function(){e.add=!0},n.config={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9","Content-Type":"application/json"}},n.postList=function(){n.listReq={name:n.listname.input,status:"ACTIVE"},console.log("posting list . . . "),console.log(n.listReq),console.log(n.config),o.post("https://api.constantcontact.com/v2/lists?api_key=yg5p2qf549qacmbqayk5rn23",n.listReq,n.config).then(function(e){console.log("res"+e),e.id=t.listNum})}}]),app.controller("contactListController",["contactListData","$scope","$http",function(t,e,n){var o=[],a=JSON.stringify("list: ["+t.listNum+'],column_names:["EMAIL","FIRST NAME", "LAST NAME", "CITY","COMPANY NAME"]');e.contactChecked=function(t){e.checked.push([t])},e.sendPost=function(){var e=$.param({json:JSON.stringify({importData:o+", "+a})}),i={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9"}};n.post("https://api.constantcontact.com/v2/activities/addcontacts?api_key=u8w59ztxe3294adczfvn7k9e",e,i).success(function(e,n,o,a){res.id=t.listNum}).error(function(t,e,n,o){})}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService",function(t,e,n,o){t.companies=o.companies,t.animationsEnabled=!0,t.openCorp=function(o){var a=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,resolve:{items:function(){return t.items}}});a.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)}),t.openCorp=function(t){},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}}]),app.controller("createListSearch",["$scope","$rootScope","ContactListDataService",function(t,e,n){e.add=!1,t.listForm={},t.searchListBtn=function(){n.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(t){return http({method:"GET",URL:"../createMailList",params:{search:t}}).then(function(t){e=t.data,s(e),r(e),c(e)})},r=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},c=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},l={makeDataCall:i,getCompanies:s,getKids:c,getAdults:r,results:e,allKids:o,allAdults:a,allCompanies:n};return l}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService",function(t,e,n,o){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o){var a=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,resolve:{items:function(){return t.items}}});a.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)}),t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,r(e),c(e),s(e)})},r=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},s=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},c=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},l={getKids:c,getAdults:s,getCompanies:r,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return l}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("tableCtrl",function(t){t.orderByField="firstName",t.reverseSort=!1,t.data={employees:[{firstName:"John",lastName:"Doe",age:30},{firstName:"Frank",lastName:"Burns",age:54},{firstName:"Sue",lastName:"Banter",age:21}]}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsInJlZ2lzdGVyQ29udHJvbGxlci5qcyIsInJlc2V0Q29udHJvbGxlci5qcyIsInRhYmxlLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJzZXJ2aWNlIiwibmV3Q29udGFjdExpc3QiLCJsaXN0TnVtIiwiY29udHJvbGxlciIsImNvbnRhY3RMaXN0RGF0YSIsIiRyb290U2NvcGUiLCIkc2NvcGUiLCIkaHR0cCIsImxpc3RuYW1lIiwiaGlkZSIsImFkZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiQ29udGVudC1UeXBlIiwicG9zdExpc3QiLCJsaXN0UmVxIiwibmFtZSIsImlucHV0Iiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInBvc3QiLCJ0aGVuIiwicmVzIiwiaWQiLCJpbXBvcnREYXRhQXJyYXkiLCJsaXN0RW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnRhY3RDaGVja2VkIiwiY2hlY2tlZCIsInB1c2giLCJzZW5kUG9zdCIsImRhdGEiLCIkIiwicGFyYW0iLCJqc29uIiwiaW1wb3J0RGF0YSIsInN1Y2Nlc3MiLCJlcnJvciIsImZhY3RvcnkiLCIkcSIsIiRsb2NhdGlvbiIsImF1dGhTZXJ2aWNlIiwicmVxdWVzdCIsImlzQXV0aGVkIiwiZ2V0VG9rZW4iLCJyZXNwb25zZSIsInBhdGgiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0IiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwicGFyc2UiLCJhdG9iIiwic2F2ZVRva2VuIiwibG9jYWxTdG9yYWdlIiwiand0VG9rZW4iLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJsb2dvdXQiLCJnZXRVc2VyIiwiJHVpYk1vZGFsIiwiJGxvZyIsIlJlc3VsdFNlcnZpY2UiLCJjb21wYW5pZXMiLCJhbmltYXRpb25zRW5hYmxlZCIsIm9wZW5Db3JwIiwic2l6ZSIsIm1vZGFsSW5zdGFuY2UiLCJvcGVuIiwiYW5pbWF0aW9uIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwicGFzc2VkRGF0YSIsInRvZ2dsZUFuaW1hdGlvbiIsIkNvbnRhY3RMaXN0RGF0YVNlcnZpY2UiLCJsaXN0Rm9ybSIsInNlYXJjaExpc3RCdG4iLCJtYWtlRGF0YUNhbGwiLCJyZXN1bHRzIiwiYWxsQ29tcGFuaWVzIiwiYWxsS2lkcyIsImFsbEFkdWx0cyIsImh0dHAiLCJtZXRob2QiLCJVUkwiLCJzZWFyY2giLCJnZXRDb21wYW5pZXMiLCJnZXRBZHVsdHMiLCJnZXRLaWRzIiwiYXJyYXkiLCJnZXRFbGVtZW50MyIsInNwbGljZSIsImxlbmd0aCIsImZvckVhY2giLCJlbGVtZW50IiwidHlwZSIsImtpZHMiLCJkYXRhQXBpIiwiYWR1bHRzIiwic3VibWl0IiwiZm9ybSIsInVzZXIiLCJmb3JtSW5wdXQiLCJzZWFyY2hCdG4iLCJ1cmwiLCJnZXRFbGVtZW50MSIsImdldEVsZW1lbnQyIiwicHVibGljQXBpIiwiJG1vZGFsSW5zdGFuY2UiLCJvayIsImNsb3NlIiwiaXRlbSIsImNhbmNlbCIsImRpc21pc3MiLCJ1c2VybmFtZSIsInB1dCIsIm9yZGVyQnlGaWVsZCIsInJldmVyc2VTb3J0IiwiZW1wbG95ZWVzIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJhZ2UiXSwibWFwcGluZ3MiOiJBQUNBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsT0FBQSxVQUFBLFlBQUEsZ0JBRUFGLEtBQUFHLFFBQUEsaUJBQ0EsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUNBQyxZQUFBLHNCQUVBRCxLQUFBLFdBQ0FDLFlBQUEsd0JBRUFELEtBQUEsYUFDQUMsWUFBQSx5QkFFQUQsS0FBQSxnQkFDQUMsWUFBQSw2QkFFQUQsS0FBQSxjQUNBQyxZQUFBLDJCQUVBRCxLQUFBLFlBQ0FDLFlBQUEseUJBRUFELEtBQUEsZ0JBQ0FDLFlBQUEsNkJBRUFDLFdBQ0FDLFdBQUEsZUFRQVIsSUFBQVMsUUFBQSxrQkFBQSxXQUNBLEdBQ0FDLE1BQ0FDLEVBQUEsQ0FHQSxRQUNBRCxlQUFBQSxFQUNBQyxRQUFBQSxLQXdEQVgsSUFBQVksV0FBQSw0QkFBQSxrQkFBQSxhQUFBLFNBQUEsUUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUVBRCxFQUFBRSxZQUVBRixFQUFBRyxLQUFBLFdBQ0FKLEVBQUFLLEtBQUEsR0FJQUosRUFBQVosUUFDQWlCLFNBQUFDLGNBQUEsOENBRUFDLGVBQUEscUJBTUFQLEVBQUFRLFNBQUEsV0FDQVIsRUFBQVMsU0FBQUMsS0FBQVYsRUFBQUUsU0FBQVMsTUFBQUMsT0FBQSxVQUNBQyxRQUFBQyxJQUFBLHVCQUNBRCxRQUFBQyxJQUFBZCxFQUFBUyxTQUNBSSxRQUFBQyxJQUFBZCxFQUFBWixRQUNBYSxFQUFBYyxLQUFBLDRFQUFBZixFQUFBUyxRQUFBVCxFQUFBWixRQUNBNEIsS0FBQSxTQUFBQyxHQUNBSixRQUFBQyxJQUFBLE1BQUFHLEdBRUFBLEVBQUFDLEdBQUFwQixFQUFBRixjQWNBWCxJQUFBWSxXQUFBLHlCQUFBLGtCQUFBLFNBQUEsUUFBQSxTQUFBQyxFQUFBRSxFQUFBQyxHQUdBLEdBQUFrQixNQUNB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QyxHQUNBckMsRUFBQWlILEtBQUEzRSxFQUFBNkIsVUFFQW5FLEVBQUFpSCxNQUFBakgsRUFBQWlILEtBQUFhLFVBQ0F6RixFQUFBTSxLQUFBLFNBR0ExQyxFQUFBaUUsT0FBQSxXQUNBNUIsRUFBQTRCLFNBQ0FsRSxFQUFBaUgsS0FBQTNFLEVBQUE2QixVQUNBOUIsRUFBQU0sS0FBQSxTQ1JBekQsSUFBQVksV0FBQSxnQkFBQSxTQUFBLFFBQUEsWUFBQSxTQUFBRyxFQUFBQyxFQUFBbUMsR0FDQXBDLEVBQUE4RyxPQUFBLFdBQ0FqRyxRQUFBQyxJQUFBLGdCQUNBRCxRQUFBQyxJQUFBLDZCQUFBZCxFQUFBK0csTUFDQTlHLEVBQUFjLEtBQUEsWUFBQWYsRUFBQStHLE1BQ0EvRixLQUFBLFNBQUF5QixHQUNBNUIsUUFBQUMsSUFBQTJCLEdBQ0FMLEVBQUFNLEtBQUEsZ0JDVEF6RCxJQUFBWSxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUcsRUFBQUMsRUFBQW1DLEdBQ0FwQyxFQUFBOEcsT0FBQSxXQUNBakcsUUFBQUMsSUFBQSxpQkFBQWQsRUFBQStHLE1BQ0E5RyxFQUFBNkgsSUFBQSxTQUFBOUgsRUFBQStHLE1BQ0EvRixLQUFBLFNBQUF5QixHQUNBNUIsUUFBQUMsSUFBQTJCLEdBQ0FMLEVBQUFNLEtBQUEsZ0JDSkF6RCxJQUFBWSxXQUFBLFlBQUEsU0FBQUcsR0FDQUEsRUFBQStILGFBQUEsWUFDQS9ILEVBQUFnSSxhQUFBLEVBRUFoSSxFQUFBMkIsTUFDQXNHLFlBQ0FDLFVBQUEsT0FDQUMsU0FBQSxNQUNBQyxJQUFBLEtBRUFGLFVBQUEsUUFDQUMsU0FBQSxRQUNBQyxJQUFBLEtBRUFGLFVBQUEsTUFDQUMsU0FBQSxTQUNBQyxJQUFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbGVvJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZScsICd1aS5ib290c3RyYXAnXSk7XG5cbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2xvZ2luLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL3NlYXJjaC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvcmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RMaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0TGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkZmFtaWx5Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRmYW1pbHkuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGNvcnAnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGNvcnAuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RsaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvc2VhcmNoJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG5cbmFwcC5zZXJ2aWNlKCdjb250YWN0TGlzdERhdGEnLCBmdW5jdGlvbigpe1xuICAgIHZhciBpbmNsdWRlZEVtYWlscyA9IFtdO1xuICAgIHZhciBuZXdDb250YWN0TGlzdCA9IFtdO1xuICAgIHZhciBsaXN0TnVtID0gMDtcblxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmV3Q29udGFjdExpc3Q6IG5ld0NvbnRhY3RMaXN0LFxuICAgICAgICBsaXN0TnVtOiBsaXN0TnVtXG4gICAgfTtcbn0pO1xuXG5cblxuXG5cblxuLy9kdW1teSBkYXRhIGVkaXQgZmFtaWx5IGFkZGl0aW9uYWwgbWVtYmVyc1xuLy9hcHAuY29udHJvbGxlcignYWRkaXRpb25hbEN0cmwnLCBbICckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHtcbi8vICAgICRzY29wZS5hZGRpdGlvbmFsID0ge1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5zZXQgPSBmdW5jdGlvbihlZGl0X2luZm8pIHtcbi8vICAgICAgICB0aGlzLmNvbnRhY3QuZk5hbWUgPSBlZGl0X2luZm8sXG4vLyAgICAgICAgdGhpcy5jb250YWN0LmxOYW1lID0gZWRpdF9pbmZvLFxuLy8gICAgICAgIHRoaXMuY29udGFjdC5iRGF5ID0gZWRpdF9pbmZvLFxuLy8gICAgICAgIHRoaXMuY29udGFjdC5ub3RlcyA9IGVkaXRfaW5mb1xuLy8gICAgfTtcbi8vfV0pO1xuXG4vL2R1bW15IGRhdGEgZm9yIGZhbWlseSBjb250YWN0IGluZm9ybWF0aW9uXG4vL2FwcC5jb250cm9sbGVyKCdjb250YWN0Q3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgLy8kc2NvcGUuY29udGFjdCA9IHtcbiAgICAvL307XG4gICAgLy8kc2NvcGUuc2V0ID0gZnVuY3Rpb24oZWRpdF9pbmZvKSB7XG4gICAgLy8gICAgdGhpcy5jb250YWN0LmZOYW1lID0gZWRpdF9pbmZvLFxuICAgIC8vICAgIGl0X2luZm9cbiAgICAvL307XG5cbi8vfV0pO1xuXG4vL2R1bW15IGRhdGEgZm9yIGZhbWlseSBlbWVyZ2VuY3kgY29udGFjdCBpbmZvcm1hdGlvblxuLy9hcHAuY29udHJvbGxlcignZW1lcmdlbmN5Q3RybCcsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgIC8vJHNjb3BlLmVtZXJnZW5jeSA9IHtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAvLyRzY29wZS5zZXQgPSBmdW5jdGlvbihlZGl0X2luZm8pIHtcbiAgICAvLyAgICB0aGlzLmVtZXJnZW5jeS5mTmFtZSA9IGVkaXRfaW5mbyxcblxuICAgIC8vfTtcbi8vfV0pO1xuXG5cbi8vYXBwLnNlcnZpY2UoJ2NvbnRhY3RMaXN0RGF0YScsIGZ1bmN0aW9uKCl7XG4vLyAgICB2YXIgaW5jbHVkZWRFbWFpbHMgPSBbXTtcbi8vICAgIHZhciBuZXdDb250YWN0TGlzdCA9IFtdO1xuLy8gICAgdmFyIGxpc3ROdW0gPSAwO1xuLy9cbi8vXG4vLyAgICByZXR1cm4ge1xuLy8gICAgICAgIG5ld0NvbnRhY3RMaXN0OiBuZXdDb250YWN0TGlzdCxcbi8vICAgICAgICBsaXN0TnVtOiBsaXN0TnVtXG4vLyAgICB9O1xuLy99KTtcblxuXG5hcHAuY29udHJvbGxlcignbmV3Q29udGFjdExpc3RDb250cm9sbGVyJyxbJ2NvbnRhY3RMaXN0RGF0YScsJyRyb290U2NvcGUnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwkcm9vdFNjb3BlLCAkc2NvcGUsICRodHRwKSB7XG4gICAgLy9kYXRhIHRvIGNyZWF0ZSBhIG5ldyBjb250YWN0IGxpc3RcbiAgICAkc2NvcGUubGlzdG5hbWUgPSB7fTtcblxuICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJHJvb3RTY29wZS5hZGQgPSB0cnVlO1xuICAgIH07XG5cbiAgICAvL2hlYWRlcnNcbiAgICAkc2NvcGUuY29uZmlnID0ge1xuICAgICAgICBoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyIGVmNWQ1ZGYyLWE4MDgtNGM3MC1hNWQ5LWViNzExNjNjYmViOScsXG5cbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcblxuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vZnVuY3Rpb24gdG8gY3JlYXRzIHRoZSBuZXcgY29udGFjdCBsaXN0XG4gICAgJHNjb3BlLnBvc3RMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubGlzdFJlcSA9IHtcIm5hbWVcIjogJHNjb3BlLmxpc3RuYW1lLmlucHV0LCBcInN0YXR1c1wiOiBcIkFDVElWRVwifTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Bvc3RpbmcgbGlzdCAuIC4gLiAnKTtcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmxpc3RSZXEpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuY29uZmlnKTtcbiAgICAgICAgJGh0dHAucG9zdCgnaHR0cHM6Ly9hcGkuY29uc3RhbnRjb250YWN0LmNvbS92Mi9saXN0cz9hcGlfa2V5PXlnNXAycWY1NDlxYWNtYnFheWs1cm4yMycsICRzY29wZS5saXN0UmVxLCAkc2NvcGUuY29uZmlnKS5cbiAgICAgICAgICAgIHRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzXCIgKyByZXMpO1xuXG4gICAgICAgICAgICAgICAgcmVzLmlkID0gY29udGFjdExpc3REYXRhLmxpc3ROdW07XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvL2Vycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgLy8gICAgLy8gbG9nIGVycm9yXG4gICAgICAgICAgICAvL30pO1xuXG5cbiAgICB9O1xuXG59XSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ2NvbnRhY3RMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuXG5cbiAgICB2YXIgaW1wb3J0RGF0YUFycmF5ID0gW107XG4gICAgdmFyIGxpc3RFbmQgPSBKU09OLnN0cmluZ2lmeShcImxpc3Q6IFtcIisgY29udGFjdExpc3REYXRhLmxpc3ROdW0gKyBcIl0sY29sdW1uX25hbWVzOltcXFwiRU1BSUxcXFwiLFxcXCJGSVJTVCBOQU1FXFxcIiwgXFxcIkxBU1QgTkFNRVxcXCIsIFxcXCJDSVRZXFxcIixcXFwiQ09NUEFOWSBOQU1FXFxcIl1cIik7XG5cbiAgICAvL3B1c2ggdGhlIGluY2x1ZGVkL2NoZWNrZWQgaW5mbyB0byB0aGUgZW1haWwgbGlzdFxuICAgICRzY29wZS5jb250YWN0Q2hlY2tlZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAkc2NvcGUuY2hlY2tlZC5wdXNoKFtpZF0pO1xuICAgIH07XG5cblxuICAgIC8vUG9zdCBEYXRhIHRvIENvbnN0YW50IENvbnRhY3RcbiAgICAkc2NvcGUuc2VuZFBvc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRhdGEgPSAkLnBhcmFtKHtcbiAgICAgICAgICAgIGpzb246IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBcImltcG9ydERhdGFcIjogaW1wb3J0RGF0YUFycmF5ICsgXCIsIFwiICsgbGlzdEVuZFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cblxuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciBlZjVkNWRmMi1hODA4LTRjNzAtYTVkOS1lYjcxMTYzY2JlYjknXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnaHR0cHM6Ly9hcGkuY29uc3RhbnRjb250YWN0LmNvbS92Mi9hY3Rpdml0aWVzL2FkZGNvbnRhY3RzP2FwaV9rZXk9dTh3NTl6dHhlMzI5NGFkY3pmdm43azllJywgZGF0YSwgY29uZmlnKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgcmVzLmlkID0gY29udGFjdExpc3REYXRhLmxpc3ROdW07XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIC8vIGxvZyBlcnJvclxuICAgICAgICAgICAgfSk7XG5cbiAgIH07XG59XSk7XG5cblxuXG4iLCJhcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKSIsImFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KSB7XG5cbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pIiwiLy9lZGl0IGNvcnBvcmF0aW9uIG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdENvcnBDdHJsJywgWyckc2NvcGUnLCAnJHVpYk1vZGFsJywgJyRsb2cnLCAnUmVzdWx0U2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSkge1xuICAgIC8vc2VuZHMgdGhlIGNvbXBhbmllcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgJHNjb3BlLmNvbXBhbmllcyA9IFJlc3VsdFNlcnZpY2UuY29tcGFuaWVzO1xuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcblxuICAgICRzY29wZS5vcGVuQ29ycCA9IGZ1bmN0aW9uIChzaXplKSB7XG5cbiAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0Y29ycC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuaXRlbXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLm9wZW5Db3JwID0gZnVuY3Rpb24ocGFzc2VkRGF0YSkge1xuXG4gICAgICAgIH07XG5cblxuXG4gICAgICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvL2dldCBjYWxsIGZvciBjb3Jwb3JhdGUgbW9kYWxzXG5cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdjcmVhdGVMaXN0U2VhcmNoJyxbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIENvbnRhY3RMaXN0RGF0YVNlcnZpY2Upe1xuICAgICRyb290U2NvcGUuYWRkID0gZmFsc2U7XG4gICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaExpc3RCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICAgQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmxpc3RGb3JtLmRhdGEpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUubGlzdEZvcm09e307XG4gICAgfTtcbn1dKTsiLCJhcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhbGxDb21wYW5pZXMgPSBbXTtcbiAgICB2YXIgYWxsS2lkcyA9IFtdO1xuICAgIHZhciBhbGxBZHVsdHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbiAocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgVVJMOiAnLi4vY3JlYXRlTWFpbExpc3QnLFxuICAgICAgICAgICAgcGFyYW1zOiB7c2VhcmNoOiBwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsQWR1bHRzLnNwbGljZSgwLCBhbGxBZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFsbEFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsQWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxDb21wYW5pZXMuc3BsaWNlKDAsIGFsbENvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgICAgICBhbGxDb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbEtpZHMuc3BsaWNlKDAsIGFsbEtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbEtpZHNcbiAgICB9O1xuXG4gICAgdmFyIGRhdGFBcGkgPSB7XG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGFsbEtpZHM6IGFsbEtpZHMsXG4gICAgICAgIGFsbEFkdWx0czogYWxsQWR1bHRzLFxuICAgICAgICBhbGxDb21wYW5pZXM6IGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICByZXR1cm4gZGF0YUFwaTtcblxufV0pO1xuIiwiLy9lZGl0IGZhbWlseSBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRGYW1pbHlDdHJsJyxbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsJ1Jlc3VsdFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAvL3NlbmRzIHRoZSBhZHVsdHMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICRzY29wZS5hZHVsdHMgPSBSZXN1bHRTZXJ2aWNlLmFkdWx0cztcbiAgICAvL3NlbmRzIHRoZSBraWRzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAkc2NvcGUua2lkcyA9IFJlc3VsdFNlcnZpY2Uua2lkcztcblxuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcblxuICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5pdGVtcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgICAgICB9O1xuXG4gICAgfTtcbn1dKTsiLCIvL2NvbnRyb2xsZXJzIGZvciBsb2dpblxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSl7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9zZWFyY2hcIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xufV0pO1xuIiwiXG4vL1RoaXMgc2hvdWxkIGdldCB0aGUgc2VhcmNoIGl0ZW1cbmFwcC5jb250cm9sbGVyKCdzZWFyY2hGdW5jdGlvbicsIFsnJHNjb3BlJywgJyRodHRwJywgJ1Jlc3VsdFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUmVzdWx0U2VydmljZSkge1xuICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG5cbiAgICAkc2NvcGUuc2VhcmNoQnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgUmVzdWx0U2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmZvcm1JbnB1dC5kYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgdGhlIGlucHV0IHRleHQnLCAkc2NvcGUuZm9ybUlucHV0KTtcbiAgICAgICAgLy9lbXB0eXMgdGhlIHNlYXJjaCBib3hcbiAgICAgICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcbiAgICB9O1xuXG59XSk7XG4iLCIvL1RoaXMgc2VydmljZSBzaG91bGQgcGFzcyBkYXRhIGJldHdlZW4gY29udHJvbGxlcnNcbmFwcC5mYWN0b3J5KCdSZXN1bHRTZXJ2aWNlJywgWyckaHR0cCcsZnVuY3Rpb24oJGh0dHApIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhZHVsdHMgPSBbXTtcbiAgICB2YXIgY29tcGFuaWVzID0gW107XG4gICAgdmFyIGtpZHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbihwYXNzZWREYXRhKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnLi4vc2VhcmNoJyxcbiAgICAgICAgICAgIHBhcmFtczp7c2VhcmNoOnBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEtpZHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQxID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGNvbXBhbmllcy5zcGxpY2UoMCxjb21wYW5pZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY29tcGFueScpXG4gICAgICAgICAgICAgICAgY29tcGFuaWVzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIGdldEVsZW1lbnQxKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudDEnLGNvbXBhbmllcyk7XG4gICAgICAgIHJldHVybiBjb21wYW5pZXNcbiAgICB9O1xuXG4gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBhZHVsdHMuc3BsaWNlKDAsYWR1bHRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2FkdWx0JylcbiAgICAgICAgICAgICAgICAgICAgYWR1bHRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MihhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGluIGdldEVsZW1lbnQyJywgYWR1bHRzKTtcbiAgICAgICAgcmV0dXJuIGFkdWx0c1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBraWRzLnNwbGljZSgwLGtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuICAgICAgICAgICAgICAgICAgICBraWRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnRzMycsIGtpZHMpO1xuICAgICAgICByZXR1cm4ga2lkc1xuICAgIH07XG5cbiAgICAvL3B1YmxpY1xuICAgIHZhciBwdWJsaWNBcGkgPSB7XG4gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGwsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGNvbXBhbmllczogY29tcGFuaWVzLFxuICAgICAgICBhZHVsdHM6IGFkdWx0cyxcbiAgICAgICAga2lkczoga2lkc1xuICAgIH07XG4gICAgcmV0dXJuIHB1YmxpY0FwaTtcbn1dKTsiLCIvLyBQbGVhc2Ugbm90ZSB0aGF0ICRtb2RhbEluc3RhbmNlIHJlcHJlc2VudHMgYSBtb2RhbCB3aW5kb3cgKGluc3RhbmNlKSBkZXBlbmRlbmN5LlxuLy8gSXQgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSAkdWliTW9kYWwgc2VydmljZSB1c2VkIGFib3ZlLlxuXG4vL25lZWRlZCBmb3IgbW9kYWw/PyBwcmV0dHkgc3VyZVxuYXBwLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJyxbJyRzY29wZScsJyRtb2RhbEluc3RhbmNlJywgZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UpIHtcblxuICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJHNjb3BlLnNlbGVjdGVkLml0ZW0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICB9O1xufV0pOyIsImFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsJyRzY29wZScsJyRyb290U2NvcGUnLCckbG9jYXRpb24nLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2hvbWUnKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgIH1cbn1dKTtcbiIsIlxuLy9yZWdpc3RlciBjb250cm9sbGVyXG5hcHAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZWdpc3RlckN0cmxcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZWdpc3RlckNvbnRyb2xsZXIgc3VibWl0OicsICRzY29wZS5mb3JtKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3JlZ2lzdGVyJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvaW5kZXhcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdyZXNldEN0cmwnLCBbICckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnZWRpdCBwYXNzd29yZDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnB1dCgnL2FkbWluJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvaW5kZXhcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1dKTtcbiIsIlxuXG5hcHAuY29udHJvbGxlcigndGFibGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgJHNjb3BlLm9yZGVyQnlGaWVsZCA9ICdmaXJzdE5hbWUnO1xuICAgICRzY29wZS5yZXZlcnNlU29ydCA9IGZhbHNlO1xuXG4gICAgJHNjb3BlLmRhdGEgPSB7XG4gICAgICAgIGVtcGxveWVlczogW3tcbiAgICAgICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgICAgICAgYWdlOiAzMFxuICAgICAgICB9LHtcbiAgICAgICAgICAgIGZpcnN0TmFtZTogJ0ZyYW5rJyxcbiAgICAgICAgICAgIGxhc3ROYW1lOiAnQnVybnMnLFxuICAgICAgICAgICAgYWdlOiA1NFxuICAgICAgICB9LHtcbiAgICAgICAgICAgIGZpcnN0TmFtZTogJ1N1ZScsXG4gICAgICAgICAgICBsYXN0TmFtZTogJ0JhbnRlcicsXG4gICAgICAgICAgICBhZ2U6IDIxXG4gICAgICAgIH1dXG4gICAgfTtcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
