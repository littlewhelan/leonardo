function formatDates(t){return{full:moment(t).format(fullDate),pretty:moment(t).format(prettyDate)}}var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]),prettyDate="MM/DD/YYgYY",fullDate="MM/DD/YYYY h:mm:ss a";app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.companies=o.companies,t.animationsEnabled=!0,t.open=function(o,i){return console.log("corp call",i),a({method:"GET",url:"../corporation",params:{id:i}}).then(function(a){t.company=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.company}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$rootScope","ContactListDataService",function(t,e,n){e.add=!1,t.listForm={},t.searchListBtn=function(){n.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(t){return http({method:"GET",URL:"../createMailList",params:{search:t}}).then(function(t){e=t.data,r(e),s(e),c(e)})},s=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},c=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},l={makeDataCall:i,getCompanies:r,getKids:c,getAdults:s,results:e,allKids:o,allAdults:a,allCompanies:n};return l}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){t.family=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.family}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,s(e),c(e),r(e)})},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},c=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},l={getKids:c,getAdults:r,getCompanies:s,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return l}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("newContactListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.createList=function(){console.log("create list: "+scope.listname.input),t.postList(scope.listname.input),e.listname={}}}]),app.service("contactListData",["ContactListDataService","$scope","$http",function(t,e,n){function o(){$(":checked.type-element").each(function(){if(id=createListService.results.id){var t={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};s.push(t)}})}var a=[],i="1499523610";e.postList=function(){n.post("/newContactList").success(function(t,e,n,o){console.log(t),i=t.id}),console.log(options)};var s=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];return e.popList=function(){o(),n.post("/populateContactList.js",s,i).success(function(t,e,n,o){console.log(t)}),console.log(options)},{newContactList:a,listNum:i}}]),app.controller("popListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.populateList=function(){console.log("create list: "+scope.listname.input),t.popList(),e.listname={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImZvcm1hdERhdGVzIiwiZGF0ZSIsImZ1bGwiLCJtb21lbnQiLCJmb3JtYXQiLCJmdWxsRGF0ZSIsInByZXR0eSIsInByZXR0eURhdGUiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsImlzQXV0aGVkIiwiQXV0aG9yaXphdGlvbiIsImdldFRva2VuIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZWplY3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsInNhdmVUb2tlbiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwicGFyYW1zIiwibm90RXhwaXJlZCIsIk1hdGgiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsIiRodHRwIiwiY29tcGFuaWVzIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJvcGVuIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsImNvbXBhbnkiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsImFuaW1hdGlvbiIsInNjb3BlIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwidG9nZ2xlQW5pbWF0aW9uIiwiJHJvb3RTY29wZSIsIkNvbnRhY3RMaXN0RGF0YVNlcnZpY2UiLCJhZGQiLCJsaXN0Rm9ybSIsInNlYXJjaExpc3RCdG4iLCJtYWtlRGF0YUNhbGwiLCJyZXN1bHRzIiwiYWxsQ29tcGFuaWVzIiwiYWxsS2lkcyIsImFsbEFkdWx0cyIsInBhc3NlZERhdGEiLCJodHRwIiwiVVJMIiwic2VhcmNoIiwiZ2V0Q29tcGFuaWVzIiwiZ2V0QWR1bHRzIiwiZ2V0S2lkcyIsImFycmF5IiwiZ2V0RWxlbWVudDMiLCJzcGxpY2UiLCJsZW5ndGgiLCJmb3JFYWNoIiwiZWxlbWVudCIsInR5cGUiLCJwdXNoIiwia2lkcyIsImRhdGFBcGkiLCJhZHVsdHMiLCJmYW1pbHkiLCJzdWJtaXQiLCJwb3N0IiwiZm9ybSIsInVzZXIiLCJmb3JtSW5wdXQiLCJzZWFyY2hCdG4iLCJnZXRFbGVtZW50MSIsImdldEVsZW1lbnQyIiwicHVibGljQXBpIiwiJG1vZGFsSW5zdGFuY2UiLCJvayIsImNsb3NlIiwiaXRlbSIsImNhbmNlbCIsImRpc21pc3MiLCJ1c2VybmFtZSIsImNvbnRhY3RMaXN0RGF0YSIsImxpc3RuYW1lIiwiY3JlYXRlTGlzdCIsImlucHV0IiwicG9zdExpc3QiLCJnZXRDaGVja2VkIiwiJCIsImVhY2giLCJjcmVhdGVMaXN0U2VydmljZSIsImNvbnRhY3RPYmplY3QiLCJlbWFpbF9hZGRyZXNzZXMiLCJlbWFpbCIsImZpcnN0X25hbWUiLCJmaXJzdE5hbWUiLCJsYXN0X25hbWUiLCJsYXN0TmFtZSIsImNvbXBhbnlfbmFtZSIsImFkZHJlc3NlcyIsImNpdHkiLCJpbXBvcnREYXRhQXJyYXkiLCJuZXdDb250YWN0TGlzdCIsImxpc3ROdW0iLCJzdWNjZXNzIiwib3B0aW9ucyIsInBvcExpc3QiLCJwb3B1bGF0ZUxpc3QiLCJwdXQiXSwibWFwcGluZ3MiOiJBQUtBLFFBQUFBLGFBQUFDLEdBQ0EsT0FDQUMsS0FBQUMsT0FBQUYsR0FBQUcsT0FBQUMsVUFDQUMsT0FBQUgsT0FBQUYsR0FBQUcsT0FBQUcsYUFSQSxHQUFBQyxLQUFBQyxRQUFBQyxPQUFBLE9BQUEsVUFBQSxZQUFBLGlCQUVBSCxXQUFBLGNBQ0FGLFNBQUEsc0JBU0FHLEtBQUFHLFFBQUEsaUJBQ0EsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUNBQyxZQUFBLHNCQUVBRCxLQUFBLFdBQ0FDLFlBQUEsd0JBRUFELEtBQUEsYUFDQUMsWUFBQSx5QkFFQUQsS0FBQSxnQkFDQUMsWUFBQSw2QkFFQUQsS0FBQSxjQUNBQyxZQUFBLDJCQUVBRCxLQUFBLFlBQ0FDLFlBQUEseUJBRUFELEtBQUEsZ0JBQ0FDLFlBQUEsNkJBRUFDLFdBQ0FDLFdBQUEsZUNyQ0FSLElBQUFTLFFBQUEsbUJBQUEsS0FBQSxZQUFBLGNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQSxPQUNBQyxRQUFBLFNBQUFWLEdBS0EsTUFKQUEsR0FBQVcsUUFBQVgsRUFBQVcsWUFDQUYsRUFBQUcsYUFDQVosRUFBQVcsUUFBQUUsY0FBQSxVQUFBSixFQUFBSyxZQUVBZCxHQUVBZSxTQUFBLFNBQUFBLEdBT0EsTUFMQSxPQUFBQSxFQUFBQyxRQUdBUixFQUFBUyxLQUFBLEtBRUFGLEdBQUFSLEVBQUFMLEtBQUFhLElBQ0FHLGNBQUEsU0FBQUgsR0FTQSxNQVJBLE9BQUFB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RixFQUFBdUUsZ0JDbkJBekgsSUFBQWlELFdBQUEsZ0JBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUMsRUFBQUksRUFBQTNDLEdBQ0F1QyxFQUFBc0QsT0FBQSxXQUNBbEYsUUFBQUMsSUFBQSxnQkFDQUQsUUFBQUMsSUFBQSw2QkFBQTJCLEVBQUF3RCxNQUNBcEQsRUFBQW1ELEtBQUEsWUFBQXZELEVBQUF3RCxNQUNBNUMsS0FBQSxTQUFBNUMsR0FDQUksUUFBQUMsSUFBQUwsR0FDQVAsRUFBQVMsS0FBQSxnQkNUQXBCLElBQUFpRCxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUMsRUFBQUksRUFBQTNDLEdBQ0F1QyxFQUFBc0QsT0FBQSxXQUNBbEYsUUFBQUMsSUFBQSxpQkFBQTJCLEVBQUF3RCxNQUNBcEQsRUFBQTRGLElBQUEsU0FBQWhHLEVBQUF3RCxNQUNBNUMsS0FBQSxTQUFBNUMsR0FDQUksUUFBQUMsSUFBQUwsR0FDQVAsRUFBQVMsS0FBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdsZW8nLCBbJ25nUm91dGUnLCAnbmdBbmltYXRlJywgJ3VpLmJvb3RzdHJhcCddKTtcblxudmFyIHByZXR0eURhdGUgPSBcIk1NL0REL1lZZ1lZXCI7XG52YXIgZnVsbERhdGUgPSBcIk1NL0REL1lZWVkgaDptbTpzcyBhXCI7XG5cbmZ1bmN0aW9uIGZvcm1hdERhdGVzIChkYXRlKSB7XG5cdHJldHVybiB7XG5cdFx0ZnVsbDogbW9tZW50KGRhdGUpLmZvcm1hdChmdWxsRGF0ZSksXG5cdFx0cHJldHR5OiBtb21lbnQoZGF0ZSkuZm9ybWF0KHByZXR0eURhdGUpXG5cdH07XG59XG5cbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2xvZ2luLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL3NlYXJjaC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvcmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RMaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0TGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkZmFtaWx5Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRmYW1pbHkuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGNvcnAnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGNvcnAuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RsaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvc2VhcmNoJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG4iLCJhcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKSIsImFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KSB7XG5cbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pIiwiLy9lZGl0IGNvcnBvcmF0aW9uIG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdENvcnBDdHJsJywgWyckc2NvcGUnLCAnJHVpYk1vZGFsJywgJyRsb2cnLCAnUmVzdWx0U2VydmljZScsICckaHR0cCcsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSwgJGh0dHApIHtcbiAgICAvL3NlbmRzIHRoZSBjb21wYW5pZXMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICAgICAkc2NvcGUuY29tcGFuaWVzID0gUmVzdWx0U2VydmljZS5jb21wYW5pZXM7XG5cbiAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuXG4gICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NvcnAgY2FsbCcsIGlkKTtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9jb3Jwb3JhdGlvbicsXG4gICAgICAgICAgICBwYXJhbXM6e2lkOmlkfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnkgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2VkaXRjb3JwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuY29tcGFueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICB9O1xuXG5cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdjcmVhdGVMaXN0U2VhcmNoJyxbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIENvbnRhY3RMaXN0RGF0YVNlcnZpY2Upe1xuICAgICRyb290U2NvcGUuYWRkID0gZmFsc2U7XG4gICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaExpc3RCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICAgQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmxpc3RGb3JtLmRhdGEpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUubGlzdEZvcm09e307XG4gICAgfTtcbn1dKTsiLCJhcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhbGxDb21wYW5pZXMgPSBbXTtcbiAgICB2YXIgYWxsS2lkcyA9IFtdO1xuICAgIHZhciBhbGxBZHVsdHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbiAocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgVVJMOiAnLi4vY3JlYXRlTWFpbExpc3QnLFxuICAgICAgICAgICAgcGFyYW1zOiB7c2VhcmNoOiBwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICB2YXIgZ2V0QWR1bHRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsQWR1bHRzLnNwbGljZSgwLCBhbGxBZHVsdHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFsbEFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICByZXR1cm4gYWxsQWR1bHRzXG4gICAgfTtcblxuICAgIHZhciBnZXRDb21wYW5pZXMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxDb21wYW5pZXMuc3BsaWNlKDAsIGFsbENvbXBhbmllcy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgICAgICBhbGxDb21wYW5pZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbEtpZHMuc3BsaWNlKDAsIGFsbEtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjaGlsZCcpXG4gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbEtpZHNcbiAgICB9O1xuXG4gICAgdmFyIGRhdGFBcGkgPSB7XG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgZ2V0S2lkczogZ2V0S2lkcyxcbiAgICAgICAgZ2V0QWR1bHRzOiBnZXRBZHVsdHMsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGFsbEtpZHM6IGFsbEtpZHMsXG4gICAgICAgIGFsbEFkdWx0czogYWxsQWR1bHRzLFxuICAgICAgICBhbGxDb21wYW5pZXM6IGFsbENvbXBhbmllc1xuICAgIH07XG5cbiAgICByZXR1cm4gZGF0YUFwaTtcblxufV0pO1xuIiwiLy9lZGl0IGZhbWlseSBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRGYW1pbHlDdHJsJyxbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsJ1Jlc3VsdFNlcnZpY2UnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UsICRodHRwKSB7XG5cbiAgICAvL3NlbmRzIHRoZSBhZHVsdHMgYW5kIGtpZHMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICAgICAkc2NvcGUuYWR1bHRzID0gUmVzdWx0U2VydmljZS5hZHVsdHM7XG4gICAgICAgICRzY29wZS5raWRzID0gUmVzdWx0U2VydmljZS5raWRzO1xuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmYW1pbHkgY2FsbCcsaWQpO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHVybDogJy4uL2ZhbWlseScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOntpZDppZH1cbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgXHRcdFx0JHNjb3BlLmZhbWlseSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGZhbWlseS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICBcdFx0XHRcdHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5mYW1pbHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICAgICAgICAgIH07XG5cblxufV0pOyIsIi8vY29udHJvbGxlcnMgZm9yIGxvZ2luXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL3NlYXJjaFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XSk7XG4iLCJcbi8vVGhpcyBzaG91bGQgZ2V0IHRoZSBzZWFyY2ggaXRlbVxuYXBwLmNvbnRyb2xsZXIoJ3NlYXJjaEZ1bmN0aW9uJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnUmVzdWx0U2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCBSZXN1bHRTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcblxuICAgICRzY29wZS5zZWFyY2hCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICBSZXN1bHRTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUuZm9ybUlucHV0LmRhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgaW5wdXQgdGV4dCcsICRzY29wZS5mb3JtSW5wdXQpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuICAgIH07XG5cbn1dKTtcbiIsIi8vVGhpcyBzZXJ2aWNlIHNob3VsZCBwYXNzIGRhdGEgYmV0d2VlbiBjb250cm9sbGVyc1xuYXBwLmZhY3RvcnkoJ1Jlc3VsdFNlcnZpY2UnLCBbJyRodHRwJyxmdW5jdGlvbigkaHR0cCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIGFkdWx0cyA9IFtdO1xuICAgIHZhciBjb21wYW5pZXMgPSBbXTtcbiAgICB2YXIga2lkcyA9IFtdO1xuXG4gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uKHBhc3NlZERhdGEpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9zZWFyY2gnLFxuICAgICAgICAgICAgcGFyYW1zOntzZWFyY2g6cGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQxID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGNvbXBhbmllcy5zcGxpY2UoMCxjb21wYW5pZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY29tcGFueScpXG4gICAgICAgICAgICAgICAgY29tcGFuaWVzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIGdldEVsZW1lbnQxKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudDEnLGNvbXBhbmllcyk7XG4gICAgICAgIHJldHVybiBjb21wYW5pZXNcbiAgICB9O1xuXG4gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBhZHVsdHMuc3BsaWNlKDAsYWR1bHRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2FkdWx0JylcbiAgICAgICAgICAgICAgICAgICAgYWR1bHRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MihhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGluIGdldEVsZW1lbnQyJywgYWR1bHRzKTtcbiAgICAgICAgcmV0dXJuIGFkdWx0c1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBraWRzLnNwbGljZSgwLGtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuICAgICAgICAgICAgICAgICAgICBraWRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnRzMycsIGtpZHMpO1xuICAgICAgICByZXR1cm4ga2lkc1xuICAgIH07XG5cbiAgICAvL3B1YmxpY1xuICAgIHZhciBwdWJsaWNBcGkgPSB7XG4gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGwsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGNvbXBhbmllczogY29tcGFuaWVzLFxuICAgICAgICBhZHVsdHM6IGFkdWx0cyxcbiAgICAgICAga2lkczoga2lkc1xuICAgIH07XG4gICAgcmV0dXJuIHB1YmxpY0FwaTtcbn1dKTsiLCIvLyBQbGVhc2Ugbm90ZSB0aGF0ICRtb2RhbEluc3RhbmNlIHJlcHJlc2VudHMgYSBtb2RhbCB3aW5kb3cgKGluc3RhbmNlKSBkZXBlbmRlbmN5LlxuLy8gSXQgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSAkdWliTW9kYWwgc2VydmljZSB1c2VkIGFib3ZlLlxuXG4vL25lZWRlZCBmb3IgbW9kYWw/PyBwcmV0dHkgc3VyZVxuYXBwLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJyxbJyRzY29wZScsJyRtb2RhbEluc3RhbmNlJywgZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UpIHtcblxuICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJHNjb3BlLnNlbGVjdGVkLml0ZW0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICB9O1xufV0pOyIsImFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsJyRzY29wZScsJyRyb290U2NvcGUnLCckbG9jYXRpb24nLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2hvbWUnKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgIH1cbn1dKTtcbiIsIi8vIEFqYXggZm9yIGNyZWF0aW5nIHRoZSBjb250YWN0IGxpc3QgaW4gY29uc3RhbnQgY29udGFjdFxuYXBwLmNvbnRyb2xsZXIoJ25ld0NvbnRhY3RMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0bmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLmNyZWF0ZUxpc3QgID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZSBsaXN0OiBcIiArIHNjb3BlLmxpc3RuYW1lLmlucHV0KTtcbiAgICAgICAgLy9wYXNzZXMgbGlzdCBuYW1lIHNlcnZpY2VcbiAgICAgICAgY29udGFjdExpc3REYXRhLnBvc3RMaXN0KHNjb3BlLmxpc3RuYW1lLmlucHV0KTtcblxuICAgICAgICAkc2NvcGUubGlzdG5hbWU9e307XG4gICAgfTtcbn1dKTtcblxuXG4iLCIvL3NlcnZpY2UgZm9yIGFqYXggY2FsbHMgdG8gY29uc3RhbnQgY29udGFjdFxuXG5hcHAuc2VydmljZSgnY29udGFjdExpc3REYXRhJywgWydDb250YWN0TGlzdERhdGFTZXJ2aWNlJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihDb250YWN0TGlzdERhdGFTZXJ2aWNlLCAkc2NvcGUsICRodHRwKSB7XG5cbiAgICB2YXIgbmV3Q29udGFjdExpc3QgPSBbXTtcbiAgICB2YXIgbGlzdE51bSA9IFwiMTQ5OTUyMzYxMFwiO1xuXG5cbiAgICAkc2NvcGUucG9zdExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9uZXdDb250YWN0TGlzdCcpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBsaXN0TnVtID0gZGF0YS5pZFxuXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhvcHRpb25zKVxuICAgIH07XG5cblxuICAgIHZhciBpbXBvcnREYXRhQXJyYXkgPVtcbiAgICAgICAge1xuICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgIFwidXNlcjFAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiBcIkpvaG5cIixcbiAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6IFwiU21pdGhcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBYXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwiYW55dG93blwiXG4gICAgICAgICAgICB9XVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBcImVtYWlsX2FkZHJlc3Nlc1wiOiBbXG4gICAgICAgICAgICAgICAgXCJ1c2VyMkBleGFtcGxlLmNvbVwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6IFwiSmFuZVwiLFxuICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogXCJTbWl0aHlcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBZXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwic29tZXRvd25cIlxuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIF07XG5cbiAgICAvL3ZhciBjb250YWN0TGlzdE9iamVjdCA9KHtcbiAgICAvLyAgICBcIkltcG9ydCBEYXRhXCIgOiBpbXBvcnREYXRhQXJyYXksXG4gICAgLy8gICAgXCJsaXN0XCI6IFtsaXN0TnVtXSxcbiAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOltcIkVNQUlMXCIsXCJGSVJTVCBOQU1FXCIsIFwiTEFTVCBOQU1FXCIsIFwiQ0lUWVwiLFwiQ09NUEFOWSBOQU1FXCJdfSk7XG5cblxuICAgICRzY29wZS5wb3BMaXN0ID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIGdldENoZWNrZWQoKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3BvcHVsYXRlQ29udGFjdExpc3QuanMnLCBpbXBvcnREYXRhQXJyYXksbGlzdE51bSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpO1xuXG4gICAgfTtcbiAgICAvL2dldCBhbGwgdGhlIGNoZWNrZWQgZWxlbWVudHMgYW5kIHN0dWZmIHRoZW0gaW4gYW4gYXJyYXlcbiAgICBmdW5jdGlvbiBnZXRDaGVja2VkKCl7XG4gICAgICAgICQoXCI6Y2hlY2tlZC50eXBlLWVsZW1lbnRcIikuZWFjaChcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChpZCA9IGNyZWF0ZUxpc3RTZXJ2aWNlLnJlc3VsdHMuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhY3RPYmplY3QgPVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5lbWFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6ICQodGhpcykuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6ICQodGhpcykubGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21wYW55X25hbWVcIjogJCh0aGlzKS5jb21wYW55LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRkcmVzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6ICQodGhpcykuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpbXBvcnREYXRhQXJyYXkucHVzaChjb250YWN0T2JqZWN0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9O1xuXG5cbiAgICByZXR1cm4ge1xuICAgICAgICBuZXdDb250YWN0TGlzdDogbmV3Q29udGFjdExpc3QsXG4gICAgICAgIGxpc3ROdW06IGxpc3ROdW1cbiAgICB9O1xufV0pOyIsImFwcC5jb250cm9sbGVyKCdwb3BMaXN0Q29udHJvbGxlcicsWydjb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0bmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLnBvcHVsYXRlTGlzdCAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlIGxpc3Q6IFwiICsgc2NvcGUubGlzdG5hbWUuaW5wdXQpO1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgIGNvbnRhY3RMaXN0RGF0YS5wb3BMaXN0KCk7XG4gICAgICAgIC8vdmFyIGxpc3RFbmQgPSB7XG4gICAgICAgIC8vICAgIFwibGlzdHNcIjogW2xpc3ROdW1dLFxuICAgICAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOiBbXG4gICAgICAgIC8vICAgIFwiRU1BSUxcIixcbiAgICAgICAgLy8gICAgXCJGSVJTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiTEFTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiQ0lUWVwiLFxuICAgICAgICAvLyAgICBcIkNPTVBBTlkgTkFNRVwiXG4gICAgICAgIC8vXX1cblxuXG4gICAgICAgICRzY29wZS5saXN0bmFtZT17fTtcbiAgICB9O1xufV0pO1xuXG4iLCJcbi8vcmVnaXN0ZXIgY29udHJvbGxlclxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXJDdHJsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZygncmVnaXN0ZXJDb250cm9sbGVyIHN1Ym1pdDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9yZWdpc3RlcicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iLCJhcHAuY29udHJvbGxlcigncmVzZXRDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VkaXQgcGFzc3dvcmQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wdXQoJy9hZG1pbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
