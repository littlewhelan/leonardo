function formatDates(t){return{full:moment(t).format(fullDate),pretty:moment(t).format(prettyDate)}}var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]),prettyDate="MM/DD/YYgYY",fullDate="MM/DD/YYYY h:mm:ss a";app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.companies=o.companies,t.animationsEnabled=!0,t.open=function(o,i){return console.log("corp call",i),a({method:"GET",url:"../corporation",params:{id:i}}).then(function(a){t.company=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.company}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$http","ContactListDataService",function(t,e,n){t.corp={},t.fam={},t.zipCk={},t.ageCk={},t.age={},t.zip={},t.searchListBtn=function(){console.log("this is the radios",t.corp,t.fam,t.zip,t.age,t.zipCk,t.ageCk),console.log(t.zip.data);var e=n.makeDataCall(t.zip.data);e.then(function(e){t.emailList=e.data}),t.corp={},t.fam={},t.zipCk={},t.ageCk={},t.age={},t.zip={}}}]),app.factory("ContactListDataService",["$http",function(t){return{makeDataCall:function(e){return t({method:"GET",url:"../createMailList",params:{search:e}})}}}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){t.family=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.family}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,s(e),l(e),r(e)})},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},l=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},c={getKids:l,getAdults:r,getCompanies:s,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return c}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("newContactListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.createList=function(){console.log("create list: "+e.listName.input),t.postList(e.listName.input),e.listName={}}}]),app.service("newContactListData",["ContactListDataService","$http",function(t,e){var n="1499523610";this.postList=function(){e.post("/newContactList").then(function(t){console.log(t),n=t.id},function(t){console.log(t)}),console.log(options)};var o=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];this.popList=function(){a(),e.post("/populateContactList.js",o,n).success(function(t,e,n,o){console.log(t)}),console.log(options)};var a=function(){$(":checked.type-element").each(function(){if(id==t.results.id){var e={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};o.push(e)}})}}]),app.controller("popListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.populateList=function(){console.log("create list: "+scope.listName.input),t.popList(),e.listName={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImZvcm1hdERhdGVzIiwiZGF0ZSIsImZ1bGwiLCJtb21lbnQiLCJmb3JtYXQiLCJmdWxsRGF0ZSIsInByZXR0eSIsInByZXR0eURhdGUiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsImlzQXV0aGVkIiwiQXV0aG9yaXphdGlvbiIsImdldFRva2VuIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZWplY3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsInNhdmVUb2tlbiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwicGFyYW1zIiwibm90RXhwaXJlZCIsIk1hdGgiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsIiRodHRwIiwiY29tcGFuaWVzIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJvcGVuIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsImNvbXBhbnkiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsImFuaW1hdGlvbiIsInNjb3BlIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwidG9nZ2xlQW5pbWF0aW9uIiwiQ29udGFjdExpc3REYXRhU2VydmljZSIsImNvcnAiLCJmYW0iLCJ6aXBDayIsImFnZUNrIiwiYWdlIiwiemlwIiwic2VhcmNoTGlzdEJ0biIsInByb21pc2UiLCJtYWtlRGF0YUNhbGwiLCJyZXN1bHRzIiwiZW1haWxMaXN0IiwicGFzc2VkRGF0YSIsInNlYXJjaCIsImFkdWx0cyIsImtpZHMiLCJmYW1pbHkiLCIkcm9vdFNjb3BlIiwic3VibWl0IiwicG9zdCIsImZvcm0iLCJ1c2VyIiwiZm9ybUlucHV0Iiwic2VhcmNoQnRuIiwiZ2V0Q29tcGFuaWVzIiwiZ2V0S2lkcyIsImdldEFkdWx0cyIsImFycmF5IiwiZ2V0RWxlbWVudDEiLCJzcGxpY2UiLCJsZW5ndGgiLCJmb3JFYWNoIiwiZWxlbWVudCIsInR5cGUiLCJwdXNoIiwiZ2V0RWxlbWVudDIiLCJnZXRFbGVtZW50MyIsInB1YmxpY0FwaSIsIiRtb2RhbEluc3RhbmNlIiwib2siLCJjbG9zZSIsIml0ZW0iLCJjYW5jZWwiLCJkaXNtaXNzIiwidXNlcm5hbWUiLCJuZXdDb250YWN0TGlzdERhdGEiLCJsaXN0TmFtZSIsImNyZWF0ZUxpc3QiLCJpbnB1dCIsInBvc3RMaXN0IiwibGlzdE51bSIsIm9wdGlvbnMiLCJpbXBvcnREYXRhQXJyYXkiLCJlbWFpbF9hZGRyZXNzZXMiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiY29tcGFueV9uYW1lIiwiYWRkcmVzc2VzIiwiY2l0eSIsInBvcExpc3QiLCJnZXRDaGVja2VkIiwic3VjY2VzcyIsIiQiLCJlYWNoIiwiY29udGFjdE9iamVjdCIsImVtYWlsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJwb3B1bGF0ZUxpc3QiLCJwdXQiXSwibWFwcGluZ3MiOiJBQUtBLFFBQUFBLGFBQUFDLEdBQ0EsT0FDQUMsS0FBQUMsT0FBQUYsR0FBQUcsT0FBQUMsVUFDQUMsT0FBQUgsT0FBQUYsR0FBQUcsT0FBQUcsYUFSQSxHQUFBQyxLQUFBQyxRQUFBQyxPQUFBLE9BQUEsVUFBQSxZQUFBLGlCQUVBSCxXQUFBLGNBQ0FGLFNBQUEsc0JBU0FHLEtBQUFHLFFBQUEsaUJBQ0EsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUNBQyxZQUFBLHNCQUVBRCxLQUFBLFdBQ0FDLFlBQUEsd0JBRUFELEtBQUEsYUFDQUMsWUFBQSx5QkFFQUQsS0FBQSxnQkFDQUMsWUFBQSw2QkFFQUQsS0FBQSxjQUNBQyxZQUFBLDJCQUVBRCxLQUFBLFlBQ0FDLFlBQUEseUJBRUFELEtBQUEsZ0JBQ0FDLFlBQUEsNkJBRUFDLFdBQ0FDLFdBQUEsZUNyQ0FSLElBQUFTLFFBQUEsbUJBQUEsS0FBQSxZQUFBLGNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQSxPQUNBQyxRQUFBLFNBQUFWLEdBS0EsTUFKQUEsR0FBQVcsUUFBQVgsRUFBQVcsWUFDQUYsRUFBQUcsYUFDQVosRUFBQVcsUUFBQUUsY0FBQSxVQUFBSixFQUFBSyxZQUVBZCxHQUVBZSxTQUFBLFNBQUFBLEdBT0EsTUFMQSxPQUFBQSxFQUFBQyxRQUdBUixFQUFBUyxLQUFBLEtBRUFGLEdBQUFSLEVBQUFMLEtBQUFhLElBQ0FHLGNBQUEsU0FBQUgsR0FTQSxNQVJBLE9BQUFBLEVBQUFDLE9BR0FSLEVBQUFTLEtBQUEsS0FHQUUsUUFBQUMsSUFBQUwsRUFBQUMs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ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2xlbycsIFsnbmdSb3V0ZScsICduZ0FuaW1hdGUnLCAndWkuYm9vdHN0cmFwJ10pO1xuXG52YXIgcHJldHR5RGF0ZSA9IFwiTU0vREQvWVlnWVlcIjtcbnZhciBmdWxsRGF0ZSA9IFwiTU0vREQvWVlZWSBoOm1tOnNzIGFcIjtcblxuZnVuY3Rpb24gZm9ybWF0RGF0ZXMgKGRhdGUpIHtcblx0cmV0dXJuIHtcblx0XHRmdWxsOiBtb21lbnQoZGF0ZSkuZm9ybWF0KGZ1bGxEYXRlKSxcblx0XHRwcmV0dHk6IG1vbWVudChkYXRlKS5mb3JtYXQocHJldHR5RGF0ZSlcblx0fTtcbn1cblxuYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgICBmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlci5cbiAgICAgICAgICAgIHdoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvbG9naW4uaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL3NlYXJjaCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvc2VhcmNoLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9yZWdpc3RlcicsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvY29udGFjdExpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2NvbnRhY3RMaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9hZGRmYW1pbHknLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGZhbWlseS5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkY29ycCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvYWRkY29ycC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvY29udGFjdGxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2NvbnRhY3RsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIG90aGVyd2lzZSh7XG4gICAgICAgICAgICAgICAgcmVkaXJlY3RUbzogJy9zZWFyY2gnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cbiIsImFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pIiwiYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpIHtcblxuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSByZXR1cm4ge307XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIC8vY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7IiwiLy9lZGl0IGNvcnBvcmF0aW9uIG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdENvcnBDdHJsJywgWyckc2NvcGUnLCAnJHVpYk1vZGFsJywgJyRsb2cnLCAnUmVzdWx0U2VydmljZScsICckaHR0cCcsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSwgJGh0dHApIHtcbiAgICAvL3NlbmRzIHRoZSBjb21wYW5pZXMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICAgICAkc2NvcGUuY29tcGFuaWVzID0gUmVzdWx0U2VydmljZS5jb21wYW5pZXM7XG5cbiAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuXG4gICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NvcnAgY2FsbCcsIGlkKTtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9jb3Jwb3JhdGlvbicsXG4gICAgICAgICAgICBwYXJhbXM6e2lkOmlkfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnkgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2VkaXRjb3JwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuY29tcGFueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICB9O1xuXG5cbn1dKTtcbiIsIi8vYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUxpc3RTZWFyY2gnLFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnQ29udGFjdExpc3REYXRhU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgQ29udGFjdExpc3REYXRhU2VydmljZSl7XG4vLyAgICAkcm9vdFNjb3BlLmFkZCA9IGZhbHNlO1xuLy8gICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuLy8gICAgJHNjb3BlLnNlYXJjaExpc3RCdG4gPSBmdW5jdGlvbiAoKSB7XG4vL1x0XHQvL2NvbnNvbGUubG9nKFwibGlzdCB0eXBlXCIsICRzY29wZS5saXN0VHlwZSk7XG4vL1x0XHR2YXIgJHR5cGUgPSAkKCcjbGlzdFR5cGUgOmNoZWNrZWQnKTtcbi8vXHRcdC8vIGNoZWNrIGlmIGl0J3MgYWdlIG9yIHppcCwgcmVxdWlyaW5nIGFkZGl0aW9uYWwgaW5wdXRcbi8vXHRcdGlmKCR0eXBlLmhhc0NsYXNzKCdqcy1leHRyYScpKSB7XG4vL1x0XHRcdGNvbnNvbGUubG9nKFwibmVlZHMgZXh0cmEgaW5mb1wiKTtcbi8vXHRcdFx0dmFyIHZhbHVlID0gJHR5cGUubmV4dCgpLm5leHQoKS52YWwoKTtcbi8vXHRcdH1cbi8vXHRcdHZhciBpZCA9ICR0eXBlLmF0dHIoJ2lkJyk7XG4vL1x0XHQvL3ZhciAkdHlwZXMgPSAkKCcjbGlzdFR5cGUnKTtcbi8vXHRcdC8vaWYoJHR5cGVzLmZpbmQoJ2lucHV0OmNoZWNrZWQnKS5oYXNDbGFzcygnanMtZXh0cmEnKSkge1xuLy9cdFx0Ly9cdHZhciB2YWx1ZSA9ICR0eXBlcy5maW5kKCdpbnB1dDpjaGVja2VkJykuaGFzQ2xhc3MoJ2pzLWV4dHJhJykuc2libGluZ3MoJy5qcy12YWx1ZScpLnZhbCgpO1xuLy9cdFx0Ly99XG4vL1x0XHQvL3ZhciB0eXBlID0gJHR5cGVzLmZpbmQoJ2lucHV0OmNoZWNrZWQnKS5oYXNDbGFzcygnanMtZXh0cmEnKS5hdHRyKCdpZCcpO1xuLy9cdFx0Y29uc29sZS5sb2coXCJ0eXBlIFwiLCBpZCwgXCIgdmFsdWUgXCIsIHZhbHVlKTtcbi8vXHRcdC8vY29uc29sZS5sb2coXCJ2YWx1ZVwiLCB2YWx1ZSk7XG4vLyAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuLy8gICAgICAgIC8vQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmxpc3RGb3JtLmRhdGEpO1xuLy8gICAgICAgIC8vZW1wdHkgdGhlIHNlYXJjaCBib3hcbi8vICAgICAgICAkc2NvcGUubGlzdEZvcm09e307XG4vLyAgICB9O1xuLy99XSk7XG5hcHAuY29udHJvbGxlcignY3JlYXRlTGlzdFNlYXJjaCcsWyckc2NvcGUnLCckaHR0cCcsICdDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgQ29udGFjdExpc3REYXRhU2VydmljZSkge1xuXHQkc2NvcGUuY29ycCA9e307XG5cdCRzY29wZS5mYW0gPXt9O1xuXHQkc2NvcGUuemlwQ2sgPXt9O1xuXHQkc2NvcGUuYWdlQ2sgPXt9O1xuXHQkc2NvcGUuYWdlID17fTtcblx0JHNjb3BlLnppcD17fTtcblxuXHQkc2NvcGUuc2VhcmNoTGlzdEJ0biA9IGZ1bmN0aW9uICgpIHtcblx0XHQvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG5cdFx0Y29uc29sZS5sb2coJ3RoaXMgaXMgdGhlIHJhZGlvcycgLCAkc2NvcGUuY29ycCwkc2NvcGUuZmFtLCRzY29wZS56aXAsJHNjb3BlLmFnZSwgJHNjb3BlLnppcENrLCAkc2NvcGUuYWdlQ2spO1xuXHRcdGNvbnNvbGUubG9nKCRzY29wZS56aXAuZGF0YSk7XG5cblxuXG5cdFx0Ly9zZWFyY2ggYnkgemlwIGlmIHppcENLIGlzIHRydWVcblxuXHRcdHZhciBwcm9taXNlID0gQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLnppcC5kYXRhKTtcblxuXHRcdHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuXHRcdFx0JHNjb3BlLmVtYWlsTGlzdCA9IHJlc3VsdHMuZGF0YTtcblx0XHR9KTtcblxuXHRcdC8vLy9zZWFyY2ggYnkgYWdlIGlmIGFnZUNrIGlzIHRydWVcblx0XHQvL3ZhciBwcm9taXNlID0gQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmFnZS5kYXRhKTtcblx0XHQvL3Byb21pc2UudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuXHRcdC8vXHQkc2NvcGUuZW1haWxMaXN0ID0gcmVzdWx0cy5kYXRhO1xuXHRcdC8vfSk7XG5cblx0XHQvLy8vZ2V0IGFsbCBmYW1pbGllcyBpZiBmYW0gaXMgdHJ1ZVxuXHRcdC8vdmFyIHByb21pc2UgPSBDb250YWN0TGlzdERhdGFTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgpO1xuXHRcdC8vcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cdFx0Ly9cdCRzY29wZS5lbWFpbExpc3QgPSByZXN1bHRzLmRhdGE7XG5cdFx0Ly9cdGNvbnNvbGUubG9nKHJlc3VsdHMuZGF0YSk7XG5cdFx0Ly99KTtcblx0XHQvL1xuXHRcdC8vLy9nZXQgYWxsIGNvcnAgaWYgY29ycCBpcyB0cnVlXG5cdFx0Ly9Db250YWN0TGlzdERhdGFTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgpO1xuXHRcdC8vXG5cblx0XHQvL2VtcHR5IHRoZSBzZWFyY2ggYm94XG5cdFx0JHNjb3BlLmNvcnAgPXt9O1xuXHRcdCRzY29wZS5mYW0gPXt9O1xuXHRcdCRzY29wZS56aXBDayA9e307XG5cdFx0JHNjb3BlLmFnZUNrID17fTtcblx0XHQkc2NvcGUuYWdlID17fTtcblx0XHQkc2NvcGUuemlwPXt9O1xuXHR9O1xuXG59XSk7IiwiLy9hcHAuZmFjdG9yeSgnQ29udGFjdExpc3REYXRhU2VydmljZScsWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG4vL1xuLy8gICAgdmFyIHJlc3VsdHMgPSBbXTtcbi8vICAgIHZhciBhbGxDb21wYW5pZXMgPSBbXTtcbi8vICAgIHZhciBhbGxLaWRzID0gW107XG4vLyAgICB2YXIgYWxsQWR1bHRzID0gW107XG4vL1xuLy8gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uIChwYXNzZWREYXRhKSB7XG4vLyAgICAgICAgcmV0dXJuICRodHRwKHtcbi8vICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbi8vICAgICAgICAgICAgVVJMOiAnL2NyZWF0ZU1haWxMaXN0Jyxcbi8vICAgICAgICAgICAgcGFyYW1zOiB7c2VhcmNoOiBwYXNzZWREYXRhfVxuLy8gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4vLyAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuLy8gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4vLyAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbi8vICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbi8vICAgICAgICB9KTtcbi8vICAgIH07XG4vL1xuLy9cbi8vICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbi8vICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbi8vICAgICAgICAgICAgYWxsQWR1bHRzLnNwbGljZSgwLCBhbGxBZHVsdHMubGVuZ3RoKTtcbi8vICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuLy8gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnYWR1bHQnKVxuLy8gICAgICAgICAgICAgICAgICAgIGFsbEFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuLy8gICAgICAgICAgICB9KVxuLy8gICAgICAgIH07XG4vLyAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuLy8gICAgICAgIHJldHVybiBhbGxBZHVsdHNcbi8vICAgIH07XG4vL1xuLy8gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uIChhcnJheSkge1xuLy8gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuLy8gICAgICAgICAgICBhbGxDb21wYW5pZXMuc3BsaWNlKDAsIGFsbENvbXBhbmllcy5sZW5ndGgpO1xuLy8gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4vLyAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjb21wYW55Jylcbi8vICAgICAgICAgICAgICAgICAgICBhbGxDb21wYW5pZXMucHVzaChlbGVtZW50KTtcbi8vICAgICAgICAgICAgfSlcbi8vICAgICAgICB9O1xuLy8gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbi8vICAgICAgICByZXR1cm4gYWxsQ29tcGFuaWVzXG4vLyAgICB9O1xuLy9cbi8vICAgIHZhciBnZXRLaWRzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4vLyAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4vLyAgICAgICAgICAgIGFsbEtpZHMuc3BsaWNlKDAsIGFsbEtpZHMubGVuZ3RoKTtcbi8vICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuLy8gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuLy8gICAgICAgICAgICAgICAgICAgIGtpZHMucHVzaChlbGVtZW50KTtcbi8vICAgICAgICAgICAgfSlcbi8vICAgICAgICB9O1xuLy8gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbi8vICAgICAgICByZXR1cm4gYWxsS2lkc1xuLy8gICAgfTtcbi8vXG4vLyAgICB2YXIgZGF0YUFwaSA9IHtcbi8vICAgICAgICBtYWtlRGF0YUNhbGw6IG1ha2VEYXRhQ2FsbCxcbi8vICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbi8vICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuLy8gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuLy8gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4vLyAgICAgICAgYWxsS2lkczogYWxsS2lkcyxcbi8vICAgICAgICBhbGxBZHVsdHM6IGFsbEFkdWx0cyxcbi8vICAgICAgICBhbGxDb21wYW5pZXM6IGFsbENvbXBhbmllc1xuLy8gICAgfTtcbi8vXG4vLyAgICByZXR1cm4gZGF0YUFwaTtcbi8vXG4vL31dKTtcblxuYXBwLmZhY3RvcnkoJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBbJyRodHRwJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cblx0cmV0dXJuIHtcblx0XHRtYWtlRGF0YUNhbGw6IGZ1bmN0aW9uIChwYXNzZWREYXRhKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAoe1xuXHRcdFx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdFx0XHR1cmw6ICcuLi9jcmVhdGVNYWlsTGlzdCcsXG5cdFx0XHRcdHBhcmFtczoge3NlYXJjaDogcGFzc2VkRGF0YX1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG59XSk7IiwiLy9lZGl0IGZhbWlseSBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRGYW1pbHlDdHJsJyxbJyRzY29wZScsICckdWliTW9kYWwnLCAnJGxvZycsJ1Jlc3VsdFNlcnZpY2UnLCAnJGh0dHAnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UsICRodHRwKSB7XG5cbiAgICAvL3NlbmRzIHRoZSBhZHVsdHMgYW5kIGtpZHMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICAgICAkc2NvcGUuYWR1bHRzID0gUmVzdWx0U2VydmljZS5hZHVsdHM7XG4gICAgICAgICRzY29wZS5raWRzID0gUmVzdWx0U2VydmljZS5raWRzO1xuXG4gICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmYW1pbHkgY2FsbCcsaWQpO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHVybDogJy4uL2ZhbWlseScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOntpZDppZH1cbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgXHRcdFx0JHNjb3BlLmZhbWlseSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGZhbWlseS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICBcdFx0XHRcdHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5mYW1pbHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZCA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS50b2dnbGVBbmltYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICAgICAgICAgIH07XG5cblxufV0pOyIsIi8vY29udHJvbGxlcnMgZm9yIGxvZ2luXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL3NlYXJjaFwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XSk7XG4iLCJcbi8vVGhpcyBzaG91bGQgZ2V0IHRoZSBzZWFyY2ggaXRlbVxuYXBwLmNvbnRyb2xsZXIoJ3NlYXJjaEZ1bmN0aW9uJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnUmVzdWx0U2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCBSZXN1bHRTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcblxuICAgICRzY29wZS5zZWFyY2hCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICBSZXN1bHRTZXJ2aWNlLm1ha2VEYXRhQ2FsbCgkc2NvcGUuZm9ybUlucHV0LmRhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgaW5wdXQgdGV4dCcsICRzY29wZS5mb3JtSW5wdXQpO1xuICAgICAgICAvL2VtcHR5cyB0aGUgc2VhcmNoIGJveFxuICAgICAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuICAgIH07XG5cbn1dKTtcbiIsIi8vVGhpcyBzZXJ2aWNlIHNob3VsZCBwYXNzIGRhdGEgYmV0d2VlbiBjb250cm9sbGVyc1xuYXBwLmZhY3RvcnkoJ1Jlc3VsdFNlcnZpY2UnLCBbJyRodHRwJyxmdW5jdGlvbigkaHR0cCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIGFkdWx0cyA9IFtdO1xuICAgIHZhciBjb21wYW5pZXMgPSBbXTtcbiAgICB2YXIga2lkcyA9IFtdO1xuXG4gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uKHBhc3NlZERhdGEpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9zZWFyY2gnLFxuICAgICAgICAgICAgcGFyYW1zOntzZWFyY2g6cGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEFkdWx0cyhyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQxID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgIGNvbXBhbmllcy5zcGxpY2UoMCxjb21wYW5pZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY29tcGFueScpXG4gICAgICAgICAgICAgICAgY29tcGFuaWVzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIGdldEVsZW1lbnQxKGFycmF5KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgZ2V0RWxlbWVudDEnLGNvbXBhbmllcyk7XG4gICAgICAgIHJldHVybiBjb21wYW5pZXNcbiAgICB9O1xuXG4gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MiA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBhZHVsdHMuc3BsaWNlKDAsYWR1bHRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2FkdWx0JylcbiAgICAgICAgICAgICAgICAgICAgYWR1bHRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MihhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGluIGdldEVsZW1lbnQyJywgYWR1bHRzKTtcbiAgICAgICAgcmV0dXJuIGFkdWx0c1xuICAgIH07XG5cbiAgICB2YXIgZ2V0S2lkcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBraWRzLnNwbGljZSgwLGtpZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuICAgICAgICAgICAgICAgICAgICBraWRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnRzMycsIGtpZHMpO1xuICAgICAgICByZXR1cm4ga2lkc1xuICAgIH07XG5cbiAgICAvL3B1YmxpY1xuICAgIHZhciBwdWJsaWNBcGkgPSB7XG4gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuICAgICAgICBnZXRDb21wYW5pZXM6IGdldENvbXBhbmllcyxcbiAgICAgICAgbWFrZURhdGFDYWxsOiBtYWtlRGF0YUNhbGwsXG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIGNvbXBhbmllczogY29tcGFuaWVzLFxuICAgICAgICBhZHVsdHM6IGFkdWx0cyxcbiAgICAgICAga2lkczoga2lkc1xuICAgIH07XG4gICAgcmV0dXJuIHB1YmxpY0FwaTtcbn1dKTsiLCIvLyBQbGVhc2Ugbm90ZSB0aGF0ICRtb2RhbEluc3RhbmNlIHJlcHJlc2VudHMgYSBtb2RhbCB3aW5kb3cgKGluc3RhbmNlKSBkZXBlbmRlbmN5LlxuLy8gSXQgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSAkdWliTW9kYWwgc2VydmljZSB1c2VkIGFib3ZlLlxuXG4vL25lZWRlZCBmb3IgbW9kYWw/PyBwcmV0dHkgc3VyZVxuYXBwLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJyxbJyRzY29wZScsJyRtb2RhbEluc3RhbmNlJywgZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UpIHtcblxuICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJHNjb3BlLnNlbGVjdGVkLml0ZW0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICB9O1xufV0pOyIsImFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsJyRzY29wZScsJyRyb290U2NvcGUnLCckbG9jYXRpb24nLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2hvbWUnKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgIH1cbn1dKTtcbiIsIi8vIEFqYXggZm9yIGNyZWF0aW5nIHRoZSBjb250YWN0IGxpc3QgaW4gY29uc3RhbnQgY29udGFjdFxuYXBwLmNvbnRyb2xsZXIoJ25ld0NvbnRhY3RMaXN0Q29udHJvbGxlcicsWyduZXdDb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKG5ld0NvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0TmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLmNyZWF0ZUxpc3QgID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZSBsaXN0OiBcIiArICRzY29wZS5saXN0TmFtZS5pbnB1dCk7XG4gICAgICAgIC8vcGFzc2VzIGxpc3QgbmFtZSBzZXJ2aWNlXG4gICAgICAgIG5ld0NvbnRhY3RMaXN0RGF0YS5wb3N0TGlzdCgkc2NvcGUubGlzdE5hbWUuaW5wdXQpO1xuXG4gICAgICAgICRzY29wZS5saXN0TmFtZT17fTtcbiAgICB9O1xufV0pO1xuXG5cbiIsIi8vc2VydmljZSBmb3IgYWpheCBjYWxscyB0byBjb25zdGFudCBjb250YWN0XG5cbmFwcC5zZXJ2aWNlKCduZXdDb250YWN0TGlzdERhdGEnLCBbJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCAnJGh0dHAnLFxuICAgIGZ1bmN0aW9uIChDb250YWN0TGlzdERhdGFTZXJ2aWNlLCAkaHR0cCkge1xuXG4gICAgdmFyIG5ld0NvbnRhY3RMaXN0ID0gW107XG4gICAgdmFyIGxpc3ROdW0gPSBcIjE0OTk1MjM2MTBcIjtcblxuICAgIHRoaXMucG9zdExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9uZXdDb250YWN0TGlzdCcpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgbGlzdE51bSA9IGRhdGEuaWRcblxuICAgICAgICB9LCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOyAvL2Vycm9yXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhvcHRpb25zKVxuICAgIH07XG5cbiAgICB2YXIgaW1wb3J0RGF0YUFycmF5ID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICBcImVtYWlsX2FkZHJlc3Nlc1wiOiBbXG4gICAgICAgICAgICAgICAgXCJ1c2VyMUBleGFtcGxlLmNvbVwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6IFwiSm9oblwiLFxuICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogXCJTbWl0aFwiLFxuICAgICAgICAgICAgXCJjb21wYW55X25hbWVcIjogXCJDb21wYW55IFhcIixcbiAgICAgICAgICAgIFwiYWRkcmVzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgY2l0eTogXCJhbnl0b3duXCJcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIFwiZW1haWxfYWRkcmVzc2VzXCI6IFtcbiAgICAgICAgICAgICAgICBcInVzZXIyQGV4YW1wbGUuY29tXCJcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcImZpcnN0X25hbWVcIjogXCJKYW5lXCIsXG4gICAgICAgICAgICBcImxhc3RfbmFtZVwiOiBcIlNtaXRoeVwiLFxuICAgICAgICAgICAgXCJjb21wYW55X25hbWVcIjogXCJDb21wYW55IFlcIixcbiAgICAgICAgICAgIFwiYWRkcmVzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgY2l0eTogXCJzb21ldG93blwiXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgXTtcblxuICAgIC8vdmFyIGNvbnRhY3RMaXN0T2JqZWN0ID0oe1xuICAgIC8vICAgIFwiSW1wb3J0IERhdGFcIiA6IGltcG9ydERhdGFBcnJheSxcbiAgICAvLyAgICBcImxpc3RcIjogW2xpc3ROdW1dLFxuICAgIC8vICAgIFwiY29sdW1uX25hbWVzXCI6W1wiRU1BSUxcIixcIkZJUlNUIE5BTUVcIiwgXCJMQVNUIE5BTUVcIiwgXCJDSVRZXCIsXCJDT01QQU5ZIE5BTUVcIl19KTtcblxuXG4gICAgdGhpcy5wb3BMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBnZXRDaGVja2VkKCk7XG4gICAgICAgICRodHRwLnBvc3QoJy9wb3B1bGF0ZUNvbnRhY3RMaXN0LmpzJywgaW1wb3J0RGF0YUFycmF5LCBsaXN0TnVtKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhvcHRpb25zKTtcblxuICAgIH07XG5cbiAgICAvL2dldCBhbGwgdGhlIGNoZWNrZWQgZWxlbWVudHMgYW5kIHN0dWZmIHRoZW0gaW4gYW4gYXJyYXlcbiAgICB2YXIgZ2V0Q2hlY2tlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoXCI6Y2hlY2tlZC50eXBlLWVsZW1lbnRcIikuZWFjaChcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PSBDb250YWN0TGlzdERhdGFTZXJ2aWNlLnJlc3VsdHMuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWN0T2JqZWN0ID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsX2FkZHJlc3Nlc1wiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZW1haWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiAkKHRoaXMpLmZpcnN0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhc3RfbmFtZVwiOiAkKHRoaXMpLmxhc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6ICQodGhpcykuY29tcGFueSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXR5OiAkKHRoaXMpLmNpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydERhdGFBcnJheS5wdXNoKGNvbnRhY3RPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG59XSk7IiwiYXBwLmNvbnRyb2xsZXIoJ3BvcExpc3RDb250cm9sbGVyJyxbJ25ld0NvbnRhY3RMaXN0RGF0YScsJyRzY29wZScsJyRodHRwJywgZnVuY3Rpb24obmV3Q29udGFjdExpc3REYXRhLCAkc2NvcGUsICRodHRwKSB7XG4gICAgLy9kYXRhIHRvIGNyZWF0ZSBhIG5ldyBjb250YWN0IGxpc3RcblxuXG4gICAgJHNjb3BlLmxpc3ROYW1lID0ge307XG5cbiAgICAkc2NvcGUucG9wdWxhdGVMaXN0ICA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGUgbGlzdDogXCIgKyBzY29wZS5saXN0TmFtZS5pbnB1dCk7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICAgbmV3Q29udGFjdExpc3REYXRhLnBvcExpc3QoKTtcbiAgICAgICAgLy92YXIgbGlzdEVuZCA9IHtcbiAgICAgICAgLy8gICAgXCJsaXN0c1wiOiBbbGlzdE51bV0sXG4gICAgICAgIC8vICAgIFwiY29sdW1uX25hbWVzXCI6IFtcbiAgICAgICAgLy8gICAgXCJFTUFJTFwiLFxuICAgICAgICAvLyAgICBcIkZJUlNUIE5BTUVcIixcbiAgICAgICAgLy8gICAgXCJMQVNUIE5BTUVcIixcbiAgICAgICAgLy8gICAgXCJDSVRZXCIsXG4gICAgICAgIC8vICAgIFwiQ09NUEFOWSBOQU1FXCJcbiAgICAgICAgLy9dfVxuXG5cbiAgICAgICAgJHNjb3BlLmxpc3ROYW1lPXt9O1xuICAgIH07XG59XSk7XG5cbiIsIlxuLy9yZWdpc3RlciBjb250cm9sbGVyXG5hcHAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZWdpc3RlckN0cmxcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZWdpc3RlckNvbnRyb2xsZXIgc3VibWl0OicsICRzY29wZS5mb3JtKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3JlZ2lzdGVyJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvaW5kZXhcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdyZXNldEN0cmwnLCBbICckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnZWRpdCBwYXNzd29yZDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnB1dCgnL2FkbWluJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvaW5kZXhcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
