var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.service("contactListData",function(){var t=[],e=0;return{newContactList:t,listNum:e}}),app.controller("newContactListController",["contactListData","$scope","$http",function(t,e,n){e.listname={},e.config={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9","Content-Type":"application/json"}},e.postList=function(){e.listReq={name:e.listname.input,status:"ACTIVE"},console.log("posting list . . . "),console.log(e.listReq),console.log(e.config),n.post("https://api.constantcontact.com/v2/lists?api_key=yg5p2qf549qacmbqayk5rn23",e.listReq,e.config).then(function(e){console.log("res"+e),e.id=t.listNum}),error(function(t,e,n,o){})}}]),app.controller("contactListController",["contactListData","$scope","$http",function(t,e,n){var o=[],a=JSON.stringify("list: ["+t.listNum+'],column_names:["EMAIL","FIRST NAME", "LAST NAME", "CITY","COMPANY NAME"]');e.contactChecked=function(t){e.checked.push([t])},e.sendPost=function(){var e=$.param({json:JSON.stringify({importData:o+", "+a})}),i={headers:{Authorization:"Bearer ef5d5df2-a808-4c70-a5d9-eb71163cbeb9"}};n.post("https://api.constantcontact.com/v2/activities/addcontacts?api_key=u8w59ztxe3294adczfvn7k9e",e,i).success(function(e,n,o,a){res.id=t.listNum}).error(function(t,e,n,o){})}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService",function(t,e,n,o){t.companies=o.companies,t.animationsEnabled=!0,t.openCorp=function(o){var a=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,resolve:{items:function(){return t.items}}});a.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","ContactListDataService",function(t,e){t.listForm={},t.searchListBtn=function(){e.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(t){return http({method:"GET",URL:"../createMailList",params:{search:t}}).then(function(t){e=t.data,c(e),r(e),s(e)})},r=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},c=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},l={makeDataCall:i,getCompanies:c,getKids:s,getAdults:r,results:e,allKids:o,allAdults:a,allCompanies:n};return l}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService",function(t,e,n,o){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o){var a=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,resolve:{items:function(){return t.items}}});a.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,r(e),s(e),c(e)})},r=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},c=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},s=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},l={getKids:s,getAdults:c,getCompanies:r,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return l}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsInJlZ2lzdGVyQ29udHJvbGxlci5qcyIsInJlc2V0Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic2VydmljZSIsIm5ld0NvbnRhY3RMaXN0IiwibGlzdE51bSIsImNvbnRyb2xsZXIiLCJjb250YWN0TGlzdERhdGEiLCIkc2NvcGUiLCIkaHR0cCIsImxpc3RuYW1lIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJDb250ZW50LVR5cGUiLCJwb3N0TGlzdCIsImxpc3RSZXEiLCJuYW1lIiwiaW5wdXQiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwicG9zdCIsInRoZW4iLCJyZXMiLCJpZCIsImVycm9yIiwiZGF0YSIsImltcG9ydERhdGFBcnJheSIsImxpc3RFbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29udGFjdENoZWNrZWQiLCJjaGVja2VkIiwicHVzaCIsInNlbmRQb3N0IiwiJCIsInBhcmFtIiwianNvbiIsImltcG9ydERhdGEiLCJzdWNjZXNzIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaXNBdXRoZWQiLCJnZXRUb2tlbiIsInJlc3BvbnNlIiwicGF0aCIsInJlc3BvbnNlRXJyb3IiLCJyZWplY3QiLCIkd2luZG93IiwidGhpcyIsInBhcnNlSnd0IiwidG9rZW4iLCJiYXNlNjRVcmwiLCJzcGxpdCIsImJhc2U2NCIsInJlcGxhY2UiLCJwYXJzZSIsImF0b2IiLCJzYXZlVG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJNYXRoIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImxvZ291dCIsImdldFVzZXIiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsImNvbXBhbmllcyIsImFuaW1hdGlvbnNFbmFibGVkIiwib3BlbkNvcnAiLCJzaXplIiwibW9kYWxJbnN0YW5jZSIsIm9wZW4iLCJhbmltYXRpb24iLCJyZXNvbHZlIiwiaXRlbXMiLCJyZXN1bHQiLCJzZWxlY3RlZEl0ZW0iLCJzZWxlY3RlZCIsImluZm8iLCJ0b2dnbGVBbmltYXRpb24iLCJDb250YWN0TGlzdERhdGFTZXJ2aWNlIiwibGlzdEZvcm0iLCJzZWFyY2hMaXN0QnRuIiwibWFrZURhdGFDYWxsIiwicmVzdWx0cyIsImFsbENvbXBhbmllcyIsImFsbEtpZHMiLCJhbGxBZHVsdHMiLCJwYXNzZWREYXRhIiwiaHR0cCIsIm1ldGhvZCIsIlVSTCIsInNlYXJjaCIsImdldENvbXBhbmllcyIsImdldEFkdWx0cyIsImdldEtpZHMiLCJhcnJheSIsImdldEVsZW1lbnQzIiwic3BsaWNlIiwibGVuZ3RoIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0eXBlIiwia2lkcyIsImRhdGFBcGkiLCJhZHVsdHMiLCIkcm9vdFNjb3BlIiwic3VibWl0IiwiZm9ybSIsInVzZXIiLCJmb3JtSW5wdXQiLCJzZWFyY2hCdG4iLCJ1cmwiLCJnZXRFbGVtZW50MSIsImdldEVsZW1lbnQyIiwicHVibGljQXBpIiwiJG1vZGFsSW5zdGFuY2UiLCJvayIsImNsb3NlIiwiaXRlbSIsImNhbmNlbCIsImRpc21pc3MiLCJ1c2VybmFtZSIsInB1dCJdLCJtYXBwaW5n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dEQsSUFBQVksV0FBQSxnQkFBQSxTQUFBLFFBQUEsWUFBQSxTQUFBRSxFQUFBQyxFQUFBaUMsR0FDQWxDLEVBQUE2RyxPQUFBLFdBQ0FsRyxRQUFBQyxJQUFBLGdCQUNBRCxRQUFBQyxJQUFBLDZCQUFBWixFQUFBOEcsTUFDQTdHLEVBQUFZLEtBQUEsWUFBQWIsRUFBQThHLE1BQ0FoRyxLQUFBLFNBQUF5QixHQUNBNUIsUUFBQUMsSUFBQTJCLEdBQ0FMLEVBQUFNLEtBQUEsZ0JDVEF0RCxJQUFBWSxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUUsRUFBQUMsRUFBQWlDLEdBQ0FsQyxFQUFBNkcsT0FBQSxXQUNBbEcsUUFBQUMsSUFBQSxpQkFBQVosRUFBQThHLE1BQ0E3RyxFQUFBNEgsSUFBQSxTQUFBN0gsRUFBQThHLE1BQ0FoRyxLQUFBLFNBQUF5QixHQUNBNUIsUUFBQUMsSUFBQTJCLEdBQ0FMLEVBQUFNLEtBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdsZW8nLCBbJ25nUm91dGUnLCAnbmdBbmltYXRlJywgJ3VpLmJvb3RzdHJhcCddKTtcblxuYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxcbiAgICBmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlci5cbiAgICAgICAgICAgIHdoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvbG9naW4uaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL3NlYXJjaCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvc2VhcmNoLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9yZWdpc3RlcicsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRpYy9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvY29udGFjdExpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2NvbnRhY3RMaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9hZGRmYW1pbHknLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGZhbWlseS5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkY29ycCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvYWRkY29ycC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvY29udGFjdGxpc3QnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2NvbnRhY3RsaXN0Lmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIG90aGVyd2lzZSh7XG4gICAgICAgICAgICAgICAgcmVkaXJlY3RUbzogJy9zZWFyY2gnXG4gICAgICAgICAgICB9KTtcbiAgICB9XSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4vL2R1bW15IGRhdGEgZWRpdCBmYW1pbHkgYWRkaXRpb25hbCBtZW1iZXJzXG4vL2FwcC5jb250cm9sbGVyKCdhZGRpdGlvbmFsQ3RybCcsIFsgJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuLy8gICAgJHNjb3BlLmFkZGl0aW9uYWwgPSB7XG4vLyAgICAgICAgZk5hbWU6ICdHcmVnJyxcbi8vICAgICAgICBsTmFtZTogJ0JyYWR5Jyxcbi8vICAgICAgICBiRGF5OiAnMTk4My0wMy0wNScsXG4vLyAgICAgICAgbm90ZXM6ICdUaGlzIGFyZWEgaXMgcmVzZXJ2ZWQgZm9yIGluZm9ybWF0aW9uIGFzIG5lZWRlZCdcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuc2V0ID0gZnVuY3Rpb24oZWRpdF9pbmZvKSB7XG4vLyAgICAgICAgdGhpcy5jb250YWN0LmZOYW1lID0gZWRpdF9pbmZvLFxuLy8gICAgICAgIHRoaXMuY29udGFjdC5sTmFtZSA9IGVkaXRfaW5mbyxcbi8vICAgICAgICB0aGlzLmNvbnRhY3QuYkRheSA9IGVkaXRfaW5mbyxcbi8vICAgICAgICB0aGlzLmNvbnRhY3Qubm90ZXMgPSBlZGl0X2luZm9cbi8vICAgIH07XG4vL31dKTtcblxuLy9kdW1teSBkYXRhIGZvciBmYW1pbHkgY29udGFjdCBpbmZvcm1hdGlvblxuLy9hcHAuY29udHJvbGxlcignY29udGFjdEN0cmwnLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgIC8vJHNjb3BlLmNvbnRhY3QgPSB7XG4gICAgLy8gICAgZk5hbWU6ICdNaWtlJyxcbiAgICAvLyAgICAgcmVzZXJ2ZWQgZm9yIGluZm9ybWF0aW9uIGFzIG5lZWRlZCdcbiAgICAvL307XG4gICAgLy8kc2NvcGUuc2V0ID0gZnVuY3Rpb24oZWRpdF9pbmZvKSB7XG4gICAgLy8gICAgdGhpcy5jb250YWN0LmZOYW1lID0gZWRpdF9pbmZvLFxuICAgIC8vICAgIGl0X2luZm9cbiAgICAvL307XG5cbi8vfV0pO1xuXG4vL2R1bW15IGRhdGEgZm9yIGZhbWlseSBlbWVyZ2VuY3kgY29udGFjdCBpbmZvcm1hdGlvblxuLy9hcHAuY29udHJvbGxlcignZW1lcmdlbmN5Q3RybCcsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgIC8vJHNjb3BlLmVtZXJnZW5jeSA9IHtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgZk5hbWU6ICdNaWtlJyxcblxuICAgIC8vICAgICAgICAgICAgICAgICAgICB9O1xuICAgIC8vJHNjb3BlLnNldCA9IGZ1bmN0aW9uKGVkaXRfaW5mbykge1xuICAgIC8vICAgIHRoaXMuZW1lcmdlbmN5LmZOYW1lID0gZWRpdF9pbmZvLFxuXG4gICAgLy99O1xuLy99XSk7XG5cbi8vY29udHJvbGxlciBmb3IgaGFuZGxpbmcgdGhlIHNlYXJjaCByZXN1bHRzXG4vL2FwcC5jb250cm9sbGVyKCdTZWFyY2hSZXN1bHRDb250cm9sbGVyJyxbJ1NoYXJlZERhdGFTZXJ2aWNlJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbignU2hhcmVkRGF0YVNlcnZpY2UnLCRzY29wZSwgJGh0dHApXG4vL3tcbi8vXG4vL31dKVxuXG5hcHAuc2VydmljZSgnY29udGFjdExpc3REYXRhJywgZnVuY3Rpb24oKXtcbiAgICB2YXIgaW5jbHVkZWRFbWFpbHMgPSBbXTtcbiAgICB2YXIgbmV3Q29udGFjdExpc3QgPSBbXTtcbiAgICB2YXIgbGlzdE51bSA9IDA7XG5cblxuICAgIHJldHVybiB7XG4gICAgICAgIG5ld0NvbnRhY3RMaXN0OiBuZXdDb250YWN0TGlzdCxcbiAgICAgICAgbGlzdE51bTogbGlzdE51bVxuICAgIH07XG59KTtcblxuXG5cbmFwcC5jb250cm9sbGVyKCduZXdDb250YWN0TGlzdENvbnRyb2xsZXInLFsnY29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2RhdGEgdG8gY3JlYXRlIGEgbmV3IGNvbnRhY3QgbGlzdFxuICAgICRzY29wZS5saXN0bmFtZSA9IHt9O1xuXG5cbiAgICAvL2hlYWRlcnNcbiAgICAkc2NvcGUuY29uZmlnID0ge1xuICAgICAgICBoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyIGVmNWQ1ZGYyLWE4MDgtNGM3MC1hNWQ5LWViNzExNjNjYmViOScsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvL2Z1bmN0aW9uIHRvIGNyZWF0cyB0aGUgbmV3IGNvbnRhY3QgbGlzdFxuICAgICRzY29wZS5wb3N0TGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmxpc3RSZXEgPSB7XCJuYW1lXCI6ICRzY29wZS5saXN0bmFtZS5pbnB1dCwgXCJzdGF0dXNcIjogXCJBQ1RJVkVcIn07XG4gICAgICAgIGNvbnNvbGUubG9nKCdwb3N0aW5nIGxpc3QgLiAuIC4gJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5saXN0UmVxKTtcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmNvbmZpZyk7XG4gICAgICAgICRodHRwLnBvc3QoJ2h0dHBzOi8vYXBpLmNvbnN0YW50Y29udGFjdC5jb20vdjIvbGlzdHM/YXBpX2tleT15ZzVwMnFmNTQ5cWFjbWJxYXlrNXJuMjMnLCAkc2NvcGUubGlzdFJlcSwgJHNjb3BlLmNvbmZpZykuXG4gICAgICAgICAgICB0aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc1wiICsgcmVzKTtcblxuICAgICAgICAgICAgICAgIHJlcy5pZCA9IGNvbnRhY3RMaXN0RGF0YS5saXN0TnVtO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIC8vIGxvZyBlcnJvclxuICAgICAgICAgICAgfSk7XG5cbiAgICB9O1xuXG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdjb250YWN0TGlzdENvbnRyb2xsZXInLFsnY29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICB2YXIgaW1wb3J0RGF0YUFycmF5ID0gW107XG4gICAgdmFyIGxpc3RFbmQgPSBKU09OLnN0cmluZ2lmeShcImxpc3Q6IFtcIisgY29udGFjdExpc3REYXRhLmxpc3ROdW0gKyBcIl0sY29sdW1uX25hbWVzOltcXFwiRU1BSUxcXFwiLFxcXCJGSVJTVCBOQU1FXFxcIiwgXFxcIkxBU1QgTkFNRVxcXCIsIFxcXCJDSVRZXFxcIixcXFwiQ09NUEFOWSBOQU1FXFxcIl1cIik7XG5cbiAgICAvL3B1c2ggdGhlIGluY2x1ZGVkL2NoZWNrZWQgaW5mbyB0byB0aGUgZW1haWwgbGlzdFxuICAgICRzY29wZS5jb250YWN0Q2hlY2tlZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAkc2NvcGUuY2hlY2tlZC5wdXNoKFtpZF0pO1xuICAgIH07XG5cblxuICAgIC8vUG9zdCBEYXRhIHRvIENvbnN0YW50IENvbnRhY3RcbiAgICAkc2NvcGUuc2VuZFBvc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRhdGEgPSAkLnBhcmFtKHtcbiAgICAgICAgICAgIGpzb246IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBcImltcG9ydERhdGFcIjogaW1wb3J0RGF0YUFycmF5ICsgXCIsIFwiICsgbGlzdEVuZFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cblxuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciBlZjVkNWRmMi1hODA4LTRjNzAtYTVkOS1lYjcxMTYzY2JlYjknXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnaHR0cHM6Ly9hcGkuY29uc3RhbnRjb250YWN0LmNvbS92Mi9hY3Rpdml0aWVzL2FkZGNvbnRhY3RzP2FwaV9rZXk9dTh3NTl6dHhlMzI5NGFkY3pmdm43azllJywgZGF0YSwgY29uZmlnKS5cbiAgICAgICAgICAgIHN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgcmVzLmlkID0gY29udGFjdExpc3REYXRhLmxpc3ROdW07XG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIGVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIC8vIGxvZyBlcnJvclxuICAgICAgICAgICAgfSk7XG4gICAgfTtcbn1dKTtcblxuIiwiYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSkiLCJhcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuXG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKSIsIi8vZWRpdCBjb3Jwb3JhdGlvbiBtb2RhbCB0ZW1wbGF0ZVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRDb3JwQ3RybCcsIFsnJHNjb3BlJywgJyR1aWJNb2RhbCcsICckbG9nJywgJ1Jlc3VsdFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWwsICRsb2csIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAvL3NlbmRzIHRoZSBjb21wYW5pZXMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICRzY29wZS5jb21wYW5pZXMgPSBSZXN1bHRTZXJ2aWNlLmNvbXBhbmllcztcblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG5cbiAgICAkc2NvcGUub3BlbkNvcnAgPSBmdW5jdGlvbiAoc2l6ZSkge1xuXG4gICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ByaXZhdGUvZWRpdGNvcnAuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLml0ZW1zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRsb2cuaW5mbygnTW9kYWwgZGlzbWlzc2VkIGF0OiAnICsgbmV3IERhdGUoKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUudG9nZ2xlQW5pbWF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSAhJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkO1xuICAgIH07XG5cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdjcmVhdGVMaXN0U2VhcmNoJyxbJyRzY29wZScsJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsIENvbnRhY3RMaXN0RGF0YVNlcnZpY2Upe1xuICAgICRzY29wZS5saXN0Rm9ybT17fTtcblxuICAgICRzY29wZS5zZWFyY2hMaXN0QnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgIENvbnRhY3RMaXN0RGF0YVNlcnZpY2UubWFrZURhdGFDYWxsKCRzY29wZS5saXN0Rm9ybS5kYXRhKTtcbiAgICAgICAgLy9lbXB0eXMgdGhlIHNlYXJjaCBib3hcbiAgICAgICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuICAgIH07XG59XSk7IiwiYXBwLmZhY3RvcnkoJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuXG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgYWxsQ29tcGFuaWVzID0gW107XG4gICAgdmFyIGFsbEtpZHMgPSBbXTtcbiAgICB2YXIgYWxsQWR1bHRzID0gW107XG5cbiAgICB2YXIgbWFrZURhdGFDYWxsID0gZnVuY3Rpb24gKHBhc3NlZERhdGEpIHtcbiAgICAgICAgcmV0dXJuIGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIFVSTDogJy4uL2NyZWF0ZU1haWxMaXN0JyxcbiAgICAgICAgICAgIHBhcmFtczoge3NlYXJjaDogcGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbEFkdWx0cy5zcGxpY2UoMCwgYWxsQWR1bHRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnYWR1bHQnKVxuICAgICAgICAgICAgICAgICAgICBhbGxBZHVsdHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbEFkdWx0c1xuICAgIH07XG5cbiAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsQ29tcGFuaWVzLnNwbGljZSgwLCBhbGxDb21wYW5pZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjb21wYW55JylcbiAgICAgICAgICAgICAgICAgICAgYWxsQ29tcGFuaWVzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIHJldHVybiBhbGxDb21wYW5pZXNcbiAgICB9O1xuXG4gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxLaWRzLnNwbGljZSgwLCBhbGxLaWRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuICAgICAgICAgICAgICAgICAgICBraWRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIHJldHVybiBhbGxLaWRzXG4gICAgfTtcblxuICAgIHZhciBkYXRhQXBpID0ge1xuICAgICAgICBtYWtlRGF0YUNhbGw6IG1ha2VEYXRhQ2FsbCxcbiAgICAgICAgZ2V0Q29tcGFuaWVzOiBnZXRDb21wYW5pZXMsXG4gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICBhbGxLaWRzOiBhbGxLaWRzLFxuICAgICAgICBhbGxBZHVsdHM6IGFsbEFkdWx0cyxcbiAgICAgICAgYWxsQ29tcGFuaWVzOiBhbGxDb21wYW5pZXNcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRhdGFBcGk7XG5cbn1dKTtcbiIsIi8vZWRpdCBmYW1pbHkgbW9kYWwgdGVtcGxhdGVcbmFwcC5jb250cm9sbGVyKCdlZGl0RmFtaWx5Q3RybCcsWyckc2NvcGUnLCAnJHVpYk1vZGFsJywgJyRsb2cnLCdSZXN1bHRTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkbG9nLCBSZXN1bHRTZXJ2aWNlKSB7XG4gICAgLy9zZW5kcyB0aGUgYWR1bHRzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAkc2NvcGUuYWR1bHRzID0gUmVzdWx0U2VydmljZS5hZHVsdHM7XG4gICAgLy9zZW5kcyB0aGUga2lkcyBhZnRlciB0aGUgcmVzdWx0cyBoYXZlIGJlZW4gb3JnYW5pemVkXG4gICAgJHNjb3BlLmtpZHMgPSBSZXN1bHRTZXJ2aWNlLmtpZHM7XG5cblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG5cbiAgICAkc2NvcGUub3BlbiA9IGZ1bmN0aW9uIChzaXplKSB7XG5cbiAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9lZGl0ZmFtaWx5Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5pdGVtcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkID0gc2VsZWN0ZWRJdGVtO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ01vZGFsIGRpc21pc3NlZCBhdDogJyArIG5ldyBEYXRlKCkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICB9O1xuXG59XSk7IiwiLy9jb250cm9sbGVycyBmb3IgbG9naW5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvc2VhcmNoXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcbn1dKTtcbiIsIlxuLy9UaGlzIHNob3VsZCBnZXQgdGhlIHNlYXJjaCBpdGVtXG5hcHAuY29udHJvbGxlcignc2VhcmNoRnVuY3Rpb24nLCBbJyRzY29wZScsICckaHR0cCcsICdSZXN1bHRTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFJlc3VsdFNlcnZpY2UpIHtcbiAgICAkc2NvcGUuZm9ybUlucHV0PXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaEJ0biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9wYXNzZXMgaW4gc2VhcmNoIHRleHQgdG8gc2VydmljZVxuICAgICAgIFJlc3VsdFNlcnZpY2UubWFrZURhdGFDYWxsKCRzY29wZS5mb3JtSW5wdXQuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIHRoZSBpbnB1dCB0ZXh0JywgJHNjb3BlLmZvcm1JbnB1dCk7XG4gICAgICAgIC8vZW1wdHlzIHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG4gICAgfTtcblxufV0pO1xuIiwiLy9UaGlzIHNlcnZpY2Ugc2hvdWxkIHBhc3MgZGF0YSBiZXR3ZWVuIGNvbnRyb2xsZXJzXG5hcHAuZmFjdG9yeSgnUmVzdWx0U2VydmljZScsIFsnJGh0dHAnLGZ1bmN0aW9uKCRodHRwKSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgYWR1bHRzID0gW107XG4gICAgdmFyIGNvbXBhbmllcyA9IFtdO1xuICAgIHZhciBraWRzID0gW107XG5cbiAgICB2YXIgbWFrZURhdGFDYWxsID0gZnVuY3Rpb24ocGFzc2VkRGF0YSkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIHVybDogJy4uL3NlYXJjaCcsXG4gICAgICAgICAgICBwYXJhbXM6e3NlYXJjaDpwYXNzZWREYXRhfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRLaWRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBjb21wYW5pZXMuc3BsaWNlKDAsY29tcGFuaWVzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgIGNvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBnZXRFbGVtZW50MShhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnQxJyxjb21wYW5pZXMpO1xuICAgICAgICByZXR1cm4gY29tcGFuaWVzXG4gICAgfTtcblxuICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDIgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgYWR1bHRzLnNwbGljZSgwLGFkdWx0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDIoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBpbiBnZXRFbGVtZW50MicsIGFkdWx0cyk7XG4gICAgICAgIHJldHVybiBhZHVsdHNcbiAgICB9O1xuXG4gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAga2lkcy5zcGxpY2UoMCxraWRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NoaWxkJylcbiAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50czMnLCBraWRzKTtcbiAgICAgICAgcmV0dXJuIGtpZHNcbiAgICB9O1xuXG4gICAgLy9wdWJsaWNcbiAgICB2YXIgcHVibGljQXBpID0ge1xuICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuICAgICAgICBnZXRBZHVsdHM6IGdldEFkdWx0cyxcbiAgICAgICAgZ2V0Q29tcGFuaWVzOiBnZXRDb21wYW5pZXMsXG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICBjb21wYW5pZXM6IGNvbXBhbmllcyxcbiAgICAgICAgYWR1bHRzOiBhZHVsdHMsXG4gICAgICAgIGtpZHM6IGtpZHNcbiAgICB9O1xuICAgIHJldHVybiBwdWJsaWNBcGk7XG59XSk7IiwiLy8gUGxlYXNlIG5vdGUgdGhhdCAkbW9kYWxJbnN0YW5jZSByZXByZXNlbnRzIGEgbW9kYWwgd2luZG93IChpbnN0YW5jZSkgZGVwZW5kZW5jeS5cbi8vIEl0IGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgJHVpYk1vZGFsIHNlcnZpY2UgdXNlZCBhYm92ZS5cblxuLy9uZWVkZWQgZm9yIG1vZGFsPz8gcHJldHR5IHN1cmVcbmFwcC5jb250cm9sbGVyKCdNb2RhbEluc3RhbmNlQ3RybCcsWyckc2NvcGUnLCckbW9kYWxJbnN0YW5jZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlKSB7XG5cbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5zZWxlY3RlZC5pdGVtKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgfTtcbn1dKTsiLCJhcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwkcm9vdFNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2hvbWUnKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgIH1cbn1dKTtcbiIsIlxuLy9yZWdpc3RlciBjb250cm9sbGVyXG5hcHAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZWdpc3RlckN0cmxcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZWdpc3RlckNvbnRyb2xsZXIgc3VibWl0OicsICRzY29wZS5mb3JtKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3JlZ2lzdGVyJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvaW5kZXhcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdyZXNldEN0cmwnLCBbICckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnZWRpdCBwYXNzd29yZDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnB1dCgnL2FkbWluJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvaW5kZXhcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
