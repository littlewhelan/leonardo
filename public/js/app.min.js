function formatDates(t){return{full:moment(t).format(fullDate),pretty:moment(t).format(prettyDate)}}var app=angular.module("leo",["ngRoute","ngAnimate","ui.bootstrap"]),prettyDate="MM/DD/YYgYY",fullDate="MM/DD/YYYY h:mm:ss a";app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"static/login.html"}).when("/search",{templateUrl:"private/search.html"}).when("/register",{templateUrl:"static/register.html"}).when("/contactList",{templateUrl:"private/contactList.html"}).when("/addfamily",{templateUrl:"private/addfamily.html"}).when("/addcorp",{templateUrl:"private/addcorp.html"}).when("/contactlist",{templateUrl:"private/contactlist.html"}).otherwise({redirectTo:"/search"})}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,n){return{request:function(t){return t.headers=t.headers||{},n.isAuthed()&&(t.headers.Authorization="Bearer "+n.getToken()),t},response:function(n){return 401===n.status&&e.path("/"),n||t.when(n)},responseError:function(n){return 401===n.status?e.path("/"):console.log(n.status),t.reject(n)}}}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var n=e.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(t.atob(o))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),n=Math.round((new Date).getTime()/1e3)<=e.exp;return n||this.logout(),n}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.controller("editCorpCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.companies=o.companies,t.animationsEnabled=!0,t.open=function(o,i){return console.log("corp call",i),a({method:"GET",url:"../corporation",params:{id:i}}).then(function(a){t.company=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editcorp.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.company}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("createListSearch",["$scope","$rootScope","ContactListDataService",function(t,e,n){e.add=!1,t.listForm={},t.searchListBtn=function(){n.makeDataCall(t.listForm.data),t.listForm={}}}]),app.factory("ContactListDataService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",URL:"/createMailList",params:{search:n}}).then(function(t){e=t.data,r(e),s(e),l(e)})},s=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"adult"==t.type&&a.push(t)})};return e(t),a},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"company"==t.type&&n.push(t)})};return e(t),n},l=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"child"==t.type&&kids.push(t)})};return e(t),o},c={makeDataCall:i,getCompanies:r,getKids:l,getAdults:s,results:e,allKids:o,allAdults:a,allCompanies:n};return c}]),app.controller("editFamilyCtrl",["$scope","$uibModal","$log","ResultService","$http",function(t,e,n,o,a){t.adults=o.adults,t.kids=o.kids,t.animationsEnabled=!0,t.open=function(o,i){return console.log("family call",i),a({method:"GET",url:"../family",params:{id:i}}).then(function(a){t.family=a.data;var i=e.open({animation:t.animationsEnabled,templateUrl:"private/editfamily.html",controller:"ModalInstanceCtrl",size:o,scope:t,resolve:{items:function(){return t.family}}});i.result.then(function(e){t.selected=e},function(){n.info("Modal dismissed at: "+new Date)})})},t.toggleAnimation=function(){t.animationsEnabled=!t.animationsEnabled}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,n,o,a){t.submit=function(){e.post("/login",t.form).then(function(t){n.saveToken(t.data),a.user=n.getUser(),o.path("/search")})}}]),app.controller("searchFunction",["$scope","$http","ResultService",function(t,e,n){t.formInput={},t.searchBtn=function(){n.makeDataCall(t.formInput.data),console.log("this is the input text",t.formInput),t.formInput={}}}]),app.factory("ResultService",["$http",function(t){var e=[],n=[],o=[],a=[],i=function(n){return t({method:"GET",url:"../search",params:{search:n}}).then(function(t){e=t.data,s(e),l(e),r(e)})},s=function(t){var e=function(t){o.splice(0,o.length),t.forEach(function(t){"company"==t.type&&o.push(t)})};return e(t),console.log("this is getElement1",o),o},r=function(t){var e=function(t){n.splice(0,n.length),t.forEach(function(t){"adult"==t.type&&n.push(t)})};return e(t),console.log("this is in getElement2",n),n},l=function(t){var e=function(t){a.splice(0,a.length),t.forEach(function(t){"child"==t.type&&a.push(t)})};return e(t),console.log("this is getElements3",a),a},c={getKids:l,getAdults:r,getCompanies:s,makeDataCall:i,results:e,companies:o,adults:n,kids:a};return c}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(t,e){t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(t,e,n,o){n.user=t.getUser(),n.user&&n.user.username&&o.path("/home"),e.logout=function(){t.logout(),n.user=t.getUser(),o.path("/")}}]),app.controller("newContactListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.createList=function(){console.log("create list: "+e.listName.input),t.postList(e.listName.input),e.listName={}}}]),app.service("newContactListData",["ContactListDataService","$http",function(t,e){var n="1499523610";this.postList=function(){e.post("/newContactList").then(function(t){console.log(t),n=t.id},function(t){console.log(t)}),console.log(options)};var o=[{email_addresses:["user1@example.com"],first_name:"John",last_name:"Smith",company_name:"Company X",addresses:[{city:"anytown"}]},{email_addresses:["user2@example.com"],first_name:"Jane",last_name:"Smithy",company_name:"Company Y",addresses:[{city:"sometown"}]}];this.popList=function(){a(),e.post("/populateContactList.js",o,n).success(function(t,e,n,o){console.log(t)}),console.log(options)};var a=function(){$(":checked.type-element").each(function(){if(id==t.results.id){var e={email_addresses:[$(this).email],first_name:$(this).firstName,last_name:$(this).lastName,company_name:$(this).company,addresses:[{city:$(this).city}]};o.push(e)}})}}]),app.controller("popListController",["newContactListData","$scope","$http",function(t,e,n){e.listName={},e.populateList=function(){console.log("create list: "+scope.listName.input),t.popList(),e.listName={}}}]),app.controller("registerCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("registerCtrl"),console.log("registerController submit:",t.form),e.post("/register",t.form).then(function(t){console.log(t),n.path("/index")})}}]),app.controller("resetCtrl",["$scope","$http","$location",function(t,e,n){t.submit=function(){console.log("edit password:",t.form),e.put("/admin",t.form).then(function(t){console.log(t),n.path("/index")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhJbnRlcmNlcHRvci5qcyIsImF1dGhTZXJ2aWNlLmpzIiwiY29ycENvbnRyb2xsZXIuanMiLCJjcmVhdGVMaXN0Q29udG9sbGVyLmpzIiwiY3JlYXRlTGlzdFNlcnZpY2UuanMiLCJmYW1pbHlDb250cm9sbGVyLmpzIiwibG9naW5Db250cm9sbGVyLmpzIiwibWFpblNlYXJjaENvbnRyb2xsZXIuanMiLCJtYWluU2VhcmNoU2VydmljZS5qcyIsIm1vZGFsSW5zdGFuY2VDb250cm9sbGVyLmpzIiwibmF2Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0Q29udHJvbGxlci5qcyIsIm5ld0NvbnRhY3RMaXN0U2VydmljZS5qcyIsInBvcExpc3RDb250cm9sbGVyLmpzIiwicmVnaXN0ZXJDb250cm9sbGVyLmpzIiwicmVzZXRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImZvcm1hdERhdGVzIiwiZGF0ZSIsImZ1bGwiLCJtb21lbnQiLCJmb3JtYXQiLCJmdWxsRGF0ZSIsInByZXR0eSIsInByZXR0eURhdGUiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsImlzQXV0aGVkIiwiQXV0aG9yaXphdGlvbiIsImdldFRva2VuIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZWplY3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsInNhdmVUb2tlbiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwicGFyYW1zIiwibm90RXhwaXJlZCIsIk1hdGgiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkdWliTW9kYWwiLCIkbG9nIiwiUmVzdWx0U2VydmljZSIsIiRodHRwIiwiY29tcGFuaWVzIiwiYW5pbWF0aW9uc0VuYWJsZWQiLCJvcGVuIiwic2l6ZSIsImlkIiwibWV0aG9kIiwidXJsIiwidGhlbiIsImNvbXBhbnkiLCJkYXRhIiwibW9kYWxJbnN0YW5jZSIsImFuaW1hdGlvbiIsInNjb3BlIiwicmVzb2x2ZSIsIml0ZW1zIiwicmVzdWx0Iiwic2VsZWN0ZWRJdGVtIiwic2VsZWN0ZWQiLCJpbmZvIiwidG9nZ2xlQW5pbWF0aW9uIiwiJHJvb3RTY29wZSIsIkNvbnRhY3RMaXN0RGF0YVNlcnZpY2UiLCJhZGQiLCJsaXN0Rm9ybSIsInNlYXJjaExpc3RCdG4iLCJtYWtlRGF0YUNhbGwiLCJyZXN1bHRzIiwiYWxsQ29tcGFuaWVzIiwiYWxsS2lkcyIsImFsbEFkdWx0cyIsInBhc3NlZERhdGEiLCJVUkwiLCJzZWFyY2giLCJnZXRDb21wYW5pZXMiLCJnZXRBZHVsdHMiLCJnZXRLaWRzIiwiYXJyYXkiLCJnZXRFbGVtZW50MyIsInNwbGljZSIsImxlbmd0aCIsImZvckVhY2giLCJlbGVtZW50IiwidHlwZSIsInB1c2giLCJraWRzIiwiZGF0YUFwaSIsImFkdWx0cyIsImZhbWlseSIsInN1Ym1pdCIsInBvc3QiLCJmb3JtIiwidXNlciIsImZvcm1JbnB1dCIsInNlYXJjaEJ0biIsImdldEVsZW1lbnQxIiwiZ2V0RWxlbWVudDIiLCJwdWJsaWNBcGkiLCIkbW9kYWxJbnN0YW5jZSIsIm9rIiwiY2xvc2UiLCJpdGVtIiwiY2FuY2VsIiwiZGlzbWlzcyIsInVzZXJuYW1lIiwibmV3Q29udGFjdExpc3REYXRhIiwibGlzdE5hbWUiLCJjcmVhdGVMaXN0IiwiaW5wdXQiLCJwb3N0TGlzdCIsImxpc3ROdW0iLCJvcHRpb25zIiwiaW1wb3J0RGF0YUFycmF5IiwiZW1haWxfYWRkcmVzc2VzIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsImNvbXBhbnlfbmFtZSIsImFkZHJlc3NlcyIsImNpdHkiLCJwb3BMaXN0IiwiZ2V0Q2hlY2tlZCIsInN1Y2Nlc3MiLCIkIiwiZWFjaCIsImNvbnRhY3RPYmplY3QiLCJlbWFpbCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwicG9wdWxhdGVMaXN0IiwicHV0Il0sIm1hcHBpbmdzIjoiQUFLQSxRQUFBQSxhQUFBQyxHQUNBLE9BQ0FDLEtBQUFDLE9BQUFGLEdBQUFHLE9BQUFDLFVBQ0FDLE9BQUFILE9BQUFGLEdBQUFHLE9BQUFHLGFBUkEsR0FBQUMsS0FBQUMsUUFBQUMsT0FBQSxPQUFBLFVBQUEsWUFBQSxpQkFFQUgsV0FBQSxjQUNBRixTQUFBLHNCQVNBRyxLQUFBRyxRQUFBLGlCQUNBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsS0FDQUMsWUFBQSxzQkFFQUQsS0FBQSxXQUNBQyxZQUFBLHdCQUVBRCxLQUFBLGFBQ0FDLFlBQUEseUJBRUFELEtBQUEsZ0JBQ0FDLFlBQUEsNkJBRUFELEtBQUEsY0FDQUMsWUFBQSwyQkFFQUQsS0FBQSxZQUNBQyxZQUFBLHlCQUVBRCxLQUFBLGdCQUNBQyxZQUFBLDZCQUVBQyxXQUNBQyxXQUFBLGVDckNBUixJQUFBUyxRQUFBLG1CQUFBLEtBQUEsWUFBQSxjQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsT0FDQUMsUUFBQSxTQUFBVixHQUtBLE1BSkFBLEdBQUFXLFFBQUFYLEVBQUFXLFlBQ0FGLEVBQUFHLGFBQ0FaLEVBQUFXLFFBQUFFLGNBQUEsVUFBQUosRUFBQUssWUFFQWQsR0FFQWUsU0FBQSxTQUFBQSxHQU9BLE1BTEEsT0FBQUEsRUFBQUMsUUFHQVIsRUFBQVMsS0FBQSxLQUVBRixHQUFBUixFQUFBTCxLQUFBYSxJQUNBRyxjQUFBLFNBQUFILEdBU0EsTUFSQSxPQUFBQSxFQUFBQyxPQUdBUixFQUFBUyxLQUFBLEtBR0FFLFFBQUFDLElBQUFM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cUQsT0FBQSxXQUNBakYsUUFBQUMsSUFBQSxnQkFDQUQsUUFBQUMsSUFBQSw2QkFBQTJCLEVBQUF1RCxNQUNBbkQsRUFBQWtELEtBQUEsWUFBQXRELEVBQUF1RCxNQUNBM0MsS0FBQSxTQUFBNUMsR0FDQUksUUFBQUMsSUFBQUwsR0FDQVAsRUFBQVMsS0FBQSxnQkNUQXBCLElBQUFpRCxXQUFBLGFBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUMsRUFBQUksRUFBQTNDLEdBQ0F1QyxFQUFBcUQsT0FBQSxXQUNBakYsUUFBQUMsSUFBQSxpQkFBQTJCLEVBQUF1RCxNQUNBbkQsRUFBQXlGLElBQUEsU0FBQTdGLEVBQUF1RCxNQUNBM0MsS0FBQSxTQUFBNUMsR0FDQUksUUFBQUMsSUFBQUwsR0FDQVAsRUFBQVMsS0FBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdsZW8nLCBbJ25nUm91dGUnLCAnbmdBbmltYXRlJywgJ3VpLmJvb3RzdHJhcCddKTtcblxudmFyIHByZXR0eURhdGUgPSBcIk1NL0REL1lZZ1lZXCI7XG52YXIgZnVsbERhdGUgPSBcIk1NL0REL1lZWVkgaDptbTpzcyBhXCI7XG5cbmZ1bmN0aW9uIGZvcm1hdERhdGVzIChkYXRlKSB7XG5cdHJldHVybiB7XG5cdFx0ZnVsbDogbW9tZW50KGRhdGUpLmZvcm1hdChmdWxsRGF0ZSksXG5cdFx0cHJldHR5OiBtb21lbnQoZGF0ZSkuZm9ybWF0KHByZXR0eURhdGUpXG5cdH07XG59XG5cbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsXG4gICAgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIuXG4gICAgICAgICAgICB3aGVuKCcvJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGljL2xvZ2luLmh0bWwnXG4gICAgICAgICAgICB9KS5cbiAgICAgICAgICAgIHdoZW4oJy9zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL3NlYXJjaC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvcmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0aWMvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RMaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0TGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICB3aGVuKCcvYWRkZmFtaWx5Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9hZGRmYW1pbHkuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2FkZGNvcnAnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2FkZGNvcnAuaHRtbCdcbiAgICAgICAgICAgIH0pLlxuICAgICAgICAgICAgd2hlbignL2NvbnRhY3RsaXN0Jywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJpdmF0ZS9jb250YWN0bGlzdC5odG1sJ1xuICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvc2VhcmNoJ1xuICAgICAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cblxuXG4iLCJhcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKSIsImFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KSB7XG5cbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pIiwiLy9lZGl0IGNvcnBvcmF0aW9uIG1vZGFsIHRlbXBsYXRlXG5hcHAuY29udHJvbGxlcignZWRpdENvcnBDdHJsJywgWyckc2NvcGUnLCAnJHVpYk1vZGFsJywgJyRsb2cnLCAnUmVzdWx0U2VydmljZScsICckaHR0cCcsIGZ1bmN0aW9uICgkc2NvcGUsICR1aWJNb2RhbCwgJGxvZywgUmVzdWx0U2VydmljZSwgJGh0dHApIHtcbiAgICAvL3NlbmRzIHRoZSBjb21wYW5pZXMgYWZ0ZXIgdGhlIHJlc3VsdHMgaGF2ZSBiZWVuIG9yZ2FuaXplZFxuICAgICAgICAkc2NvcGUuY29tcGFuaWVzID0gUmVzdWx0U2VydmljZS5jb21wYW5pZXM7XG5cbiAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuXG4gICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2l6ZSwgaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NvcnAgY2FsbCcsIGlkKTtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICB1cmw6ICcuLi9jb3Jwb3JhdGlvbicsXG4gICAgICAgICAgICBwYXJhbXM6e2lkOmlkfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnkgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2VkaXRjb3JwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuY29tcGFueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnRvZ2dsZUFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkID0gISRzY29wZS5hbmltYXRpb25zRW5hYmxlZDtcbiAgICB9O1xuXG5cbn1dKTtcbiIsImFwcC5jb250cm9sbGVyKCdjcmVhdGVMaXN0U2VhcmNoJyxbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ0NvbnRhY3RMaXN0RGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIENvbnRhY3RMaXN0RGF0YVNlcnZpY2Upe1xuICAgICRyb290U2NvcGUuYWRkID0gZmFsc2U7XG4gICAgJHNjb3BlLmxpc3RGb3JtPXt9O1xuXG4gICAgJHNjb3BlLnNlYXJjaExpc3RCdG4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcGFzc2VzIGluIHNlYXJjaCB0ZXh0IHRvIHNlcnZpY2VcbiAgICAgICAgQ29udGFjdExpc3REYXRhU2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmxpc3RGb3JtLmRhdGEpO1xuICAgICAgICAvL2VtcHR5IHRoZSBzZWFyY2ggYm94XG4gICAgICAgICRzY29wZS5saXN0Rm9ybT17fTtcbiAgICB9O1xufV0pOyIsImFwcC5mYWN0b3J5KCdDb250YWN0TGlzdERhdGFTZXJ2aWNlJyxbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcblxuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgdmFyIGFsbENvbXBhbmllcyA9IFtdO1xuICAgIHZhciBhbGxLaWRzID0gW107XG4gICAgdmFyIGFsbEFkdWx0cyA9IFtdO1xuXG4gICAgdmFyIG1ha2VEYXRhQ2FsbCA9IGZ1bmN0aW9uIChwYXNzZWREYXRhKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgVVJMOiAnL2NyZWF0ZU1haWxMaXN0JyxcbiAgICAgICAgICAgIHBhcmFtczoge3NlYXJjaDogcGFzc2VkRGF0YX1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0QWR1bHRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgZ2V0S2lkcyhyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgdmFyIGdldEFkdWx0cyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgICAgIGFsbEFkdWx0cy5zcGxpY2UoMCwgYWxsQWR1bHRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnYWR1bHQnKVxuICAgICAgICAgICAgICAgICAgICBhbGxBZHVsdHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICAgIGdldEVsZW1lbnQzKGFycmF5KTtcbiAgICAgICAgcmV0dXJuIGFsbEFkdWx0c1xuICAgIH07XG5cbiAgICB2YXIgZ2V0Q29tcGFuaWVzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MyA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgYWxsQ29tcGFuaWVzLnNwbGljZSgwLCBhbGxDb21wYW5pZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdjb21wYW55JylcbiAgICAgICAgICAgICAgICAgICAgYWxsQ29tcGFuaWVzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIHJldHVybiBhbGxDb21wYW5pZXNcbiAgICB9O1xuXG4gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICAgICAgdmFyIGdldEVsZW1lbnQzID0gZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgICAgICBhbGxLaWRzLnNwbGljZSgwLCBhbGxLaWRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PSAnY2hpbGQnKVxuICAgICAgICAgICAgICAgICAgICBraWRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBnZXRFbGVtZW50MyhhcnJheSk7XG4gICAgICAgIHJldHVybiBhbGxLaWRzXG4gICAgfTtcblxuICAgIHZhciBkYXRhQXBpID0ge1xuICAgICAgICBtYWtlRGF0YUNhbGw6IG1ha2VEYXRhQ2FsbCxcbiAgICAgICAgZ2V0Q29tcGFuaWVzOiBnZXRDb21wYW5pZXMsXG4gICAgICAgIGdldEtpZHM6IGdldEtpZHMsXG4gICAgICAgIGdldEFkdWx0czogZ2V0QWR1bHRzLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICBhbGxLaWRzOiBhbGxLaWRzLFxuICAgICAgICBhbGxBZHVsdHM6IGFsbEFkdWx0cyxcbiAgICAgICAgYWxsQ29tcGFuaWVzOiBhbGxDb21wYW5pZXNcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRhdGFBcGk7XG5cbn1dKTtcbiIsIi8vZWRpdCBmYW1pbHkgbW9kYWwgdGVtcGxhdGVcbmFwcC5jb250cm9sbGVyKCdlZGl0RmFtaWx5Q3RybCcsWyckc2NvcGUnLCAnJHVpYk1vZGFsJywgJyRsb2cnLCdSZXN1bHRTZXJ2aWNlJywgJyRodHRwJywgZnVuY3Rpb24gKCRzY29wZSwgJHVpYk1vZGFsLCAkbG9nLCBSZXN1bHRTZXJ2aWNlLCAkaHR0cCkge1xuXG4gICAgLy9zZW5kcyB0aGUgYWR1bHRzIGFuZCBraWRzIGFmdGVyIHRoZSByZXN1bHRzIGhhdmUgYmVlbiBvcmdhbml6ZWRcbiAgICAgICAgJHNjb3BlLmFkdWx0cyA9IFJlc3VsdFNlcnZpY2UuYWR1bHRzO1xuICAgICAgICAkc2NvcGUua2lkcyA9IFJlc3VsdFNlcnZpY2Uua2lkcztcblxuICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNpemUsIGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZmFtaWx5IGNhbGwnLGlkKTtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICB1cmw6ICcuLi9mYW1pbHknLFxuICAgICAgICAgICAgICAgIHBhcmFtczp7aWQ6aWR9XG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgIFx0XHRcdCRzY29wZS5mYW1pbHkgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcml2YXRlL2VkaXRmYW1pbHkuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgICAgXHRcdFx0XHRzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZmFtaWx5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBzZWxlY3RlZEl0ZW07XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdNb2RhbCBkaXNtaXNzZWQgYXQ6ICcgKyBuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlQW5pbWF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCA9ICEkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQ7XG4gICAgICAgICAgICB9O1xuXG5cbn1dKTsiLCIvL2NvbnRyb2xsZXJzIGZvciBsb2dpblxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSl7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRodHRwLnBvc3QoJy9sb2dpbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9zZWFyY2hcIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xufV0pO1xuIiwiXG4vL1RoaXMgc2hvdWxkIGdldCB0aGUgc2VhcmNoIGl0ZW1cbmFwcC5jb250cm9sbGVyKCdzZWFyY2hGdW5jdGlvbicsIFsnJHNjb3BlJywgJyRodHRwJywgJ1Jlc3VsdFNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUmVzdWx0U2VydmljZSkge1xuICAgICRzY29wZS5mb3JtSW5wdXQ9e307XG5cbiAgICAkc2NvcGUuc2VhcmNoQnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgUmVzdWx0U2VydmljZS5tYWtlRGF0YUNhbGwoJHNjb3BlLmZvcm1JbnB1dC5kYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgdGhlIGlucHV0IHRleHQnLCAkc2NvcGUuZm9ybUlucHV0KTtcbiAgICAgICAgLy9lbXB0eXMgdGhlIHNlYXJjaCBib3hcbiAgICAgICAgJHNjb3BlLmZvcm1JbnB1dD17fTtcbiAgICB9O1xuXG59XSk7XG4iLCIvL1RoaXMgc2VydmljZSBzaG91bGQgcGFzcyBkYXRhIGJldHdlZW4gY29udHJvbGxlcnNcbmFwcC5mYWN0b3J5KCdSZXN1bHRTZXJ2aWNlJywgWyckaHR0cCcsZnVuY3Rpb24oJGh0dHApIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBhZHVsdHMgPSBbXTtcbiAgICB2YXIgY29tcGFuaWVzID0gW107XG4gICAgdmFyIGtpZHMgPSBbXTtcblxuICAgIHZhciBtYWtlRGF0YUNhbGwgPSBmdW5jdGlvbihwYXNzZWREYXRhKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgdXJsOiAnLi4vc2VhcmNoJyxcbiAgICAgICAgICAgIHBhcmFtczp7c2VhcmNoOnBhc3NlZERhdGF9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXN1bHRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhyZXN1bHRzKTtcbiAgICAgICAgICAgIGdldEtpZHMocmVzdWx0cyk7XG4gICAgICAgICAgICBnZXRBZHVsdHMocmVzdWx0cyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGdldENvbXBhbmllcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHZhciBnZXRFbGVtZW50MSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICBjb21wYW5pZXMuc3BsaWNlKDAsY29tcGFuaWVzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NvbXBhbnknKVxuICAgICAgICAgICAgICAgIGNvbXBhbmllcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBnZXRFbGVtZW50MShhcnJheSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIGdldEVsZW1lbnQxJyxjb21wYW5pZXMpO1xuICAgICAgICByZXR1cm4gY29tcGFuaWVzXG4gICAgfTtcblxuICAgIHZhciBnZXRBZHVsdHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDIgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgYWR1bHRzLnNwbGljZSgwLGFkdWx0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYXJyYXkuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC50eXBlID09ICdhZHVsdCcpXG4gICAgICAgICAgICAgICAgICAgIGFkdWx0cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDIoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBpbiBnZXRFbGVtZW50MicsIGFkdWx0cyk7XG4gICAgICAgIHJldHVybiBhZHVsdHNcbiAgICB9O1xuXG4gICAgdmFyIGdldEtpZHMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICB2YXIgZ2V0RWxlbWVudDMgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAga2lkcy5zcGxpY2UoMCxraWRzLmxlbmd0aCk7XG4gICAgICAgICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gJ2NoaWxkJylcbiAgICAgICAgICAgICAgICAgICAga2lkcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RWxlbWVudDMoYXJyYXkpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyBnZXRFbGVtZW50czMnLCBraWRzKTtcbiAgICAgICAgcmV0dXJuIGtpZHNcbiAgICB9O1xuXG4gICAgLy9wdWJsaWNcbiAgICB2YXIgcHVibGljQXBpID0ge1xuICAgICAgICBnZXRLaWRzOiBnZXRLaWRzLFxuICAgICAgICBnZXRBZHVsdHM6IGdldEFkdWx0cyxcbiAgICAgICAgZ2V0Q29tcGFuaWVzOiBnZXRDb21wYW5pZXMsXG4gICAgICAgIG1ha2VEYXRhQ2FsbDogbWFrZURhdGFDYWxsLFxuICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICBjb21wYW5pZXM6IGNvbXBhbmllcyxcbiAgICAgICAgYWR1bHRzOiBhZHVsdHMsXG4gICAgICAgIGtpZHM6IGtpZHNcbiAgICB9O1xuICAgIHJldHVybiBwdWJsaWNBcGk7XG59XSk7IiwiLy8gUGxlYXNlIG5vdGUgdGhhdCAkbW9kYWxJbnN0YW5jZSByZXByZXNlbnRzIGEgbW9kYWwgd2luZG93IChpbnN0YW5jZSkgZGVwZW5kZW5jeS5cbi8vIEl0IGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgJHVpYk1vZGFsIHNlcnZpY2UgdXNlZCBhYm92ZS5cblxuLy9uZWVkZWQgZm9yIG1vZGFsPz8gcHJldHR5IHN1cmVcbmFwcC5jb250cm9sbGVyKCdNb2RhbEluc3RhbmNlQ3RybCcsWyckc2NvcGUnLCckbW9kYWxJbnN0YW5jZScsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlKSB7XG5cbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5zZWxlY3RlZC5pdGVtKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XG4gICAgfTtcbn1dKTsiLCJhcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uKXtcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9ob21lJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL1wiKTtcbiAgICB9XG59XSk7XG4iLCIvLyBBamF4IGZvciBjcmVhdGluZyB0aGUgY29udGFjdCBsaXN0IGluIGNvbnN0YW50IGNvbnRhY3RcbmFwcC5jb250cm9sbGVyKCduZXdDb250YWN0TGlzdENvbnRyb2xsZXInLFsnbmV3Q29udGFjdExpc3REYXRhJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihuZXdDb250YWN0TGlzdERhdGEsICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2RhdGEgdG8gY3JlYXRlIGEgbmV3IGNvbnRhY3QgbGlzdFxuXG5cbiAgICAkc2NvcGUubGlzdE5hbWUgPSB7fTtcblxuICAgICRzY29wZS5jcmVhdGVMaXN0ICA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGUgbGlzdDogXCIgKyAkc2NvcGUubGlzdE5hbWUuaW5wdXQpO1xuICAgICAgICAvL3Bhc3NlcyBsaXN0IG5hbWUgc2VydmljZVxuICAgICAgICBuZXdDb250YWN0TGlzdERhdGEucG9zdExpc3QoJHNjb3BlLmxpc3ROYW1lLmlucHV0KTtcblxuICAgICAgICAkc2NvcGUubGlzdE5hbWU9e307XG4gICAgfTtcbn1dKTtcblxuXG4iLCIvL3NlcnZpY2UgZm9yIGFqYXggY2FsbHMgdG8gY29uc3RhbnQgY29udGFjdFxuXG5hcHAuc2VydmljZSgnbmV3Q29udGFjdExpc3REYXRhJywgWydDb250YWN0TGlzdERhdGFTZXJ2aWNlJywgJyRodHRwJyxcbiAgICBmdW5jdGlvbiAoQ29udGFjdExpc3REYXRhU2VydmljZSwgJGh0dHApIHtcblxuICAgIHZhciBuZXdDb250YWN0TGlzdCA9IFtdO1xuICAgIHZhciBsaXN0TnVtID0gXCIxNDk5NTIzNjEwXCI7XG5cbiAgICB0aGlzLnBvc3RMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cC5wb3N0KCcvbmV3Q29udGFjdExpc3QnKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIGxpc3ROdW0gPSBkYXRhLmlkXG5cbiAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsgLy9lcnJvclxuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2cob3B0aW9ucylcbiAgICB9O1xuXG4gICAgdmFyIGltcG9ydERhdGFBcnJheSA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgIFwidXNlcjFAZXhhbXBsZS5jb21cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZmlyc3RfbmFtZVwiOiBcIkpvaG5cIixcbiAgICAgICAgICAgIFwibGFzdF9uYW1lXCI6IFwiU21pdGhcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBYXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwiYW55dG93blwiXG4gICAgICAgICAgICB9XVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBcImVtYWlsX2FkZHJlc3Nlc1wiOiBbXG4gICAgICAgICAgICAgICAgXCJ1c2VyMkBleGFtcGxlLmNvbVwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJmaXJzdF9uYW1lXCI6IFwiSmFuZVwiLFxuICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogXCJTbWl0aHlcIixcbiAgICAgICAgICAgIFwiY29tcGFueV9uYW1lXCI6IFwiQ29tcGFueSBZXCIsXG4gICAgICAgICAgICBcImFkZHJlc3Nlc1wiOiBbe1xuICAgICAgICAgICAgICAgIGNpdHk6IFwic29tZXRvd25cIlxuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIF07XG5cbiAgICAvL3ZhciBjb250YWN0TGlzdE9iamVjdCA9KHtcbiAgICAvLyAgICBcIkltcG9ydCBEYXRhXCIgOiBpbXBvcnREYXRhQXJyYXksXG4gICAgLy8gICAgXCJsaXN0XCI6IFtsaXN0TnVtXSxcbiAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOltcIkVNQUlMXCIsXCJGSVJTVCBOQU1FXCIsIFwiTEFTVCBOQU1FXCIsIFwiQ0lUWVwiLFwiQ09NUEFOWSBOQU1FXCJdfSk7XG5cblxuICAgIHRoaXMucG9wTGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZ2V0Q2hlY2tlZCgpO1xuICAgICAgICAkaHR0cC5wb3N0KCcvcG9wdWxhdGVDb250YWN0TGlzdC5qcycsIGltcG9ydERhdGFBcnJheSwgbGlzdE51bSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2cob3B0aW9ucyk7XG5cbiAgICB9O1xuXG4gICAgLy9nZXQgYWxsIHRoZSBjaGVja2VkIGVsZW1lbnRzIGFuZCBzdHVmZiB0aGVtIGluIGFuIGFycmF5XG4gICAgdmFyIGdldENoZWNrZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKFwiOmNoZWNrZWQudHlwZS1lbGVtZW50XCIpLmVhY2goXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT0gQ29udGFjdExpc3REYXRhU2VydmljZS5yZXN1bHRzLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFjdE9iamVjdCA9XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbF9hZGRyZXNzZXNcIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmVtYWlsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZpcnN0X25hbWVcIjogJCh0aGlzKS5maXJzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYXN0X25hbWVcIjogJCh0aGlzKS5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbXBhbnlfbmFtZVwiOiAkKHRoaXMpLmNvbXBhbnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZGRyZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2l0eTogJCh0aGlzKS5jaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnREYXRhQXJyYXkucHVzaChjb250YWN0T2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxufV0pOyIsImFwcC5jb250cm9sbGVyKCdwb3BMaXN0Q29udHJvbGxlcicsWyduZXdDb250YWN0TGlzdERhdGEnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKG5ld0NvbnRhY3RMaXN0RGF0YSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vZGF0YSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCBsaXN0XG5cblxuICAgICRzY29wZS5saXN0TmFtZSA9IHt9O1xuXG4gICAgJHNjb3BlLnBvcHVsYXRlTGlzdCAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlIGxpc3Q6IFwiICsgc2NvcGUubGlzdE5hbWUuaW5wdXQpO1xuICAgICAgICAvL3Bhc3NlcyBpbiBzZWFyY2ggdGV4dCB0byBzZXJ2aWNlXG4gICAgICAgIG5ld0NvbnRhY3RMaXN0RGF0YS5wb3BMaXN0KCk7XG4gICAgICAgIC8vdmFyIGxpc3RFbmQgPSB7XG4gICAgICAgIC8vICAgIFwibGlzdHNcIjogW2xpc3ROdW1dLFxuICAgICAgICAvLyAgICBcImNvbHVtbl9uYW1lc1wiOiBbXG4gICAgICAgIC8vICAgIFwiRU1BSUxcIixcbiAgICAgICAgLy8gICAgXCJGSVJTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiTEFTVCBOQU1FXCIsXG4gICAgICAgIC8vICAgIFwiQ0lUWVwiLFxuICAgICAgICAvLyAgICBcIkNPTVBBTlkgTkFNRVwiXG4gICAgICAgIC8vXX1cblxuXG4gICAgICAgICRzY29wZS5saXN0TmFtZT17fTtcbiAgICB9O1xufV0pO1xuXG4iLCJcbi8vcmVnaXN0ZXIgY29udHJvbGxlclxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXJDdHJsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZygncmVnaXN0ZXJDb250cm9sbGVyIHN1Ym1pdDonLCAkc2NvcGUuZm9ybSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9yZWdpc3RlcicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iLCJhcHAuY29udHJvbGxlcigncmVzZXRDdHJsJywgWyAnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VkaXQgcGFzc3dvcmQ6JywgJHNjb3BlLmZvcm0pO1xuICAgICAgICAkaHR0cC5wdXQoJy9hZG1pbicsICRzY29wZS5mb3JtKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2luZGV4XCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
